YUI.add("yg-panel",function(b){function a(){var c=this;c.arguments=arguments;b.use("panel",function(e){var d=c.arguments[0];if(d.moveNode){e.one("body").append(d.moveNode)}a.superclass.constructor.apply(c,c.arguments)})}a.NAME="panel";a.ATTRS={centered:{value:true},modal:{value:true},render:{value:true},visible:{value:false},width:{value:"600px"},zIndex:{value:1001},srcNode:{value:null},scrollableNode:{value:null},moveNode:{value:null},view:{value:null},pv:{value:true},btnSource:{value:null}};b.extend(a,b.Panel,{initializer:function(){var d=this,c=this.get("view");this.after("visibleChange",function(g){if(d.get("visible")){d.adjustHeight()}});if(c){try{c.after("destroy",function(g){d.get("moveNode").remove(true)})}catch(f){b.log("error while removing the panel node from DOM.")}}this.scrollY=0},show:function(d){if(!d&&GROUPS.PAGE){GROUPS.PAGE.toggleAds(false)}this.scrollY=b.DOM.docScrollY();b.one(".body-bounding-box").addClass("popup-fixed");a.superclass.reset.call(this);a.superclass.show.call(this);if(this.get("pv")){var c,e=this.get("srcNode").getAttribute("data-title")?this.get("srcNode").getAttribute("data-title"):this.get("srcNode").getAttribute("id");c=this.get("srcNode").getAttribute("data-zone");GROUPS.UTILS.fireYGBeacon({action:e,pv:1});GROUPS.INSTR.firePageBeacon(e,"",c)}},adjustHeight:function(){var d=this;if(d.get("scrollableNode")){var e=d.get("boundingBox"),h=e.get("offsetHeight"),i=d.get("scrollableNode"),g=i.get("offsetHeight"),c=b.one("body").get("viewportRegion").height,f=h-g;if(c<e.get("offsetHeight")){e.setStyle("top","0px");i.setStyle("height",c-f);i.setStyle("overflow","auto")}}if(b.one("body").getAttribute("data-device")=="mobile"){var e=this.get("boundingBox");e.setStyle("width","");e.setStyle("height",b.one("body").get("winHeight")+"px");e.setStyle("top","0");e.setStyle("left","0");e.setStyle("right","0");this.get("contentBox").setStyle("height","100%")}},renderUI:function(){a.superclass.renderUI.call(this)},attachKeyEventsToButtons:function(){var c=this.get("srcNode");this.keyHandler=c.delegate("key",function(d){d.currentTarget.simulate("click")},"down:13",".yg-button")},render:function(){a.superclass.render.call(this);this.attachKeyEventsToButtons();this.adjustHeight()},destroy:function(c){b.one(".body-bounding-box").removeClass("popup-fixed");if(this.keyHandler){this.keyHandler.detach()}a.superclass.destroy.call(this,c)},hide:function(f,c,g){var d=this.get("btnSource");b.one(".body-bounding-box").removeClass("popup-fixed");if(!c&&GROUPS.PAGE){GROUPS.PAGE.toggleAds(true)}a.superclass.hide.call(this);if(!g){window.scrollTo(0,this.scrollY)}this.fire("panel-hide");if(d){setTimeout(function(){d.focus()},0)}}});b.namespace("Groups").Panel=a},"0.1",{});/*
YUI 3.15.0 (build 834026e)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("overlay",function(e,t){e.Overlay=e.Base.create("overlay",e.Widget,[e.WidgetStdMod,e.WidgetPosition,e.WidgetStack,e.WidgetPositionAlign,e.WidgetPositionConstrain])},"3.15.0",{requires:["widget","widget-stdmod","widget-position","widget-position-align","widget-stack","widget-position-constrain"],skinnable:!0});
YUI.add("yg-overlay",function(b){function a(){var d=arguments[0],e=d.align.node,f=false;if(typeof e=="string"){var c=b.one(e);d.align.node=c,this.alignNodeSelector=e;if(c.ancestor(".docked")||c.ancestor(".dockme")||c.hasClass("docked")||c.hasClass("dockme")){f=true}if(f){if(c.ancestor(".dockme")||c.hasClass("dockme")){this.dockNode=c.ancestor(".dockme")?c.ancestor(".dockme"):c}else{this.dockNode=c.ancestor(".docked")?c.ancestor(".docked").get("parentNode").one(".dockme"):c.get("parentNode").one(".dockme")}this.dockNodeId=this.dockNode.get("id");if(typeof GROUPS.PAGE._docNodeOverlayMap[this.dockNodeId]=="undefined"){GROUPS.PAGE._docNodeOverlayMap[this.dockNodeId]=new Array()}}}if(typeof d.align!="undefined"&&d.align!=null&&typeof d.align.node!="undefined"&&d.align.node!=null){this.align=d.align}a.superclass.constructor.apply(this,arguments)}a.NAME="overlay";a.ATTRS={visible:{value:false},zIndex:{value:10001}};b.extend(a,b.Overlay,{initializer:function(){},renderUI:function(){a.superclass.renderUI.call(this)},realign:function(){this.set("align",{node:this.align.node,points:this.align.points})},show:function(){var d=this.get("id"),c=b.one("#"+d);if((this.align.node.ancestor(".dockme")||this.align.node.hasClass("dockme"))){var e=this.align.node.ancestor(".dockme")?this.align.node.ancestor(".dockme"):this.align.node;if(e.get("parentNode").one(".docked")){c.addClass("fixed");this.align.node=e.get("parentNode").one(".docked").one(this.alignNodeSelector)}}else{if(this.align.node.ancestor(".docked")||this.align.node.hasClass("docked")){this.align.node=b.one(this.alignNodeSelector)}}this.realign();a.superclass.show.call(this);GROUPS.UTILS.setCurrentOverlay(this)},render:function(){if(typeof this.dockNodeId!="undefined"&&this.dockNodeId!=null){GROUPS.PAGE._docNodeOverlayMap[this.dockNodeId].push(this)}a.superclass.render.call(this);if(this.align.node.ancestor(".docked")||this.align.node.hasClass("docked")){var c=b.one("#"+this.get("id"));if(c){c.addClass("fixed");this.alignedToClonedNode=true;c.setAttribute("data-origTop",(this.dockNode.getY()+this.dockNode.get("offsetHeight")+"px"))}}else{this.alignedToClonedNode=false}a.superclass.show.call(this)},destroy:function(c){a.superclass.destroy.call(this,c)},hide:function(){if(typeof GROUPS.PAGE._docNodeOverlayMap[this.dockNodeId]!="undefined"){}a.superclass.hide.call(this)},toggle:function(d,e){var c=true;b.all(".yui3-widget.yui3-overlay").each(function(g,f){if(g.one(d)!=null){if(g.hasClass("yui3-overlay-hidden")){c=false}}});if(c==false){this.show()}else{this.hide();if(e&&typeof e=="function"){e()}}}});b.namespace("Groups").Overlay=a},"0.1",{requires:["base","node","overlay"]});/*
YUI 3.15.0 (build 834026e)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("node-style",function(e,t){(function(e){e.mix(e.Node.prototype,{setStyle:function(t,n){return e.DOM.setStyle(this._node,t,n),this},setStyles:function(t){return e.DOM.setStyles(this._node,t),this},getStyle:function(t){return e.DOM.getStyle(this._node,t)},getComputedStyle:function(t){return e.DOM.getComputedStyle(this._node,t)}}),e.NodeList.importMethod(e.Node.prototype,["getStyle","getComputedStyle","setStyle","setStyles"])})(e);var n=e.Node;e.mix(n.prototype,{show:function(e){return e=arguments[arguments.length-1],this.toggleView(!0,e),this},_show:function(){this.removeAttribute("hidden"),this.setStyle("display","")},_isHidden:function(){return this.hasAttribute("hidden")||e.DOM.getComputedStyle(this._node,"display")==="none"},toggleView:function(e,t){return this._toggleView.apply(this,arguments),this},_toggleView:function(e,t){return t=arguments[arguments.length-1],typeof e!="boolean"&&(e=this._isHidden()?1:0),e?this._show():this._hide(),typeof t=="function"&&t.call(this),this},hide:function(e){return e=arguments[arguments.length-1],this.toggleView(!1,e),this},_hide:function(){this.setAttribute("hidden","hidden"),this.setStyle("display","none")}}),e.NodeList.importMethod(e.Node.prototype,["show","hide","toggleView"])},"3.15.0",{requires:["dom-style","node-base"]});
/*
YUI 3.15.0 (build 834026e)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("anim-base",function(e,t){var n="running",r="startTime",i="elapsedTime",s="start",o="tween",u="end",a="node",f="paused",l="reverse",c="iterationCount",h=Number,p={},d;e.Anim=function(){e.Anim.superclass.constructor.apply(this,arguments),e.Anim._instances[e.stamp(this)]=this},e.Anim.NAME="anim",e.Anim._instances={},e.Anim.RE_DEFAULT_UNIT=/^width|height|top|right|bottom|left|margin.*|padding.*|border.*$/i,e.Anim.DEFAULT_UNIT="px",e.Anim.DEFAULT_EASING=function(e,t,n,r){return n*e/r+t},e.Anim._intervalTime=20,e.Anim.behaviors={left:{get:function(e,t){return e._getOffset(t)}}},e.Anim.behaviors.top=e.Anim.behaviors.left,e.Anim.DEFAULT_SETTER=function(t,n,r,i,s,o,u,a){var f=t._node,l=f._node,c=u(s,h(r),h(i)-h(r),o);l?"style"in l&&(n in l.style||n in e.DOM.CUSTOM_STYLES)?(a=a||"",f.setStyle(n,c+a)):"attributes"in l&&n in l.attributes?f.setAttribute(n,c):n in l&&(l[n]=c):f.set?f.set(n,c):n in f&&(f[n]=c)},e.Anim.DEFAULT_GETTER=function(t,n){var r=t._node,i=r._node,s="";return i?"style"in i&&(n in i.style||n in e.DOM.CUSTOM_STYLES)?s=r.getComputedStyle(n):"attributes"in i&&n in i.attributes?s=r.getAttribute(n):n in i&&(s=i[n]):r.get?s=r.get(n):n in r&&(s=r[n]),s},e.Anim.ATTRS={node:{setter:function(t){return t&&(typeof t=="string"||t.nodeType)&&(t=e.one(t)),this._node=t,!t,t}},duration:{value:1},easing:{value:e.Anim.DEFAULT_EASING,setter:function(t){if(typeof t=="string"&&e.Easing)return e.Easing[t]}},from:{},to:{},startTime:{value:0,readOnly:!0},elapsedTime:{value:0,readOnly:!0},running:{getter:function(){return!!p[e.stamp(this)]},value:!1,readOnly:!0},iterations:{value:1},iterationCount:{value:0,readOnly:!0},direction:{value:"normal"},paused:{readOnly:!0,value:!1},reverse:{value:!1}},e.Anim.run=function(){var t=e.Anim._instances,n;for(n in t)t[n].run&&t[n].run()},e.Anim.pause=function(){for(var t in p)p[t].pause&&p[t].pause();e.Anim._stopTimer()},e.Anim.stop=function(){for(var t in p)p[t].stop&&p[t].stop();e.Anim._stopTimer()},e.Anim._startTimer=function(){d||(d=setInterval(e.Anim._runFrame,e.Anim._intervalTime))},e.Anim._stopTimer=function(){clearInterval(d),d=0},e.Anim._runFrame=function(){var t=!0,n;for(n in p)p[n]._runFrame&&(t=!1,p[n]._runFrame());t&&e.Anim._stopTimer()},e.Anim.RE_UNITS=/^(-?\d*\.?\d*){1}(em|ex|px|in|cm|mm|pt|pc|%)*$/;var v={run:function(){return this.get(f)?this._resume():this.get(n)||this._start(),this},pause:function(){return this.get(n)&&this._pause(),this},stop:function(e){return(this.get(n)||this.get(f))&&this._end(e),this},_added:!1,_start:function(){this._set(r,new Date-this.get(i)),this._actualFrames=0,this.get(f)||this._initAnimAttr(),p[e.stamp(this)]=this,e.Anim._startTimer(),this.fire(s)},_pause:function(){this._set(r,null),this._set(f,!0),delete p[e.stamp(this)],this.fire("pause")},_resume:function(){this._set(f,!1),p[e.stamp(this)]=this,this._set(r,new Date-this.get(i)),e.Anim._startTimer(),this.fire("resume")},_end:function(t){var n=this.get("duration")*1e3;t&&this._runAttrs(n,n,this.get(l)),this._set(r,null),this._set(i,0),this._set(f,!1),delete p[e.stamp(this)],this.fire(u,{elapsed:this.get(i)})},_runFrame:function(){var e=this._runtimeAttr.duration,t=new Date-this.get(r),n=this.get(l),s=t>=e;this._runAttrs(t,e,n),this._actualFrames+=1,this._set(i,t),this.fire(o),s&&this._lastFrame()},_runAttrs:function(t,n,r){var i=this._runtimeAttr,s=e.Anim.behaviors,o=i.easing,u=n,a=!1,f,l,c;t>=n&&(a=!0),r&&(t=n-t,u=0);for(c in i)i[c].to&&(f=i[c],l=c in s&&"set"in s[c]?s[c].set:e.Anim.DEFAULT_SETTER,a?l(this,c,f.from,f.to,u,n,o,f.unit):l(this,c,f.from,f.to,t,n,o,f.unit))},_lastFrame:function(){var e=this.get("iterations"),t=this.get(c);t+=1,e==="infinite"||t<e?(this.get("direction")==="alternate"&&this.set(l,!this.get(l)),this.fire("iteration")):(t=0,this._end()),this._set(r,new Date),this._set(c,t)},_initAnimAttr:function(){var t=this.get("from")||{},n=this.get("to")||{},r={duration:this.get("duration")*1e3,easing:this.get("easing")},i=e.Anim.behaviors,s=this.get(a),o,u,f;e.each(n,function(n,a){typeof n=="function"&&(n=n.call(this,s)),u=t[a],u===undefined?u=a in i&&"get"in i[a]?i[a].get(this,a):e.Anim.DEFAULT_GETTER(this,a):typeof u=="function"&&(u=u.call(this,s));var l=e.Anim.RE_UNITS.exec(u),c=e.Anim.RE_UNITS.exec(n);u=l?l[1]:u,f=c?c[1]:n,o=c?c[2]:l?l[2]:"",!o&&e.Anim.RE_DEFAULT_UNIT.test(a)&&(o=e.Anim.DEFAULT_UNIT);if(!u||!f){e.error('invalid "from" or "to" for "'+a+'"',"Anim");return}r[a]={from:e.Lang.isObject(u)?e.clone(u):u,to:f,unit:o}},this),this._runtimeAttr=r},_getOffset:function(e){var t=this._node,n=t.getComputedStyle(e),r=e==="left"?"getX":"getY",i=e==="left"?"setX":"setY",s;return n==="auto"&&(s=t.getStyle("position"),s==="absolute"||s==="fixed"?(n=t[r](),t[i](n)):n=0),n},destructor:function(){delete e.Anim._instances[e.stamp(this)]}};e.extend(e.Anim,e.Base,v)},"3.15.0",{requires:["base-base","node-style"]});
YUI.add("yg-utils",function(a){a.namespace("Groups").Utils=a.Base.create("Utils",a.Base,[],{getFormattedTimestamp:function(h,c){var b=new Date(),d=b.getTime()/1000,m=b.getTimezoneOffset()*60,l,k,n,g;if(GROUPS.TIMEZONE_OFFSET!=""){m=parseInt(GROUPS.TIMEZONE_OFFSET)}d+=m;if(d>h){l=d-h}else{l=h-d}k=new Date(h*1000);if(c){n=a.Date.format(new Date(k),{format:c})}else{if(l/(24*60*60)<1){c="%l:%M %p";n=a.Date.format(new Date(k),{format:"%l:%M %p"})}else{if(b.getFullYear()==k.getFullYear()){c="%b %d";n=a.Date.format(new Date(k),{format:"%b %d"})}else{c="%d %b, %Y";n=a.Date.format(new Date(k),{format:"%d %b, %Y"})}}}try{if(c.search("%b")!=-1){g=a.Date.format(new Date(k),{format:"%b"});n=n.replace(g,g[0].toUpperCase()+g.slice(1,3))}}catch(f){}return n},getLocaleDate:function(e){var f="",d=new Date(e*1000),b=GROUPS.LANG,c={month:"2-digit",day:"2-digit",year:"numeric"};if(d){f=d.toLocaleDateString(b,c)}return f},showWarningBeforeViewChange:function(c,k){var e,f,d,h,g,b;this.url=c;g=GROUPS.YRB_STRINGS.WARNING_UNSAVED_CHANGES_HEADER+"&nbsp"+GROUPS.YRB_STRINGS.STR_IN+"&nbsp<b>"+k;b=(k)?g:GROUPS.YRB_STRINGS.WARNING_UNSAVED_CHANGES_HEADER;e=GROUPS.UTILS.getTemplate("unsavedWarningDialog_template");f=a.Handlebars.compile(e);d=f({});h=a.Node.create(d);h=h.one("#unsaved-changes-warning");if(this.panel==null){this.panel=new a.Groups.Panel({srcNode:h,moveNode:h.ancestor(".yui3-skin-sam"),pv:false});a.on("click",function(l){GROUPS.PAGE.hasUnsavedChanges=false;this.panel.hide();GROUPS.ROUTER.navigate(this.url)},"#warning-unsaved-changes-ok",this);a.on("click",function(l){this.panel.hide()},"#warning-unsaved-changes-cancel",this)}a.one("#unsaved-header").setHTML(b);a.one("#unsaved-changes-warning").removeClass("hide");this.panel.show()},getErrorYRBString:function(d,b){var e,c;if(typeof b!="undefined"&&typeof GROUPS.API_ERROR_MSGS_MAP[b]!="undefined"&&typeof GROUPS.API_ERROR_MSGS_MAP[b][d]!="undefined"){e=GROUPS.API_ERROR_MSGS_MAP[b][d]}else{if(typeof GROUPS.API_ERROR_MSGS_MAP.common_errors[d]!="undefined"){e=GROUPS.API_ERROR_MSGS_MAP.common_errors[d]}else{e="STR_ERROR_DEFAULT"}}c=GROUPS.YRB_STRINGS.ERROR_STRINGS[e];if(d==2102){c=c.replace("{0}","<a href='/neo/dir'>").replace("{1}","</a>").replace("{2}","<a href='javascript:GROUPS.PAGE.showCreateGroup();'>").replace("{3}","</a>")}if(d==2109){var f=a.one("#yg-grp-main-img")?a.one("#yg-grp-main-img").getData("group"):"";c=c.replace("{0}","<a id='recover_group' data-group='"+f+"'>").replace("{1}","</a>")}if(typeof c=="undefined"){return""}else{return c}},handleSystemErrors:function(h,f,c){var b,e,d,g;if(typeof c!="undefined"){for(i in h.errors){d=i;g=h.errors[i];break}b=g.s;e=g.e}else{b=h.ygError["httpStatus"];e=h.ygError["errorCode"]}if(e==1146||e==1147){return"invalid_crumb"}if(b>=500||b==307||(b==403&&e==1153)){this.handleYGAPIErrorMessage("common_errors",e);this.populateErrorbar(h,f,e)}return""},getErrorTemplate:function(){return'<div class="yg-inline-err-msg"></div>'},refreshCrumb:function(b){var c="/api/v1/user/auth/crumb",d=function(f,g){if(g){return false}else{var e=a.JSON.parse(f);GROUPS.YG_CRUMB=e.ygData;b.call();return true}};GROUPS.IO.makeRequest(c,"GET",{},d)},getGroupTrendingTopics:function(e,b){var c,d="/neo/groups/"+e+"/conversations/grouptrending";GROUPS.IO.makeRequest(d,"GET",{},function(f,g){if(g){c=false}else{c=f}b.apply(this,[c])})},getGroupRecentPhotos:function(f,b,e){var c,d="/neo/groups/"+f+"/photos/recentphotos?count="+e;GROUPS.IO.makeRequest(d,"GET",{},function(g,h){if(h){c=false}else{c=g}b.apply(this,[c])})},handleYGAPIErrorMessage:function(d,f,c){var g,e,b=a.one("#yg-error-container");a.one(".page-loader").addClass("hide");if(f==1146||f==1147){return}if(f==1101){window.location=GROUPS.LOGIN_URL.replace(/%doneUrl%/g,encodeURIComponent(window.location))}else{if(f==1102){window.location="https://gh.bouncer.login.yahoo.com/login/?done="+encodeURIComponent(window.location)}}if(typeof c=="undefined"){c=this.getErrorYRBString(f,d)}if(f==2102){c=c.replace("{0}","<a href='/neo/dir'>").replace("{1}","</a>").replace("{2}","<a href='javascript:GROUPS.PAGE.showCreateGroup();'>").replace("{3}","</a>")}if(c!=""){b.removeClass("hide");a.one("#yg-error-message").setContent(c);b.one("#yg-error-cross").on("click",function(h){a.one("#yg-error-container").addClass("hide")},this);b.one("#yg-error-flag").on("dblclick",function(h){a.one("#yg-error-container").addClass("hide");a.one("#yg-debug-container").removeClass("hide");a.later(20000,a,function(){a.one("#yg-debug-container").addClass("hide")})},this)}},showAPIErrorMessage:function(f,c,e,d){var b=a.one("#yg-error-container");if(typeof d=="undefined"){errorMessage=this.getErrorMessage(f,e)}else{errorMessage=c}a.one(".page-loader").addClass("hide");a.log("errorMessage "+errorMessage);if(errorMessage!="NOOP"){b.removeClass("hide");a.one("#yg-error-message").setContent(errorMessage);var g=new a.Anim({node:b,duration:3,from:{height:0},to:{height:"46px"}});var g=new a.Anim({node:a.one(".yg-page .yg-grid"),duration:0.5,from:{marginTop:"70px"},to:{marginTop:"116px"}});g.run();b.one("#yg-error-cross").on("click",function(h){a.one("#yg-error-container").addClass("hide");a.one(".yg-page .yg-grid").setStyle("marginTop","")},this)}},getErrorMessage:function(c,b){var f,e,h=[],g=GROUPS.YRB_STRINGS.ERROR_STRINGS;if(!b){return}b=b.toString();c=c.replace(/\?.*/,"");if(/api\/v1\/groups\/(.*?)\/(.*)/.test(c)){f=c.match(/api\/v1\/groups\/(.*?)\/(.*)/);e=f[2].replace("_","/")}else{if(/api\/v1\/user\/(.*)\//.test(c)){f=c.match(/api\/v1\/user\/(.*)\//);e=f[1].replace("_","/")}else{if(/api\/v1\/groups\/(.*?)\/covers/.test(c)){e="group_cover_image"}else{if(/api\/v1\/groups\/(.*?)\/topics\/(\d+)/.test(c)){e="topics_topicid"}else{if(/api\/v1\/groups\/(.*?)\/messages\/(\d+)/.test(c)){e="messages_messageid"}else{if(/api\/v1\/groups\/(.*?)\/albums\/(\d+)/.test(c)){e="albums_albumid"}else{if(/api\/v1\/groups\/(.*?)\/albums\/(\d+)\/photos\/(\d+)/.test(c)){e="albums_albumid_photos_photoid"}else{if(/api\/v1\/dir\/categories\/(\d+)/.test(c)){e="categories_categoryid"}else{if(/api\/v1\/groups\/(.*?)\/database\/(\d+)\/records/.test(c)){e="database_tableid_records"}else{if(/api\/v1\/groups\/(.*?)\/members\/users\/membership/.test(c)){e="members_users_membership"}else{if(/api\/v1\/groups\/(.*?)/.test(c)){e="create_group"}else{if(/api\/v1\/groups\/groupurl/.test(c)){e="groupurl"}else{if(/api\/v1\/intls\/.+\/configs/.test(c)){e="intls_config"}else{if(/api\/v1\/user\/profile/.test(c)){e="profile"}}}}}}}}}}}}}}a.log("Url "+c+" errorStrPath "+e);if(typeof e!="undefined"&&e!=""){h.push("STR_ERROR_"+e.toUpperCase()+"_"+b);h.push("STR_ERROR_"+e.toUpperCase()+"_"+b.slice(0,-1)+"X");h.push("STR_ERROR_"+e.toUpperCase()+"_"+b.slice(0,-2)+"XX");h.push("STR_ERROR_"+e.toUpperCase()+"_XXX");for(var d=0;d<h.length;d++){if(g[h[d]]){return g[h[d]]}}}return g.STR_ERROR_DEFAULT},handleTransition:function(b,d){var c=new a.Anim({node:b,duration:(b.getAttribute("duration"))?b.getAttribute("duration"):0.5,to:{opacity:0}});c.on("end",function(f){if(d&&typeof d=="function"){d()}});c.run()},getFileTypeIcon:function(e){var b={audio:"audio",image:"img",video:"video",pdf:"pdf","zip|gzip":"zip","vnd.ms-excel|vnd.openxmlformats-officedocument.spreadsheetml.sheet":"excel","msword|vnd.openxmlformats-officedocument.wordprocessingml.document|vnd.oasis.opendocument.text":"doc","vnd.ms-powerpoint|vnd.openxmlformats-officedocument.presentationml.presentation":"ppt",text:"txt"};var d="";for(var c in b){d=new RegExp(c);if(d.test(e)){return b[c]}}return"unknown"},getLocalMsgSearchURL:function(b){return"/neo/groups/"+b+"/search/messages"},getFormattedYrb:function(b){return b.replace(/([\w_]*)\|(\d+)/g,function(c,k,g){var f=GROUPS.YRB_STRINGS[k].match(/\{.*,.*,(.*)\}/),l=f[1].split("|"),h=g,e;for(var d=0;d<l.length;d++){if(l[d].indexOf("#")!=-1){e=l[d].indexOf("#");if(h==parseInt(a.Lang.trim(l[d].substr(0,e)))){return l[d].substr(e+1)}}else{if(l[d].indexOf("<")!=-1){e=l[d].indexOf("<");if(h>parseInt(a.Lang.trim(l[d].substr(0,e)))){return l[d].substr(e+1).replace("{0}",h)}}else{if(l[d].indexOf(">")!=-1){e=l[d].indexOf("<");if(h<parseInt(a.Lang.trim(l[d].substr(0,e+1)))){return l[d].substr(e+1).replace("{0}",h)}}}}}})},getTemplate:function(c){var b=GROUPS.TEMPLATES;c+=".mu";return b[c]},isPlaceholderSupported:function(){var b=document.createElement("input");return("placeholder" in b)},fireYGBeacon:function(d){var b,c;c=new Image();b=a.QueryString.stringify(d);c.src="/neo/ygbeacon/?"+b},formatBytes:function(b){if(b>=1073741824){b=(b/1073741824).toFixed(2)+" GB"}else{if(b>=1048576){b=(b/1048576).toFixed(1)+" MB"}else{if(b>=1024){b=(b/1024).toFixed(0)+" KB"}else{if(b>1){b=b+" Bytes"}else{if(b==1){b=b+" Byte"}else{b="0 Byte"}}}}}return b},changeHelpUrl:function(){if(GROUPS.HELP_URLS){var f=GROUPS.HELP_URLS,m="",h="helpUri."+window.location.pathname,c=0,b=(GROUPS.LANG=="zh-Hant-HK")?"zh-HK":(GROUPS.LANG=="zh-Hant-TW"?"zh-TW":GROUPS.LANG);for(var e in f){var l=h.split("/"),g=e.split("/"),k=0;for(var d=0;d<l.length;d++){if(l[d]==g[d]){k++}}if(k>c){m="http://"+f[e].replace("%locale%",b.replace(/-/g,"_"));c=k}}if(a.one("#helpnav a")){a.one("#helpnav a").setAttribute("href",m)}}},enableSearch:function(c,d){var b=a.one("#yg-action-bar .yg-srch-form");if(b){b.removeClass("hide");b.ancestor("#yg-action-bar").delegate("key",function(f){d.call(c,f)},"down:13",".ms")}},searchTable:function(f,b){var d,h=f.currentTarget,c=b.node;if(f.target.hasClass("srch-cancel")||f.target.ancestor(".srch-cancel")){h.set("value","");c.all(".srch-cancel").addClass("hide");c.one(".table-srch-header").addClass("hide");c.one(".table-mod").removeClass("hide")}d=h.get("value");if(d!=""){c.all(".srch-cancel").removeClass("hide");c.one(".table-mod").addClass("hide");c.one(".table-srch-header").removeClass("hide");c.one(".table-srch-header").setHTML(GROUPS.YRB_STRINGS.STR_SEARCH_DATABASE.replace("{0}",a.Escape.html(d)))}else{c.one(".table-mod").removeClass("hide");c.one(".table-srch-header").addClass("hide");c.all(".srch-cancel").addClass("hide")}GROUPS.INSTR.beaconClick("yg-action-bar","search",1,false);var g=null;c.all(".yg-table-view-records .yg-table-recordrow").each(function(k){var e=false;if(d==""&&k.hasClass("hide")){k.removeClass("hide")}else{k.all(".yg-table-record").each(function(l){if(l.getHTML().toLowerCase().search(d.toLowerCase())!=-1){e=true}});if(e===false){k.addClass("hide")}else{k.removeClass("hide");if(g==null){g=k}}}});window.scrollTo(0,GROUPS.PAGE._scrollPos)},unescapeHTML:function(d){var b={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'\\"','"':'\\"',"&#x27;":"'","&#x2F;":"/","&#x60;":"`"};for(var c in b){var e=new RegExp(c,"g");d=d.replace(e,b[c])}return d},escapeHTML:function(d){var b={"'":"&#39;",'\\\\"':"&quot;",'"':"&quot;"};for(var c in b){var e=new RegExp(c,"g");d=d.replace(e,b[c])}return d},getRawContent:function(d,c,b){GROUPS.DETAIL_IO.makeRequest(d,"GET","",function(f,e){b.one(".raw-msg-container").removeClass("clicked");if(e){GROUPS.UTILS.handleYGAPIErrorMessage("fetch_raw_message",e.ygError.errorCode)}else{var g=a.JSON.parse(f);if(g.ygData){b.one(".raw-msg-container").setContent(g.ygData.rawEmail.replace(/\r\n/g,"<br />").replace(/\n/g,"<br />"));b.one(".raw-msg-container").removeClass("hide");b.one(".msg-content").addClass("hide");b.one(".msg-attachment-wrapper")?b.one(".msg-attachment-wrapper").addClass("hide"):"";if(b.one(".msg-poll-header")){b.one(".msg-poll-header").addClass("hide");b.one(".msg-poll-container").addClass("hide")}a.one(".page-loader").addClass("hide");if(b.one(".raw-msg-lnk button")){b.one(".raw-msg-lnk button").setContent(GROUPS.YRB_STRINGS.STR_HIDE_SOURCE)}else{b.one(".raw-msg-lnk").setContent(GROUPS.YRB_STRINGS.STR_HIDE_SOURCE)}}}})},hideRightRail:function(){var d=a.one("#yg-main-content .y-col2-1"),c=a.all("#yg-main-content #yg-action-bar .yom-actions-small"),b=a.one("#yg-main-content .y-col2-2");if(b&&!b.hasClass("hide")){b.addClass("hide");GROUPS.PAGE.toggleAds(false)}if(d){d.removeClass("y-col2-1")}if(c){c.setStyle("width","100%");c.removeClass("yom-actions-small")}},handleRightRailSplitter:function(c){var b=this;if(c){c.on("click",function(d){b.hideRightRail();c.remove();b.removeAllExpandNodes()})}},msgExpandHandle:function(b){this.hideRightRail();this.removeAllExpandNodes()},removeAllExpandNodes:function(){if(a.one(".msg-expand")){a.one(".msg-expand").remove()}if(a.one(".yg-splitter")){a.one(".yg-splitter").remove()}GROUPS.PAGE.hideTooltip()},toggleRawMessage:function(h,c,b){h.preventDefault();var g=h.currentTarget,k=g.getContent(),f=0;if(k==GROUPS.YRB_STRINGS.STR_VIEW_SOURCE){if(c.one(".raw-msg-container").getContent()==""&&!c.one(".raw-msg-container").hasClass("clicked")){c.one(".raw-msg-container").addClass("clicked");a.one(".page-loader").removeClass("hide");var d="/api/v1/groups/"+b.get("groupName");if(b.type=="topic-read"){f=c.getAttribute("data-msgid")}else{if(b.type=="pending-msg"){f=c.getAttribute("data-item");d=d+"/pending"}else{f=b.get("msgId")}}d=d+"/messages/"+f+"/raw";GROUPS.UTILS.getRawContent(d,b,c)}else{c.one(".raw-msg-container").removeClass("hide");c.one(".msg-content").addClass("hide");c.one(".msg-attachment-wrapper")?c.one(".msg-attachment-wrapper").addClass("hide"):"";if(c.one(".msg-poll-header")){c.one(".msg-poll-header").addClass("hide");c.one(".msg-poll-container").addClass("hide")}g.setContent(GROUPS.YRB_STRINGS.STR_HIDE_SOURCE)}}else{g.setContent(GROUPS.YRB_STRINGS.STR_VIEW_SOURCE);c.one(".raw-msg-container").addClass("hide");c.one(".msg-content").removeClass("hide");c.one(".msg-attachment-wrapper")?c.one(".msg-attachment-wrapper").removeClass("hide"):"";if(c.one(".msg-poll-header")){c.one(".msg-poll-header").removeClass("hide");c.one(".msg-poll-container").removeClass("hide")}}},maxUploadSizeCheck:function(f,c){var k,h,e,d,g,b=c<f.get("size");if(b){e=GROUPS.UTILS.getTemplate("fileuploadsize_template");g=a.Handlebars.compile(e);d=g({size:Math.round(c/1048576),title:GROUPS.YRB_STRINGS.STR_CHANGE_COVER_IMAGE});k=a.Node.create(d);k=k.one("#yg-edit-file-panel");h=new a.Groups.Panel({srcNode:k,moveNode:k.ancestor(".yui3-skin-sam"),visible:true});k.one("#file-edit-cancel").on("click",function(){if(h!=null){h.destroy()}});h.on("visibleChange",function(m){var l=!m.newVal;if(l){h.destroy()}});h.show()}return !b},showComposeHeader:function(b){b.one(".new-topic-mailto").toggleClass("hide");b.one(".new-topic-mailfrom").toggleClass("hide");w=b.one(".selected-mailfrom").get("offsetWidth");if(b.one(".mailfrom-menu ul")){b.one(".mailfrom-menu ul").setStyle("width",(w-3)+"px")}if(b.one(".mailto-menu ul")){b.one(".mailto-menu ul").setStyle("width",(w-3)+"px")}},showErrorPanel:function(c,b){t=GROUPS.UTILS.getTemplate("error_panel_template");template=a.Handlebars.compile(t);html=template({title:c,body:b});srcNode=a.Node.create(html);srcNode=srcNode.one("#yg-cover-file-panel");ygPanel=new a.Groups.Panel({srcNode:srcNode,moveNode:srcNode.ancestor(".yui3-skin-sam")});srcNode.one("#cover-validtypes-cancel").on("click",function(){ygPanel.hide();if(ygPanel!=null){ygPanel.destroy()}});ygPanel.show()},validateFormat:function(d){var b,n,e,c,m,f,k,h,l=["IMAGE/GIF","IMAGE/JPEG","IMAGE/PJPEG","IMAGE/PNG","IMAGE/X-PNG","IMAGE/BMP"],g=[".GIF",".JPG",".JPEG",".PJPEG",".PNG",".X-PNG",".BMP"];n=d.get("type");if(a.UA.ie==9){l=g}b=(a.Array(l).indexOf(n.toUpperCase())==-1)?false:true;if(!b){this.showErrorPanel(GROUPS.YRB_STRINGS.STR_CHANGE_COVER_IMAGE,GROUPS.YRB_STRINGS.STR_ERR_COVER_VALID_TYPES)}return b},showIEWarningDialog:function(){if(a.UA.ie&&a.UA.ie<=7){var d,e,c,f,b;d=GROUPS.UTILS.getTemplate("ie7WarningDialog_template");e=a.Handlebars.compile(d);c=e({});f=a.Node.create(c);f=f.one("#yg-ie7-warning-dialog");b=new a.Groups.Panel({srcNode:f,moveNode:f.ancestor(".yui3-skin-sam"),pv:false,hideOn:[{eventName:"clickoutside"},{node:a.one("#yg-ie7-warning-dialog-ok"),eventName:"click"}]});a.one("#yg-ie7-warning-dialog").removeClass("hide");b.show()}},loadCoverPhoto:function(d){var e=a.one(".cover-photo-holder"),c=true,b;if(e){b=e.getAttribute("data-cover");if(a.one("#yg-group-detail .yg-group-info")){if(a.one("#yg-group-detail .yg-group-info").getAttribute("data-cover-flag")=="0"){c=false}}if(b&&e.one("#cover-photo")&&(c||d)){e.one("#cover-photo").setStyle("backgroundImage","url('"+b+"')")}}},getAuthDetails:function(g){var e,b,d=new Array();if(g&&g.resourceCapabilityList.length>0){for(var c=0;c<g.resourceCapabilityList.length;c++){var f=g.resourceCapabilityList[c];e=f.resourceType;d[e]=f.capabilities}}return d},fetchThumbnails:function(b){if(!b){b=a.one("body")}b.all(".img-not-loaded").each(function(c){c.setStyle("backgroundImage","url("+c.getAttribute("data-imgurl")+")");c.removeClass("img-not-loaded")})},populateGlobals:function(c,b){if(c.spaceId&&a.Lang.isValue(c.spaceId)&&!b){GROUPS.INSTR_CONFIG.spaceId=c.spaceId}if(c.yg_api_cnt&&a.Lang.isValue(c.yg_api_cnt)){GROUPS.YG_API_CNT=c.yg_api_cnt}if((c.userId&&a.Lang.isValue(c.userId))||c.userId==""){GROUPS.USER_ID=c.userId}if(c.email&&a.Lang.isValue(c.email)){GROUPS.EMAIL=c.email}if(c.emailDomain&&a.Lang.isValue(c.emailDomain)){GROUPS.EMAIL_DOMAIN=c.emailDomain}if(typeof(c.adult_cookie)!="undefined"){GROUPS.ADULT_COOKIE=c.adult_cookie}if(typeof(c.adult_group)!="undefined"){GROUPS.ADULT_GROUP=c.adult_group}else{GROUPS.ADULT_GROUP=false}},populateErrorbar:function(e,d,c){var b;b=GROUPS.YG_SESSION_ID+" "+e.ygError.url+" "+e.ygError.method+" "+c+" Response Headers : "+d;a.one("#yg-debug-container").setHTML(a.Escape.html(b))},formatYCSUrl:function(b){if(b&&window.location.protocol=="https:"){b=b.replace(/http:\/\/(l|l1|ads).yimg.com/gi,"https://s.yimg.com")}return b},openUploadErrorPanel:function(g){if(this.ygPanel!=undefined){this.ygPanel.destroy(true);this.ygPanel=undefined}var b=this;var d=b.ygPanel,c,f;c=a.Handlebars.compile(GROUPS.UTILS.getTemplate("uploadError_template"))({loaderIconUrl:GROUPS.LOADER_ICON_URL});f=a.Node.create(c);b.ygPanelContainer=f;a.one("body").appendChild(f);b.ygPanel=new a.Groups.Panel({srcNode:f.one("#upload-error-panel"),visible:true});d=b.ygPanel;d.show();d.centered()},checkAdultGroup:function(e){if(GROUPS.ADULT_GROUP){var b=a.one(".main-container-child");if(b){b.addClass("hidden")}if((typeof(GROUPS.ADULT_COOKIE)=="undefined"||GROUPS.ADULT_COOKIE!="true")){var d=GROUPS.UTILS.getTemplate("adult_confirmation_template"),c=a.Handlebars.compile(d),h=e.node.one(".inv-details"),g={groupName:e.get("groupName"),homeUrl:window.location.protocol+"//"+window.location.hostname};if(h){g.invite={iref:h.getAttribute("iref"),email:h.getAttribute("inv-email")}}adultTemplate=c(g),adultGroupHTML=a.Node.create(adultTemplate),adultNode=adultGroupHTML.one("#yg-adult-confirmation-panel");e.ygAdultPanel=new a.Groups.Panel({srcNode:adultNode,moveNode:adultNode.ancestor(".yui3-skin-sam"),view:e,pv:false});adultNode.removeClass("hide");e.ygAdultPanel.show();var f=function(l){l.preventDefault();e.ygAdultPanel.hide();var k=a.one(".page-loader"),m=l.target.getData("param");k.removeClass("hide");GROUPS.IO.makeRequest(l.target.getAttribute("link")+m,"POST",{},function(n,o){if(n&&n.html!=""){if(l.target.hasClass("save")){if(b){b.removeClass("hidden")}}else{window.location.href=l.target.getAttribute("href")}}k.addClass("hide")})};adultNode.delegate("click",f,".yg-button",e);return}else{if(GROUPS.ADULT_COOKIE=="true"){if(b){b.removeClass("hidden")}}}}else{if(b){b.removeClass("hidden")}}},getScrollPostionForNode:function(c){var b=c.getY();if(a.one("#yucs")){b-=a.one("#yucs").get("offsetHeight")}if(a.one("#navbar-container")){b-=a.one("#navbar-container").get("offsetHeight")}if(a.one("#yg-actionbar-container")){b-=a.one("#yg-actionbar-container").get("offsetHeight")}return b},renderNewMarkup:function(f,g){var b=[],e=[],h=[],d=[],c=null;this.traverseDOM(f,false,b,e,c);this.traverseDOM(g,false,h,d,c);this.constructDOMTree(b,h,e,d)},traverseDOM:function(f,c,e,d,b){if(c===false&&f&&f.get("children").size()>10){c=true;b=f}if(b&&f.get("parentNode")==b){d.push(d.length)}while(f){if(!f.childNodes&&c){e.push(f)}else{this.traverseDOM(f.one("*"),c,e,b)}f=f.next()}},constructDOMTree:function(e,c,h,g){var f=0,d=0,b=h.length,k=g.length;while(f<b&&d<k){if(matchTree(e,c,h[f],h[f+1],g[d],g[d+1])){f++;d++}else{if(matchTree(e,c,h[f+1],h[f+2],g[d],g[d+1])){f=f+2;d=d+1;e[f].get("parentNode").remove(true)}else{if(matchTree(e,c,h[f],h[f+1],g[d+1],g[d+2])){f=f+1;d=d+2;e[f].get("parentNode").insertAfter(e[f],c[d])}else{f=f+2;d=d+2;e[f].get("parentNode").insertAfter(e[f],c[d]);e[f].get("parentNode").remove(true)}}}}if(f<b){while(f<b){e[f].get("parentNode").remove(true)}}if(d<k){while(d<k){e[b-1].get("parentNode").insertAfter(e[b-1],c[d])}}},matchTree:function(d,c,f,b,e,g){if(typeof b=="undefined"){b=d.length}if(typeof g=="undefined"){g=c.length}if((b-f)==(g-e)){i=f;j=e;while(i<=b){oldNode=d[i];newNode=c[j];if(oldNode.id!=newNode.id||oldNode.className!=newNode.className||oldNode.nodeType!=newNode.nodeType||(oldNode.nodeType===3&&oldNode.text.trim()!=newNode.text.trim())){break}i++;j++}if(i==b){return true}}return false},stripUltParams:function(c){var b=c.indexOf(";_ylc");if(b!=-1){c=c.substr(0,b)}return c},showPendingNotficationBar:function(b){GROUPS.DETAIL_IO.makeRequest("/api/v1/groups/"+b+"/pending","GET",{},function(h,f){if(!f){var g=GROUPS.UTILS.getTemplate("pendingnotificationsbar_template"),e=a.JSON.parse(h),m=a.Handlebars.compile(g),l=a.Handlebars.compile(GROUPS.UTILS.getTemplate("pending_notifications_template")),c=a.one("#pend-not-contnr"),k="";c.setAttribute("data-memberscount",e.ygData["membersCount"]);c.setAttribute("data-messagescount",e.ygData["messagesCount"]);c.setAttribute("data-photoscount",e.ygData["photosCount"]);GROUPS.UTILS.setPendingCount();if(e.ygData["membersCount"]>0&&c.getAttribute("pendMembPerm")==1){e.ygData["members"]=l({count:e.ygData["membersCount"],member:true})}if(e.ygData["messagesCount"]>0&&c.getAttribute("pendMsgPerm")==1){e.ygData["messages"]=l({count:e.ygData["messagesCount"],message:true})}if(e.ygData["photosCount"]>0&&c.getAttribute("pendPhotoPerm")==1){e.ygData["photos"]=l({count:e.ygData["photosCount"],photo:true})}if(e.ygData["postsCount"]>0&&c.getAttribute("pendPostPerm")==1){e.ygData["posts"]=l({count:e.ygData["postsCount"],post:true})}if(e.ygData["members"]||e.ygData["messages"]||e.ygData["photos"]||e.ygData["posts"]){e.ygData["groupName"]=b;k=m(e);a.one("#pend-not-contnr").setContent(k);if(GROUPS.PAGE.dockPos){window.scrollTo(0,GROUPS.PAGE.dockPos-2)}else{window.scrollTo(0,0)}var d=new a.Anim({node:a.one("#pend-not-contnr"),duration:0.5,from:{height:0},to:{height:"auto"}});d.run()}else{a.one("#pend-not-contnr").addClass("hide")}}})},toggleMessageHistory:function(d,c,b){c.one(".msg-content .qreply").toggleClass("hide");if(d.hasClass("expanded")){d.setHTML('<i class="yg-sprite"></i>'+GROUPS.YRB_STRINGS.STR_HIDE_MSG_HISTORY);GROUPS.INSTR.beaconClick(b,"message-show-quoted",1,false)}else{d.setHTML('<i class="yg-sprite"></i>'+GROUPS.YRB_STRINGS.STR_MSG_HISTORY);GROUPS.INSTR.beaconClick(b,"message-hide-quoted",1,false)}},openAttachmentPreview:function(d,c){if(this.ygPanel!=undefined){this.ygPanel.destroy(true);this.ygPanel=undefined}if(a.one("#file-image-area")){a.one("#file-image-area").remove()}if(a.one("#file-image-wrapper")){a.one("#file-image-wrapper").remove()}var n=this;var b=n.ygPanel,k,h;k=a.Handlebars.compile(GROUPS.UTILS.getTemplate("attachmentsread_image_preview_template"))({loaderIconUrl:GROUPS.LOADER_ICON_URL});h=a.Node.create(k);n.ygPanelContainer=h;a.one("body").appendChild(h);var e=a.one("body").getStyle("overflow"),f=a.one("html").getStyle("overflowY");a.one("body").setStyle("overflow","hidden");a.one("html").setStyle("overflowY","hidden");n.ygPanel=new a.Groups.Panel({srcNode:h.one("#file-image-panel"),width:"100%",height:a.DOM.winHeight()});b=n.ygPanel;a.one("#file-image-wrapper").setStyle("height",a.DOM.winHeight());var l=Math.min(d.getAttribute("pheight"),a.DOM.winHeight()),m=Math.min(d.getAttribute("pWidth"),a.DOM.winWidth()),g=a.one("#file-image-area");g.setStyle("maxHeight",(l)+"px");g.setStyle("maxWidth",(m)+"px");g.setAttribute("src",c);g.ancestor().one("a").on("click",function(){GROUPS.INSTR.beaconClick("yg-action-bar","att-download",1,false)},this);g.ancestor().one("a").setAttribute("href",d.getAttribute("orurl"));b.show();b.on("visibleChange",function(p){var o=!p.newVal;if(o){a.one("body").setStyle("overflow",e);a.one("html").setStyle("overflowY",f)}});a.on("load",function(o){g.setStyle("background","transparent")},g);window.scrollTo(0,0)},utf8_to_b64:function(b){return window.btoa(unescape(encodeURIComponent(b)))},b64_to_utf8:function(b){return decodeURIComponent(escape(window.atob(b)))},getZAXId:function(c){var b=c.split("/");if(typeof(b[0])!="undefined"&&b[0]=="#zax"){if(typeof(b[1])!="undefined"){return b[1]}else{return null}}else{return null}},isZAXEnabled:function(b){return((new RegExp(b).test(GROUPS.CONFIG.zaxEnabled))&&!GROUPS.PAGE._isMobile)||(GROUPS.HOST_LEVEL<2)},getQueryStringValue:function(b){return unescape(window.location.search.replace(new RegExp("^(?:.*[&\\?]"+escape(b).replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"))},panelOpen:function(c){var b=false;a.all(".yui3-widget.yui3-panel").each(function(e,d){if(e.one(c)!=null){if(!e.hasClass("yui3-panel-hidden")){b=true}}});return b},startAConversation:function(b){b=a.JSON.parse(b);var c={type:"ARTICLE",title:b.title,description:b.description,faviconURL:"",image:{url:b.imageUrl,html:"",width:0,height:0},video:{url:"",html:"",width:0,height:0},requestedURL:b.targetHostUrl,displayHostname:window.location.hostname};return c},getDownloadLink:function(b){if(b.indexOf("?")!=-1){b+="&download=1"}else{b+="?download=1"}return b},notifyScreenReader:function(c,b){if(b){a.one("#screenreader-infobox").setAttribute("aria-live","assertive")}else{a.one("#screenreader-infobox").setAttribute("aria-live","polite")}a.one("#screenreader-infobox").setHTML(c)},updateDropDownMenuFocus:function(c,b){if(GROUPS.PAGE._isDeskTop){c.currentTarget.addClass("focus");if(b.focusManager){b.focusManager.focus(c.currentTarget)}}},ddMenuSetFocus:function(c,b){if(GROUPS.PAGE._isDeskTop){setTimeout(function(){b.focusManager.focus(0);b.one(".focus")&&b.one(".focus").removeClass("focus")},0)}},setFocus:function(b){if(GROUPS.PAGE._isDeskTop&&b){setTimeout(function(){b.focus()},0)}},setCurrentOverlay:function(b){GROUPS.PAGE._currOverlay=b},getCurrentOverlay:function(){return GROUPS.PAGE._currOverlay},lightHouseMark:function(b,c,d){if(window.LH){window.LH.mark(b);if(typeof c!="undefined"){window.LH.measure(d,{startMark:this.startMarker,endMark:b});window.LH.beacon({clearMarks:true,clearMeasures:true,clearCustomEntries:true,clearTags:true})}else{this.startMarker=b}}},showMobilePreview:function(h){h.halt();var d,c=document.location.href,g=a.one("#mobilePreviewPanel");d=c.indexOf("?");if(d=="-1"){c+="?_mobilepv=1"}else{c+="&_mobilepv=1"}GROUPS.INSTR.beaconClick("yg-action-bar","mobilepreview",1,false);if(typeof(this.previewPanel)=="undefined"){var f,g,b=this;f=a.Handlebars.compile(GROUPS.UTILS.getTemplate("mobilePreviewPanel_template"))({loaderIconUrl:GROUPS.LOADER_ICON_URL});g=a.Node.create(f);a.one("body").append(g);this.previewPanel=new a.Groups.Panel({srcNode:g.one("#mobile-preview-panel"),moveNode:g.ancestor(".yui3-skin-sam"),width:"100%",height:"100%"});this.previewPanel.on("visibleChange",function(l){var k=!l.newVal;if(k){a.one("html").setStyle("overflow","auto");b.previewPanel.bodyNode.one("#mobile-pv-iframe").addClass("hide")}else{a.one("html").setStyle("overflow","hidden");b.previewPanel.bodyNode.one("#mobile-pv-iframe").removeClass("hide")}})}a.one("html").setStyle("overflow","hidden");this.previewPanel.show();this.previewPanel.bodyNode.one("#mobile-pv-iframe").removeClass("hide");this.previewPanel.bodyNode.one(".yg-abs-loading").removeClass("hide");this.previewPanel.bodyNode.one("#mobile-pv-iframe").setAttribute("src",c).on("load",function(k){k.target.ancestor("#mobile-preview").one(".yg-abs-loading").addClass("hide")});window.scrollTo(0,0)},setDefaultPendingTab:function(g){var k=a.one("#pend-not-contnr"),d,e,c,h="pendingmessages",f,b;if(k&&g){d=k.getData("messagescount");d=d==undefined?0:d;e=k.getData("memberscount");e=e==undefined?0:e;c=k.getData("photoscount");c=c==undefined?0:c;b=d;if(e>d){h="pendingmembers";b=e}if(c>b){h="pendingphotos"}f=g.getAttribute("href").replace(/pending(.*)$/,h);g.setAttribute("href",f)}},setPendingCount:function(){var f=a.one("#pend-not-contnr"),c,b,d,e;if(f){c=f.getData("messagescount");c=c==undefined?0:c;d=f.getData("memberscount");d=d==undefined?0:d;b=f.getData("photoscount");b=b==undefined?0:b;e=a.one(".pphotos-link");if(e){if(b>0){e.one("a").setHTML(GROUPS.YRB_STRINGS.STR_PHOTOS+" ("+b+")")}else{e.one("a").setHTML(GROUPS.YRB_STRINGS.STR_PHOTOS)}}e=a.one(".pmembers-link");if(e){if(d>0){e.one("a").setHTML(GROUPS.YRB_STRINGS.STR_MEMBERS+" ("+d+")")}else{e.one("a").setHTML(GROUPS.YRB_STRINGS.STR_MEMBERS)}}e=a.one(".pmessages-link");if(e){if(c>0){e.one("a").setHTML(GROUPS.YRB_STRINGS.STR_MESSAGES+" ("+c+")")}else{e.one("a").setHTML(GROUPS.YRB_STRINGS.STR_MESSAGES)}}}},animateHorizontally:function(e,c,d){var b=this;if(e){b._moveRight(e,c,d,function(){b._moveLeft(e,d)})}},setMainRole:function(){var d=a.one("#yg-main-content");try{var b=d.one(".y-col2-1");if(!b){b=d.one(".yg-grid")}b.setAttribute("role","main")}catch(c){a.log("No main role defined.")}},_moveRight:function(e,b,d,f){var c=setInterval(function(){e._node.scrollLeft+=d/10;if(e._node.scrollLeft>=b){clearInterval(c);f()}},d)},_moveLeft:function(d,b){var c=setInterval(function(){d._node.scrollLeft-=b/10;if(d._node.scrollLeft<=0){clearInterval(c)}},b)},cleanMessage:function(d){var g=/((<br>\s*)|(<p><\/p>))+/g,c=/(<br class="yui-cursor">)/g,f=/(<div class="yui3-resize-handles-wrapper"><\/div>)/g,e=/(<p>&nbsp;<\/p>)/g,b=/style="[^"]*"/g;d=d.replace('class="ygroups-quoted" style="display:none"','class="ygroups-quoted"');d=d.replace(c,"");d=d.replace(g,"");d=d.replace(f,"");d=d.replace(e,"");d=d.replace(b,"");return d}})},"1.0",{requires:["datatype-date","yg-panel","anim-base"]});YUI.add("groups-io",function(a){a.namespace("Groups").IO=a.Base.create("io",a.Base,[],{initializer:function(){this.requests={};this.urls={};this.retryRequest=false},abortRequest:function(d){var c=a.Object.size(this.requests);if(this.requests[d]){this.requests[d].abort();delete this.requests[d]}else{if(c>0){for(var b in this.requests){this.requests[b].abort()}this.requests={}}}},makeParallelRequest:function(c,k){var f=c.length;for(var e in c){var g=c[e],b=g.method,d=g.url,j=g.callback,h={};h.data=(g.payload)?g.payload:{};h.extraparams={resultCb:j};this.makeRequest(d,b,h,function(m,n,l){f--;var i=l.resultCb;i(m,n);if(f==0){k()}})}},makeRequest:function(e,d,q,f,m,o){var l,r="application/x-www-form-urlencoded",j="",k=true,c=true,g=false,i=GROUPS.AJAX_CALL_COUNT,p=this,b=false,n=false,s=false;if(d=="GET"){j="chrome=raw&tz="+encodeURIComponent(GROUPS.TIMEZONE)+"&ts="+(+new Date);if(GROUPS.YG_NO_SUBSCRIPTION!=""){j+="&noSubscription=true"}if(GROUPS.MOBILE_PV=="1"&&e.indexOf("_mobilepv")==-1&&typeof(q._mobilepv)=="undefined"){j+="&_mobilepv=1"}}else{j="gapi_crumb="+GROUPS.YG_CRUMB}if(e.indexOf("?")==-1){e+="?"+j}else{e+="&"+j}if(q&&q.extraparams){l=q.extraparams;q=q.data;delete q.extraparams}if(q&&q.hideApiError===false){c=false;delete q.hideApiError}if(q&&q.isPopUp){g=true;delete q.isPopUp}var h={method:d,headers:{"Content-Type":r},on:{start:function(t,u){if(c){a.one("#yg-error-container").addClass("hide");a.one(".yg-page .yg-grid").setStyle("marginTop","")}GROUPS.API_ERROR_MSGS=undefined},success:function(t,z,u){var y,w=z.getAllResponseHeaders();w+=" YUI IO return status: "+z.statusText;w+=" Response text: "+z.responseText;try{y=a.JSON.parse(z.responseText);a.log("Succesfull IO request "+z+" at time:"+(new Date()).getTime())}catch(x){y={ygError:{httpStatus:z.status,errorCode:1000}};f(null,y,l);a.log("Invalid JSON response, Succesfull IO request "+z+" at time:"+(new Date()).getTime());return}if(y.ygError){if(y.ygError.errorCode==1146||y.ygError.errorCode==1147){if(p.retryRequest==false){p.retryRequest=true;GROUPS.UTILS.refreshCrumb(function(){p.makeRequest(e.replace(/[&\?]gapi_crumb(.*)?/,""),d,q,f,m,o)})}else{p.retryRequest=false}}else{if(y.ygError.errorCode==1008){window.location.reload()}}f(null,y,l)}else{y.ygError={};if(typeof y.html=="undefined"){f(z.responseText,null,l)}else{if(y.html&&y.html==""){y.ygError.url=e;y.ygError.method=d;if(!g&&z.status!=""){GROUPS.UTILS.handleSystemErrors(y,w,1)}GROUPS.UTILS.populateGlobals(y,g);f(null,a.JSON.parse(z.responseText),l)}else{if(a.Lang.isArray(y.errors)&&y.errors.length>0&&!g&&z.status!=""){GROUPS.UTILS.handleSystemErrors(y,w,1)}var v=a.Lang.isArray(y.errors)&&y.errors.length==0?null:y.errors;GROUPS.UTILS.populateGlobals(y,g);f(y.html,v,l)}}}delete p.requests[u.requestCount]},failure:function(t,y,u){var x,v="";if(y&&typeof y.getAllResponseHeaders=="function"){v=y.getAllResponseHeaders()}v+=" Response text: "+y.responseText;v+=" YUI IO return status: "+y.statusText;a.log("IO request Failed, with readystate "+y.readyState+" and statusText "+y.statusText+" status "+y.status);a.log(y);if(y.status==302&&y.statusText=="Moved Temporarily"){window.location=GROUPS.LOGIN_URL.replace(/%doneUrl%/g,encodeURIComponent(window.location))}if((y.status==500&&y.statusText=="999 This page is currently unavailable")||(y.status==999&&y.statusText=="Unable to process request at this time -- error 999")){x={ygError:{httpStatus:y.status,errorCode:1009,url:e,method:d}};GROUPS.UTILS.handleSystemErrors(x,v);delete p.requests[u.requestCount];return}try{x=a.JSON.parse(y.responseText)}catch(w){x={ygError:{httpStatus:y.status,errorCode:1000,url:e,method:d}};if(y.statusText=="abort"){return}if(!g&&y.statusText!="abort"&&y.status!=""){GROUPS.UTILS.handleSystemErrors(x,v)}f(null,x,l);a.log("Invalid JSON response, Failed IO request "+y+" at time:"+(new Date()).getTime());return}if(y.statusText!="abort"&&y.status!=""){if(y.status==503&&x.ygError.errorCode==1008){window.location.reload()}else{x.ygError.url=e;x.ygError.method=d;GROUPS.UTILS.handleSystemErrors(x,v)}}f(null,x,l);delete p.requests[u.requestCount]},complete:function(t,v,u){this.requestObj=null;if(typeof o!="undefined"){o()}delete p.requests[u.requestCount]}},arguments:{url:e,method:d,payload:q,callback:f,formObject:m,completeCb:o,hideApiError:c,requestCount:i}};if(typeof m!="undefined"){h.form={id:m,useDisabled:true}}else{h.data=q}if(GROUPS.YG_SESSION_ID){GROUPS.YG_API_CNT++;a.io.header("Session-Id",GROUPS.YG_SESSION_ID+":"+GROUPS.YG_API_CNT.toString(16))}n=(d=="POST"&&(q&&typeof q=="string"&&(q.indexOf("&iref=")!=-1||q.indexOf("&invitetoken=")!=-1)));s=((d=="DELETE"&&(q&&typeof q.inviteemail!="undefined")));if(n||s){b=true;a.io.header("X-GroupUserId")}if(GROUPS.USER_ID!=""&&!b){a.io.header("X-GroupUserId",GROUPS.USER_ID)}a.io.header("X-Group-AJAX-Req",1);a.log("issuing an IO call for"+e+":"+(new Date()).getTime());this.requests[i]=a.io(e,h);this.urls[i]=e;GROUPS.AJAX_CALL_COUNT++;return i}})},"0.1",{requires:["querystring-stringify-simple"]});YUI.add("yg-leftnav",function(d){var b="selected";var c=d.Lang;var a=function(e){this.node=d.one("#yg-left-col");this.init=function(){var g=this,h=this.node.one(".yom-mygroups .yom-hd"),f=this.node.one(".yom-mygroups .yom-bd");this.selectedBaseNode=null;this.io=new d.Groups.IO();this.index=0;this.visibleMyGroupsCount=f.one("ul").get("children").size();this.fullMygroupsHash=null;if(this.node.one('input[name="full-mygroups-hash"]')){this.fullMygroupsHash=this.node.one('input[name="full-mygroups-hash"]').getAttribute("data-full-mygroups-hash");this.fullMygroupsHash=d.JSON.parse(this.fullMygroupsHash)}d.one("#yg-create-group").on("click",function(i){GROUPS.PAGE.showCreateGroup()},GROUPS.PAGE)};this.refresh=function(){if(!GROUPS.PAGE._isDeskTop){return}var h="/neo/user/"+GROUPS.YG_YID+"/mygroups",g=this,f=this.node.one(".mygroups-mask");f.removeClass("hidden");this.io.makeRequest(h,"GET",{},function(i,j){if(i){var k=d.Node.create(i.replace(/<!--.*-->/,""));d.one(".yom-mod.yom-mygroups").get("parentNode").setHTML(k.getHTML());if(g.overlay){g.overlay.destroy()}g.init()}f.addClass("hidden")})};this.removeSelectedLink=function(f){if(f!=null&&f.hasClass("selected")){f.removeClass("selected")}};this.processConfig=function(j){if(!GROUPS.PAGE._isDeskTop){return}var i=this.node.one(".yom-mygroups .yom-hd"),g=this.node.one(".yom-mygroups .yom-bd");switch(j.pageType){case"latest":var l=d.one("#yg-leftnav-home a");this.selectLink(d.one("#yg-left-col"),0,l);this.removeSelectedLink(d.one("#yg-managemygroups a"));this.removeSelectedLink(d.one("#yg-allgroups a"));this.removeSelectedLink(d.one("#yg-allmygroups a"));break;case"messages":if(g){var f=g.all("a"),k=j.pageInfo,m=k.name,h=(typeof k.url=="undefined")?GROUPS.TOPICS_URL_TEMPLATE.replace("%groupName%",m):k.url;if(this.fullMygroupsHash&&this.fullMygroupsHash[m]){if(this.fullMygroupsHash[m]["index"]<this.visibleMyGroupsCount){this.selectLink(g,this.fullMygroupsHash[m]["index"],f.item(this.fullMygroupsHash[m]["index"]))}else{this.appendGroupIntoLeftnav({name:m,url:h})}}else{this.appendGroupIntoLeftnav({name:m,url:h})}this.removeSelectedLink(d.one("#yg-managemygroups a"));this.removeSelectedLink(d.one("#yg-allgroups a"));this.removeSelectedLink(d.one("#yg-allmygroups a"))}break;case"sohomepage":var l=d.one("#yg-allgroups a");this.selectLink(d.one("#yg-left-col"),0,l);this.removeSelectedLink(d.one("#yg-mygroups"));this.removeSelectedLink(d.one("#yg-managemygroups a"));this.removeSelectedLink(d.one("#yg-allmygroups a"));break;case"allmygroups":var l=d.one("#yg-allmygroups a");this.selectLink(d.one("#yg-left-col"),0,l);this.removeSelectedLink(d.one("#yg-mygroups"));this.removeSelectedLink(d.one("#yg-managemygroups a"));this.removeSelectedLink(d.one("#yg-allgroups a"));break;case"managemygroups":case"mypreferences":var l=d.one("#yg-managemygroups a");this.selectLink(d.one("#yg-left-col"),0,l);this.removeSelectedLink(d.one("#yg-mygroups"));this.removeSelectedLink(d.one("#yg-allgroups a"));this.removeSelectedLink(d.one("#yg-allmygroups a"));break}};this.appendGroupIntoLeftnav=function(f){var r=this,h=this.node.one(".yom-mygroups .yom-bd ul"),m=h.get("children"),i=m.size(),q,n,o=m.item(i-1);if(c.isObject(f)){if(f.constructor.NAME==="node"){q=f}else{if(o&&o.one("a").getAttribute("title")==f.name){q=o}else{if(this.fullMygroupsHash&&this.fullMygroupsHash[f.name]){n=this.fullMygroupsHash[f.name]}else{var g=null,l=d.one("#yg-grp-main-img");if(l){var j=l.getAttribute("data-role").toLowerCase();g=[{type:j.substr(0,3),desc:j}]}n={name:f.name,url:f.url,userperm:g}}if(!this.mygroupsListTemplate){this.mygroupsListTemplate=GROUPS.UTILS.getTemplate("mygroups_template")}var p=d.Handlebars.compile(this.mygroupsListTemplate);var k=p({data:n});q=d.Node.create(k)}}if(r.visibleMyGroupsCount==i){h.appendChild(q)}else{o.replace(q)}r.selectLink(h.get("parentNode"),r.visibleMyGroupsCount,q.one("a"))}else{d.log("invalid param passed")}};this.selectLink=function(g,j,k){var i=this,h=this.selectedBaseNode,f=g.get("parentNode").hasClass("yom-mygroups");if(f){i.setActiveGroup(g,k.ancestor("li"));return}k.addClass(b);if(k.next()){k.next().addClass(b)}if(h){if(h.get("parentNode").hasClass("yom-mygroups")&&h.one(".active-grp")){h.one(".active-grp").removeClass("active-grp")}else{h=i.selectedBaseNode.all("a");h=(h)?h.item(i.index):null;if(h&&!k.compareTo(h)){h.removeClass(b);if(h.next()){h.next().removeClass(b)}}}}i.index=j;i.selectedBaseNode=g};this.setActiveGroup=function(f,i){var h=this,g=this.selectedBaseNode,j=f.one(".active-grp");if(j&&!j.compareTo(i)){j.removeClass("active-grp");i.addClass("active-grp")}else{i.addClass("active-grp")}h.selectedBaseNode=f};this.selectLinkHandler=function(f){var h=f.all("a"),g=this;h.each(function(j,i){j.on("click",function(){g.selectLink(f,i,j)})})};this.handleSuperUserLinks=function(){var f=this;d.use("yg-admin-leftnav",function(g){new g.Groups.AdminLeftNav({})})};if(d.one("#yg-mygroups")){this.init()}else{if(d.one(".disablegat")){this.handleSuperUserLinks()}}};d.namespace("Groups").leftNav=a},"0.1",{requires:["json-parse","handlebars"]});YUI.add("yg-actionbar",function(c){var a='<i class="yg-sprite tick"></i>',b=c.WidgetPositionAlign;c.namespace("Groups").ACTIONBAR=function(){this.activeView=null;this.delegateCbFunc=null;this.actionDelegatehandler=null;this.actionKeyHandler=null;this.handlers=[];this.init=function(f,h){var e,g="",d=this;this.activeView=f;this.delegateCbFunc=h;this.node=c.one("#yg-action-bar");this.viewOverlay=null;this.primViewOverlay=null;this.viewOptions=c.one("#yg-action-bar #yg-view-menu-options");this.primViewOptions=c.one("#yg-action-bar #yg-view-menu-options.prim-view-menu");this.actionDelegatehandler=this.node.delegate("click",this.actionHandler,"li",this);this.actionKeyHandler1=this.node.delegate("key",this.actionHandler,"down:13","li",this);this.actionKeyHandler2=this.node.delegate("key",this.handleViewMenu,"down:40",".yg-view-mnu",this)};this.actionHandler=function(d){if(d.currentTarget.hasClass("yg-view-mnu")&&!d.currentTarget.hasClass("btn-disabled")&&this.viewOptions){this.handleViewMenu(d)}else{if(d.currentTarget.hasClass("yg-view-prim-mnu")&&!d.currentTarget.hasClass("btn-disabled")&&this.primViewOptions){this.handlePrimViewMenu(d)}else{this.delegateCbFunc.call(this.activeView,d)}}};this.handlePrimViewMenu=function(h){h.preventDefault();var f=this,g=h.currentTarget;if(this.primViewOverlay==null){var d=(GROUPS.PAGE._isMobile)?[b.BL,b.TL]:[b.TL,b.BL];if(this.activeView.selectedView){if(this.primViewOptions.one(".lh-group")){selectedNode=this.primViewOptions.one(".lh-group").one("."+this.activeView.selectedTab);if(selectedNode){selectedNode.appendChild(a)}}}if(this.activeView.selectedViewFilter){if(this.primViewOptions.one(".first")){selectedNode=this.primViewOptions.one(".first").one("."+this.activeView.get("viewType"));if(selectedNode){selectedNode.appendChild(a)}}}this.primViewOverlay=new c.Groups.Overlay({align:{node:".yg-view-prim-mnu",points:d},bodyContent:this.primViewOptions.get("parentNode").getHTML()});this.primViewOverlay.render();oId="#"+this.primViewOverlay.get("id");f.pOlay=c.one(oId).one("#yg-view-menu-options.prim-view-menu");c.use("plugin",function(e){f.pOlay.plug(e.Plugin.NodeFocusManager,{descendants:"li",keys:{next:"down:40",previous:"down:38"},focusClass:"focus",circular:false})});this.handlers.push(f.pOlay.delegate("click",f.handlePrimViewOptionsClick,"li",f));this.handlers.push(f.pOlay.on("clickoutside",f.handlePrimViewOptionsOutsideClick,f));this.handlers.push(c.on("key",function(i){if(this.primViewOverlay){i.preventDefault();this.primViewOverlay.hide()}},f.pOlay,"down:27,9",f));this.primViewOverlay.hide();if(GROUPS.PAGE._isMobile){c.on("scroll",function(){if(f.primViewOverlay){f.primViewOverlay.hide()}},c.config.win,this)}this.primViewOverlay.on("visibleChange",function(j){var i=!j.newVal;if(i){f.pOlay.setAttribute("aria-hidden","true");f.node.one(".yg-view-prim-mnu").setAttribute("aria-expanded","false");if(GROUPS.PAGE._isDesktop){f.node.one(".yg-view-prim-mnu").focus()}}else{f.pOlay.setAttribute("aria-hidden","false");g.setAttribute("aria-expanded","true")}})}if(this.primViewOverlay.get("visible")){this.primViewOverlay.hide()}else{this.primViewOverlay.show()}};this.handlePrimViewOptionsOutsideClick=function(d){if(d.target==this.node.one(".yg-view-prim-mnu")||d.target.ancestor()==this.node.one(".yg-view-prim-mnu")){return}if(this.primViewOverlay){this.primViewOverlay.hide(d);this.primViewOverlay.get("contentBox").one("#yg-view-menu-options.prim-view-menu").setAttribute("aria-hidden","true");d.currentTarget.setAttribute("aria-expanded","false")}};this.handleViewMenu=function(g){g.preventDefault();var f=this;if(this.viewOverlay==null){var d=(GROUPS.PAGE._isMobile)?[b.BR,b.TR]:[b.TR,b.BR];if(this.activeView.get("subtype")=="spam"||this.activeView.get("subtype")=="trending"){if(this.viewOptions.one(".sortby-group")){this.viewOptions.one(".sortby-group").get("parentNode").remove()}}if(this.activeView.sort){if(this.viewOptions.one(".sortby-group")&&this.activeView.sort.sortField){selectedNode=this.viewOptions.one(".sortby-group").one("."+this.activeView.sort.sortField);if(selectedNode){selectedNode.appendChild(a);if(this.activeView.sort.sortablefield){this.viewOptions.one(".sortby-group").one("."+this.activeView.sort.sortablefield).appendChild(a.replace("tick",this.activeView.sort.sortOrder))}else{selectedNode.appendChild(a.replace("tick",this.activeView.sort.sortOrder))}}}}if(this.activeView.selectedView){if(this.viewOptions.one(".lh-group")){selectedNode=this.viewOptions.one(".lh-group").one("."+this.activeView.selectedView);if(selectedNode){selectedNode.appendChild(a)}}}if(this.activeView.selectedViewFilter){if(this.viewOptions.one(".first")){selectedNode=this.viewOptions.one(".first").one("."+this.activeView.selectedViewFilter);if(selectedNode){selectedNode.appendChild(a)}}}this.viewOverlay=new c.Groups.Overlay({align:{node:".yg-view-mnu",points:d},bodyContent:this.viewOptions.get("parentNode").getHTML()});this.viewOverlay.render();oId="#"+this.viewOverlay.get("id");f.mOlay=c.one(oId).one("#yg-view-menu-options");c.use("plugin",function(e){f.mOlay.plug(e.Plugin.NodeFocusManager,{descendants:"li",keys:{next:"down:40",previous:"down:38"},focusClass:"focus",circular:false})});this.handlers.push(f.mOlay.delegate("mouseenter",GROUPS.UTILS.updateDropDownMenuFocus,"li",this,f.mOlay));this.handlers.push(f.mOlay.on("mouseleave",function(h){this.one(".focus")&&this.one(".focus").removeClass("focus")}));this.handlers.push(f.mOlay.delegate("click",f.handleViewOptionsClick,"li",f));this.handlers.push(f.mOlay.on("clickoutside",f.handleViewOptionsOutsideClick,f));this.handlers.push(c.on("key",function(h){if(this.viewOverlay){h.preventDefault();this.viewOverlay.hide()}},f.mOlay,"down:27,9",f));this.viewOverlay.hide();this.viewOverlay.on("visibleChange",function(i){var h=!i.newVal;if(h){f.mOlay.setAttribute("aria-hidden","true");f.node.one(".yg-view-mnu").setAttribute("aria-expanded","false");if(!GROUPS.PAGE._isMobile&&!GROUPS.PAGE._isTablet){f.node.one(".yg-view-mnu").focus()}}else{f.mOlay.setAttribute("aria-hidden","false");f.node.one(".yg-view-mnu").setAttribute("aria-expanded","true");GROUPS.UTILS.ddMenuSetFocus(i,f.mOlay)}});if(GROUPS.PAGE._isMobile){c.on("scroll",function(){if(f.viewOverlay){f.viewOverlay.hide()}},c.config.win,this)}}if(this.viewOverlay.get("visible")){this.viewOverlay.hide()}else{this.viewOverlay.show()}};this.handlePrimViewOptionsClick=function(f){this.primViewOverlay.hide(f);this.primViewOverlay.get("contentBox").one("#yg-view-menu-options.prim-view-menu").setAttribute("aria-hidden","true");this.node.one(".yg-view-prim-mnu").setAttribute("aria-expanded","false");var d=f.target.getData("href");if(d!==undefined&&d!=""){if(f.target.getData("newtab")){window.open(d)}else{GROUPS.ROUTER.navigate(d)}}};this.handleViewOptionsClick=function(f){this.viewOverlay.hide(f);this.viewOverlay.get("contentBox").one("#yg-view-menu-options").setAttribute("aria-hidden","true");var d=f.target.getData("href");if(d!==undefined&&d!=""){if(f.target.getData("newtab")){window.open(d)}else{GROUPS.ROUTER.navigate(d)}}this.delegateCbFunc.call(this.activeView,f)};this.handleViewOptionsOutsideClick=function(d){if(d.target==this.node.one(".yg-view-mnu")||d.target.ancestor()==this.node.one(".yg-view-mnu")){return}if(this.viewOverlay&&this.viewOverlay.get("visible")){this.viewOverlay.hide(d);this.viewOverlay.get("contentBox").one("#yg-view-menu-options").setAttribute("aria-hidden","true")}};this.setSelectedTab=function(d,h){c.all("."+d).removeClass("btn-grey-selected");var e=h.hasClass(d)?h:h.ancestor("."+d);e.addClass("btn-grey-selected");if(e.getAttribute("aria-label")!=""){GROUPS.UTILS.notifyScreenReader(GROUPS.YRB_STRINGS.STR_SWITCH_TAB_SCREENREADER_MSG.replace("{0}",e.getAttribute("aria-label")))}if(e&&e.get("parentNode").one(".dockme")){var g=e.get("parentNode").one(".dockme"),f=e.get("parentNode").one(".docked");g.one("."+d).addClass("btn-grey-selected");if(f){f.one("."+d).addClass("btn-grey-selected")}}};this.reset=function(){if(this.viewOverlay){this.viewOverlay.destroy()}this.detachHandlers()},this.detachHandlers=function(){for(var d=0;d<this.handlers.length;d++){this.handlers[d].detach()}}}},"0.1",{requires:["yg-overlay"]});YUI.add("yg-recent-photos",function(a){RecentPhotos=a.Groups.RecentPhotos=a.Base.create("base",a.Base,[],{initializer:function(b){this.node=b.node;this.groupsInfo=b.groupsInfo;this.totalPhotos=b.totalPhotos;this.data="";this.countRecentPhotos()},countRecentPhotos:function(){var b=this;if(this.totalPhotos>this.get("totalPhotoSlots")){a.Object.each(this.groupsInfo,function(c){c.dist=Math.ceil(c.photoCount/b.totalPhotos*b.get("totalPhotoSlots"))})}this.fetchPhotos()},fetchPhotos:function(){var e=[],d="",b=this,f=[],c=function(g,h){if(h){}if(g){var i=a.JSON.parse(g).ygData;a.Object.each(i,function(k){if(f.length<b.get("totalPhotoSlots")){var l=k.photoInfo[0].width,j=k.photoInfo[0].height;k.recentPhoto=k.photoInfo[0].displayURL;if(l<b.get("thumbWidth")&&j<b.get("thumbHeight")){k.thumbWidth="auto";k.thumbHeight="auto"}else{if(l>j){k.thumbWidth="auto";k.thumbHeight="100%"}else{k.thumbWidth="100%";k.thumbHeight="auto"}}k.photoLink="/neo/groups/"+k.groupName+"/photos/albums/"+k.albumId+"/lightbox/"+k.photoId;f.push(k)}});b.node.one(".yg-recent-photos-container").removeClass("hide")}};a.Object.each(this.groupsInfo,function(h){var g=(h.dist==0)?h.photoCount:h.dist;d="/api/v3/groups/"+h.name+"/photos?start=0&count="+g;e.push({method:"GET",url:d,callback:c})});if(e.length>0){GROUPS.IO.makeParallelRequest(e,function(){var i=b.node.one("#yg-recent-photos-template").getHTML(),h,g;h=a.Handlebars.compile(i);g=h({photoData:f});b.node.one(".yg-recent-photos-container").setHTML(g)})}}},{ATTRS:{totalPhotoSlots:{value:12},thumbWidth:{value:66},thumbHeight:{value:66}}})},"0.1",{requires:["base","node","json","handlebars"]});YUI.add("yg-zax-base",function(b){var a=b.Base.create("base",b.Base,[],{initializer:function(){var c={position:"LREC2",modID:"ad"};this.Adtemplate=b.Node.create("<div>"+b.Handlebars.compile(GROUPS.UTILS.getTemplate("rightrailad_template"))(c)+"</div>");var e=[{name:"ZAX:shown",handler:b.bind(this._zaxVisible,this)},{name:"ZAX:destroyed",handler:b.bind(this._zaxDestroyed,this)},{name:"ZAX:mainContentUpdated",handler:b.bind(this._mainContentUpdated,this)}],d;for(d=0;d<e.length;d++){if(b.Lang.isString(e[d])){b.publish(e[d],{broadcast:true,prefix:"ZAX"})}else{b.publish(e[d].name,{emitFacade:true,broadcast:true,defaultFn:e[d].handler})}}this.renderNewPanel();this.navigate=true},renderNewPanel:function(){var c;c=b.Handlebars.compile(GROUPS.UTILS.getTemplate("zax_main_template"))({});this.srcNode=b.Node.create(c);b.one("body").appendChild(this.srcNode);this.ygPanel=new b.Groups.Panel({srcNode:this.srcNode.one("#zax-container"),width:b.Lang.isNumber(this.get("mainContentwidth"))?(this.get("mainContentwidth")+350)+"px":"auto",moveNode:this.srcNode.ancestor(".yui3-skin-sam"),height:Math.min(1000,0.9*b.DOM.winHeight())});GROUPS.INSTR.addModules("zax-container");if(!this.get("secondaryView")){this.srcNode.one(".zax-secondary-content").addClass("hide");this.srcNode.one(".zax-main-content").setStyle("height","100%")}if(!this.get("navigation")){this.srcNode.all(".outside-nav").addClass("hide")}if(!this.get("ads")){this.srcNode.one(".zax-ad").addClass("hide");this.srcNode.one(".additional").setStyle("height","100%")}this.callToAction=this.srcNode.one(".call-to-action").on("click",this.callToActionHandler,this);this.callToActionKey=this.srcNode.on("keydown",this.callToActionHandlerKey,this);if(!this.get("headerBack")){this.srcNode.one(".header-back").addClass("hide")}else{this.callToActionHeaderBack=this.srcNode.one(".header-back").on("click",this.callToActionHeaderBackHandler,this)}b.fire("ZAX:shown")},callToActionHeaderBackHandler:function(){if(window.history.length>1){window.history.go(-1)}else{window.location.hash=""}},destroyZAX:function(d){var c=!d.newVal;if(c){b.fire("ZAX:destroyed")}},_zaxDestroyed:function(){b.one("body").setStyle("overflow","auto");b.one("html").setStyle("overflowY","auto");this.callToAction.detach();this.callToActionKey.detach();if(this.callToActionHeaderBack){this.callToActionHeaderBack.detach()}this.srcNode.remove();this.ygPanel=null;GROUPS.INSTR.beaconClick("zax-container","zax-close",1,false);GROUPS.INSTR.removeModule("zax-container");GROUPS.ZAXView=null;if(this.navigate){window.location.hash=""}},_zaxVisible:function(){this.ygPanel.show();b.one("body").setStyle("overflow","hidden");b.one("html").setStyle("overflowY","hidden");this.ygPanel.on("visibleChange",this.destroyZAX,this)},updateMainContentWidth:function(c){this._set("mainContentwidth",c)},clearContent:function(){this.updateMainContent("&nbsp;");this.updateSecondaryContent("&nbsp;");this.updateAdditionalContent("&nbsp;");this.updateCallToActionContent("&nbsp;");this.srcNode.one(".zax-spinner").removeClass("hide")},updateContent:function(c){this.updateHeader(c.header);this.updateMainContent(c.mainContent);this.updateSecondaryContent(c.secondaryContent);this.updateAdditionalContent(c.additionalContent);this.updateCallToActionContent(c.callToActionContent);this.updateNavigationContent(c.navigationContent);GROUPS.INSTR.refreshModule("zax-container")},updateHeader:function(c){if(typeof(c)=="undefined"||!c){return}this.srcNode.one(".zax-header").setHTML(c);if(!this.get("headerBack")){this.srcNode.one(".zax-header").addClass("no-back")}},updateMainContent:function(c){if(typeof(c)=="undefined"||!c){return}if(b.Lang.isNumber(this.get("mainContentwidth"))){this.srcNode.one(".zax-main").setStyle("width",this.get("mainContentwidth")+"px")}this.srcNode.one(".zax-spinner").addClass("hide");this.srcNode.one(".zax-main-content").setHTML(c);b.fire("ZAX:mainContentUpdated")},updateSecondaryContent:function(c){if(typeof(c)=="undefined"||!c){return}this.srcNode.one(".zax-secondary-content").setHTML(c)},updateAdditionalContent:function(c){if(typeof(c)=="undefined"||!c){return}this.srcNode.one(".additional").setHTML(c)},updateCallToActionContent:function(c){if(typeof(c)=="undefined"||!c){return}this.srcNode.one(".call-to-action").setHTML(c)},updateModule:function(d,c){if(this.srcNode.one("#"+c)){this.srcNode.one("#"+c).setHTML(d)}},updateNavigationContent:function(c){if(typeof(c)=="undefined"||!c){return}if(typeof(c.prevNav)!="undefined"&&c.prevNav){this.srcNode.one(".zax-prev").one("a").replaceClass("lt-dactv","lt-actv").setAttribute("href",c.prevNav)}else{this.srcNode.one(".zax-prev").one("a").replaceClass("lt-actv","lt-dactv").removeAttribute("href")}if(typeof(c.nextNav)!="undefined"&&c.nextNav){this.srcNode.one(".zax-next").one("a").replaceClass("rt-dactv","rt-actv").setAttribute("href",c.nextNav)}else{this.srcNode.one(".zax-next").one("a").replaceClass("rt-actv","rt-dactv").removeAttribute("href")}},refreshAds:function(){this.srcNode.one(".zax-ad").setHTML(this.Adtemplate.getHTML());darla_event("LREC2")},_mainContentUpdated:function(){if(this.get("ads")){this.refreshAds()}},callToActionHandler:function(c){},callToActionHandlerKey:function(c){if(c.keyCode==37){if(this.srcNode.one(".lt-actv")){window.location.hash=this.srcNode.one(".lt-actv").getAttribute("href").split("#")[1]}}if(c.keyCode==39){if(this.srcNode.one(".rt-actv")){window.location.hash=this.srcNode.one(".rt-actv").getAttribute("href").split("#")[1]}}},destroy:function(){this.navigate=false;this.ygPanel.hide()}},{ATTRS:{secondaryView:true,navigation:true,ylk:null,zaxId:null,view:null,ads:true,mainContentwidth:600,headerBack:false}});b.namespace("Groups").ZAX=a},"0.1",{});YUI.add("yg-zax-groupsearch",function(b){function a(){var c=this;c.arguments=arguments;b.use("yg-zax-base",function(e){var d=c.arguments[0];a.superclass.constructor.apply(c,c.arguments)})}a.NAME="zaxGroupSearch";b.extend(a,b.Groups.ZAX,{initializer:function(){var c=this;this.getData();b.on("ZAX:mainContentUpdated",function(){c.loadRecentPhotos()});this.currentRequest=null},loadTrendingTopics:function(){var c=this,d;d=c.srcNode.one("#group-trending-topics");if(d){GROUPS.UTILS.getGroupTrendingTopics(c.get("zaxId"),function(e){if(e.length){d.appendChild(b.Node.create(e));d.removeClass("hide")}})}},loadRecentPhotos:function(){var c=this,d;d=c.srcNode.one("#group-recent-photos");if(d){var e=4;if(this.get("mainContentwidth")){e=Math.floor(this.get("mainContentwidth")/140)}GROUPS.UTILS.getGroupRecentPhotos(c.get("zaxId"),function(f){if(f.length){d.appendChild(b.Node.create(f));d.removeClass("hide");GROUPS.UTILS.fetchThumbnails();d.delegate("click",c.openLightBox,"a.square-top",c)}},e+1)}},openLightBox:function(d){d.halt();var c=d.currentTarget.getAttribute("href");window.open(c,"_blank")},getData:function(){var c=this,d="/neo/groups/"+this.get("zaxId")+"/groupSearchZAX";c.clearContent();c.updateNavigationLinks();if(this.currentRequest){GROUPS.DETAIL_IO.abortRequest(this.currentRequest)}this.currentRequest=GROUPS.DETAIL_IO.makeRequest(d,"GET",{},function(f,e){if(!e){c.updateViewContent(f)}})},updateViewContent:function(e){var c=b.Node.create("<div>"+e+"</div>");this.updateContent({header:GROUPS.YRB_STRINGS.STR_SEARCH_DATABASE.replace("{0}",'"'+b.Escape.html(this.get("view").query)+'"'),mainContent:c.one("#mainContent").getHTML(),additionalContent:c.one("#additionalContent").getHTML()});var f=this.srcNode.one(".join-button");if(f){f.delegate("click",this._joinNowButtonHandler,"a");var d=window.location.hash.split("/");if(typeof(d[2])!="undefined"&&d[2]=="referrer"){f.one("a").setAttribute("link",f.one("a").getAttribute("link")+"&referrer="+d[3]);this.updateHeader("&nbsp;")}}},_joinNowButtonHandler:function(c){window.open(c.currentTarget.getAttribute("link"),"_blank")},updateNavigationLinks:function(){var e=b.one("[zax-data="+this.get("zaxId")+"]"),d=new Array(),c=this;if(e){if(e.previous("[zax-data]")){d.prevNav=e.previous("[zax-data]").one("a").getAttribute("href")}if(e.next("[zax-data]")){d.nextNav=e.next("[zax-data]").one("a").getAttribute("href")}else{c.loadNextPage(function(){e=b.one("[zax-data="+c.get("zaxId")+"]");if(e.next("[zax-data]")){d.nextNav=e.next("[zax-data]").one("a").getAttribute("href")}c.updateNavigationContent(d)})}}c.updateNavigationContent(d)},loadNextPage:function(d){var c=this.get("view");c.model.getSRPData("/api/v1/search/groups?offset="+c.offset+"&maxHits="+c.maxHits+"&sortBy="+c.sortBy+"&query="+c.query,c,"scroll",d)},invoke:function(c){this.set("zaxId",c);this.getData()}});b.namespace("Groups").zaxGroupSearch=a},"0.1",{});YUI.add("yg-global-srp",function(a){a.Groups.globalSRPModel=a.Base.create("globalSRPModel",a.Model,[],{getSRPData:function(d,c,b,e){GROUPS.IO.makeRequest(d,"GET","",function(g,f){if(f){if(!(f.ygError.httpStatus>=500||f.ygError.httpStatus==307)){var i=GROUPS.UTILS.getErrorYRBString(f.ygError.errorCode,c.get("subtype")),h=a.Node.create(GROUPS.UTILS.getErrorTemplate());h.setHTML(i);if(b=="sort"){c.node.one("#yg-srp-list ul").setHTML(h)}else{h.appendTo(c.node.one("#yg-srp-list ul"))}c.node.one(".yg-inline-err-msg").addClass("fc-red");a.one(".page-loader").addClass("hide");a.one(".yg-loading").addClass("hide")}}else{c.renderNextPage(a.JSON.parse(g).ygData,b);if(typeof(e)=="function"){e()}}})}},{ATTRS:{}});a.Groups.globalSRPView=a.Base.create("globalSRPView",a.View,[],{events:{"#filter-drop a":{click:"handleListSort"},".yg-grplist-name a":{click:"openLink"}},initializer:function(){var b=this;b.node=b.get("container");b.model=new a.Groups.globalSRPModel;b.updating=false;b.adMaxPages=9;b.shownPages=0},render:function(){if(this.get("html")!==""){var b=this.get("container");b.setHTML(this.get("html"));b.addClass("main-container-child")}return this},getAdStartPosition:function(){var b,c;b=this.node.one("#yg-srp-list ul").all(".yg-grp-row").size();c=(4+(b/this.maxHits-1)*2)%10;if(c==0){c=12}return c},openLink:function(b){if(b.currentTarget.getAttribute("target")=="_blank"){b.halt();window.open(b.currentTarget.getAttribute("href"))}},renderNextPage:function(g,c){var b=GROUPS.UTILS.getTemplate("browsegroups_template"),d=this.node.one("#yg-srp-list ul"),j=d.getContent(),k,h,n;this.shownPages++;if(!this.pageLoader.hasClass("hide")){this.pageLoader.addClass("hide")}if(g){var e=this.getAdStartPosition();GROUPS.PAGE.showAds(true,false);GROUPS.INSTR.firePageBeacon("global-srp-"+c,"yg-srp-list");for(var f in g.groups){if(g.groups[f]["photoUrl"]==undefined||g.groups[f]["photoUrl"]==""){delete (g.groups[f]["photoUrl"])}if(typeof g.groups[f]["photoHeight"]=="undefined"||typeof g.groups[f]["photoWidth"]=="undefined"){g.groups[f]["thumbHeight"]="100%";g.groups[f]["thumbWidth"]="100%"}else{var m=g.groups[f]["photoHeight"],l=g.groups[f]["photoWidth"];if(m<50&&l<50){g.groups[f]["thumbHeight"]="auto";g.groups[f]["thumbWidth"]="auto"}else{if(m>l){g.groups[f]["thumbHeight"]="auto";g.groups[f]["thumbWidth"]="100%"}else{g.groups[f]["thumbHeight"]="100%";g.groups[f]["thumbWidth"]="auto"}}}if(g.groups[f]["latestMsgActCount"]==0||g.groups[f]["latestMsgActCount"]==undefined){g.groups[f]["hasConversation"]=false}else{g.groups[f]["hasConversation"]=true}g.groups[f]["lastActivity"]=GROUPS.UTILS.getFormattedTimestamp(g.groups[f]["lastPosted"]/1000);g.groups[f]["restricted"]=g.groups[f]["restricted"].toLowerCase();if(typeof g.groups[f]["intlCode"]=="undefined"||g.groups[f]["intlCode"].toLowerCase()==GROUPS.INTL){g.groups[f]["relativeUrl"]=1;g.groups[f]["groupInfoLink"]="/neo/groups/"+g.groups[f].name+"/info"}else{g.groups[f]["groupInfoLink"]=GROUPS.HTTP_PROTOCOL+g.groups[f]["groupUrl"]+"/neo/groups/"+g.groups[f].name+"/info"}if(this.shownPages<=this.adMaxPages&&e==parseInt(f)){g.groups[f]["adContainer"]=GROUPS.PAGE.getMBADContainer();e+=12}g.groups[f]["images"]={defaultGroupsIcon:GROUPS.DEFAULT_GROUPS_ICON};g.groups[f]["images"]={isSearch:true};if((new RegExp(/group/)).test(GROUPS.CONFIG.zaxEnabled)&&!GROUPS.PAGE._isMobile&&this.query){if(GROUPS.PAGE._isTablet){queryString="?p="+this.query+"&fr="+this.fr+"#zax/"+g.groups[f].name}else{queryString="?query="+this.query+"#zax/"+g.groups[f].name}g.groups[f]["groupInfoLink"]="/neo/search"+queryString;g.groups[f]["zax-data"]=g.groups[f].name}}k=a.Handlebars.compile(b);h=k(g);if(c=="scroll"){d.setHTML(j+h)}else{d.setHTML(h)}GROUPS.UTILS.fetchThumbnails(a.one("#yg-srp-list"));if(g.groups.length<this.maxHits){this.canPageScroll=false}if(this.shownPages<=this.adMaxPages){GROUPS.PAGE.fillMBAds(true,true)}}this.updating=false;this.offset=this.node.one("#yg-srp-list ul").all(".yg-grp-row").size()},initView:function(){var b=this;b.shownPages=1;a.use("handlebars","datatype-date","json",function(e){var c=b.node.one("#yg-srp-container"),d=b.node.one("#filter-drop");b.query=c.getAttribute("query-str");b.fr=c.getAttribute("fr");b.totalCount=parseInt(c.getAttribute("total-count"),10);b.offset=b.node.one("#yg-srp-list ul").all(".yg-grp-row").size();b.maxHits=10;b.sortBy="RELEVANCE";b.pageLoader=e.one(".page-loader");b.canPageScroll=true;if(b.node.one(".sort-filter")){b.node.one(".sort-filter").on("clickoutside",function(){d.addClass("no-border-radius-bottom");d.get("parentNode").one("i").removeClass("yg-mygrplist-dd-open");d.get("parentNode").removeClass("sort-filter-selected");d.replaceClass("show","hide")})}if(b.totalCount>b.offset){b.node.one(".yg-loading").removeClass("hide");b.scrollHandle=e.on("scroll",b._handleWindowScroll,e.config.win,b);b._handleWindowScroll()}b.after("destroyedChange",function(f){if(b.get("destroyed")){if(b.scrollHandle){b.scrollHandle.detach()}if(b.hashHandler){b.hashHandler.detach()}if(typeof(GROUPS.ZAXView)!="undefined"&&GROUPS.ZAXView){GROUPS.ZAXView.destroy()}}});e.one("#yg-srp-container").delegate("click",function(g){if(g.target.hasClass("sort-filter")||g.target.ancestor(".sort-filter")){var f=b.node.one("#filter-drop");if(f.hasClass("show")){f.addClass("no-border-radius-bottom");f.replaceClass("show","hide");f.get("parentNode").one("i").removeClass("yg-mygrplist-dd-open");f.get("parentNode").removeClass("sort-filter-selected")}else{f.replaceClass("hide","show");f.addClass("no-border-radius-bottom");f.get("parentNode").addClass("sort-filter-selected");f.get("parentNode").one("i").addClass("yg-mygrplist-dd-open")}}else{if(g.target.hasClass("mob-filter")&&g.target.one("a")){viewObj.handleListSort(g)}}},".sort-filter",this);if(b.get("zaxId")){b._initZaxView()}});GROUPS.PAGE.fillMBAds(true);GROUPS.PAGE.showAds();GROUPS.UTILS.fetchThumbnails(a.one("#yg-srp-container"));b.hashHandler=a.on("hashchange",b.hashChangeHandler,a.config.win,b);b.hashChangeHandler()},hashChangeHandler:function(c){var b=GROUPS.UTILS.getZAXId(window.location.hash);if(b){if(typeof(GROUPS.ZAXView)!="undefined"&&GROUPS.ZAXView){GROUPS.ZAXView.invoke(b)}else{this._initZaxView(b)}}else{if(typeof(GROUPS.ZAXView)!="undefined"&&GROUPS.ZAXView){GROUPS.ZAXView.destroy()}}},handleListSort:function(c){c.preventDefault();this.canPageScroll=true;var b=(c.currentTarget.get("tagName")=="A")?c.currentTarget:c.currentTarget.one("a");overlay=this.node.one("#filter-drop");overlay.addClass("no-border-radius-bottom");this.node.all("#filter-drop li").toggleClass("hide");overlay.get("parentNode").one("i").removeClass("yg-mygrplist-dd-open");overlay.get("parentNode").removeClass("sort-filter-selected");this.node.all("#filter-drop li").removeClass("hide");b.ancestor(".mob-filter").addClass("hide");this.node.one(".sort-filter span").setHTML(b.getHTML());switch(b.getAttribute("order")){case"member":this.sortBy="MEMBERS";break;case"lactivity":this.sortBy="LATEST_ACTIVITY";break;case"newest":this.sortBy="NEWEST";break;case"oldest":this.sortBy="OLDEST";break;case"relevance":default:this.sortBy="RELEVANCE";break}this.offset=0;this.pageLoader.removeClass("hide");this.model.getSRPData("/api/v1/search/groups?offset="+this.offset+"&maxHits="+this.maxHits+"&sortBy="+this.sortBy+"&query="+this.query+"&useSpellingSuggestion=false",this,"sort");if(this.get("scrollY")){window.scroll(0,this.get("scrollY"))}},_handleWindowScroll:function(){if(this.node.one(".yg-loading").inViewportRegion()){if(this.canPageScroll&&(this.offset<this.totalCount)){if(!this.updating){this.updating=true;this.node.one(".yg-loading").removeClass("hide");this.model.getSRPData("/api/v1/search/groups?offset="+this.offset+"&maxHits="+this.maxHits+"&sortBy="+this.sortBy+"&query="+this.query+"&useSpellingSuggestion=false",this,"scroll")}}else{this.node.one(".yg-loading").addClass("hide")}}},_initZaxView:function(b){if(typeof(b)=="undefined"){b=this.get("zaxId")}var c=Math.min(a.DOM.winWidth()-500,750);if(GROUPS.PAGE._isTablet){c="auto"}GROUPS.ZAXView=new a.Groups.zaxGroupSearch({zaxId:b,secondaryView:false,navigation:true,view:this,ylk:this.node.one("#yg-srp-list").getData("ylk"),ads:false,mainContentwidth:c,headerBack:true})}},{ATTRS:{html:{value:""},groupName:{value:""},subType:{value:""},zaxId:{value:""}}});GROUPS.VIEWS["yg-global-srp"]=a.Groups.globalSRPView},"0.1",{requires:["base","node","view","model","groups-io"]});YUI.add("latest-updates",function(b){var a=b.Base.create("latestUpdates",b.View,[],{initializer:function(){this.node=this.get("container")},initView:function(){window.scrollTo(0,0);this.count=this.node.all(".update-list").size();if(b.one(".yg-p-loading")){this.loader=b.one(".yg-p-loading")}this.initHandlers();this.pageLoader=b.one(".page-loader");if(b.one("#start-new-group")){if(b.one("#start-new-group").get("value")=="true"){GROUPS.PAGE.createGroup.showCreateGroup()}}GROUPS.PAGE.fillMBAds();GROUPS.PAGE.cacheRecentPhotosNode();GROUPS.PAGE.showAds(true,false);GROUPS.UTILS.fetchThumbnails()},initHandlers:function(){var c=this;if(b.one(".updates-list div")!=null&&b.one(".updates-list div").hasClass("update-by-group")){b.one(".actions-lt .updates-group").addClass("btn-grey-selected")}else{if(b.one(".actions-lt .updates-recent")){b.one(".actions-lt .updates-recent").addClass("btn-grey-selected")}}if(c._scrollHandle){c._scrollHandle.detach()}if(!c._attachmentThumbnailTemplate){c._numOfThumb=(GROUPS.PAGE._isMobile)?4:6;c._attachmentThumbnailTemplate=b.Handlebars.compile(GROUPS.UTILS.getTemplate("updateslist_thumbnail_template"))}if(b.one("#memwiz-target")){b.one("#memwiz-target").on("click",function(d){window.open(window.location.protocol+"//"+window.location.hostname+d.target.getAttribute("data-target"),"_blank")})}b.after("Lightbox:Closed",function(d){GROUPS.LEFTNAV.processConfig({pageType:"latest",pageInfo:""})},c);GROUPS.ACTIONBAR.init(this,this.switchTab)},refreshPage:function(f,d){var c=this;if(d==null&&b.one(".actions-lt li.btn-grey-selected")!=null){d=b.one(".actions-lt li.btn-grey-selected a").get("href")}this.pageLoader.removeClass("hide");b.one(".loader-icon").removeClass("hide");b.one(".updates-list").addClass("hidden");d+="&noCreateGrpTemplates=true&noRecentPhotos=true";GROUPS.IO.makeRequest(d,"GET",{},function(e,g){if(e){c._set("html",e);c.render();c.initView();if(b.one("#right-rail-container")){b.one("#right-rail-container").insertBefore(GROUPS.PAGE.recentPhotosNode,b.one("#yom-ad-LREC"))}GROUPS.PAGE._dockNodeList=b.all(".dockme");c.pageLoader.addClass("hide");GROUPS.PAGE.showAds(true,false);GROUPS.UTILS.fetchThumbnails();if(GROUPS.INSTR){GROUPS.INSTR.rapidDestroy();GROUPS.INSTR_CONFIG=GROUPS.INSTR.updateRapidParams(GROUPS.INSTR_CONFIG);GROUPS.INSTR=new b.Groups.Instrumentation(GROUPS.INSTR_CONFIG)}}})},switchTab:function(d){var f,c=null;if(d.target.hasClass("updates-recent")||d.target.ancestor(".updates-recent")||d.target.hasClass("updates-group")||d.target.ancestor(".updates-group")){d.preventDefault();d.stopPropagation();if(d.target.get("tagName")=="A"){f=d.target.get("parentNode");c=d.target.get("href")}else{f=d.target;c=f.one("a").get("href")}if(f.hasClass("btn-grey-selected")){return}GROUPS.ACTIONBAR.setSelectedTab("mob-view",f);this.refreshPage(d,c)}else{if(d.target.hasClass("refresh-btn")||d.target.ancestor(".refresh-btn")){d.preventDefault();d.stopPropagation();GROUPS.INSTR.beaconClick("yg-action-bar","refresh",1,false);this.refreshPage(d,c)}}},render:function(){if(this.get("html")!==""){var c=this.get("container");c.setHTML(this.get("html"));c.addClass("main-container-child")}}},{ATTRS:{html:{value:""}}});b.namespace("Groups").latestUpdates=a;GROUPS.VIEWS["latest-updates"]=b.Groups.latestUpdates},"0.1",{requires:["base","node","json","view","groups-io","anim-base"]});YUI.add("yg-navbar",function(d){var a="selected";var c=d.Lang;var b=function(f){var e=this;this.init=function(g){this.callRender=true;this.groupName=g;this.node=d.one("#yg-group-detail-navbar");this.showMoreItemsFlag=true;this.menuStyle=this.node.getData("menu-style");if(this.menuStyle!=="icon-only"){this.moreNavItems=d.one("#groupdetail-navbar-moreitems").one("#morenav-items");this.initMoreNavMenu();this.moreNavItems.delegate("click",this.showExtraNavItem,"li",this);this.moreNavItems.on("clickoutside",this.handleOutsideClick,this)}this.settMenuOverlay=null;this.memMenuOverlay=null;this.profListOverlay=null;this.node.delegate("click",this.showSettMenu,"#settnav",this);this.node.delegate("click",this.showMemMenu,"#memnav",this);if("ontouchstart" in document.documentElement){this.node.delegate("tap",this.menuItemClick,".nav-lt li",this)}else{this.node.delegate("click",this.menuItemClick,".nav-lt li",this)}this.node.delegate("key",this.showSettMenu,"down:13, 40","#settnav");this.node.delegate("key",this.showMemMenu,"down:13, 40","#memnav");if(GROUPS.PAGE._isDeskTop){this.node.delegate("hover",this.menuMouseIn,this.menuMouseOut,".nav-lt li",this)}},this.initMoreNavMenu=function(){var h=d.WidgetPositionAlign,g;if(this.overlay==null){this.overlay=new d.Groups.Overlay({align:{node:"#morenav",points:[h.TL,h.BL]},bodyContent:this.moreNavItems});this.overlay.render();g=this.overlay.get("contentBox").one("#morenav-items");this.node.one("#morenav").setAttribute("data-id",this.overlay.get("contentBox").getAttribute("id"));this.node.delegate("click",this.handleMoreNavClick,"#morenav",this);this.node.delegate("key",this.handleMoreNavClick,"down:13,40","#morenav",this);d.on("key",function(i){this.hideOverlay();d.one("#morenav").focus()},["#morenav",g],"down:27,9",this);g.plug(d.Plugin.NodeFocusManager,{descendants:"li a",focusClass:"focus",keys:{next:"down:40",previous:"down:38"},circular:false});g.delegate("mouseenter",GROUPS.UTILS.updateDropDownMenuFocus,"li a",this,g);g.on("mouseleave",function(i){this.one(".focus")&&this.one(".focus").removeClass("focus")});this.overlay.hide()}},this.menuMouseIn=function(g){g.currentTarget.addClass("menu-hl")},this.menuMouseOut=function(g){g.currentTarget.removeClass("menu-hl")},this.menuItemClick=function(i){var h=i.currentTarget;if(h.get("id")=="morenav"||h.one("a").hasClass("disabled")){return}i.halt();var g=h.one("a").getAttribute("href");GROUPS.ROUTER.navigate(g)},this.handleMoreNavClick=function(h){var g=true;d.all(".yui3-widget.yui3-overlay").each(function(j,i){if(j.one("#morenav-items")!=null){if(j.hasClass("yui3-overlay-hidden")){g=false;h.currentTarget.setAttribute("aria-expanded","false")}}});if(g==false){e.overlay.get("contentBox").one("#morenav-items").focusManager.refresh();this.showOverlay(h)}else{this.hideOverlay(h)}h.preventDefault()},this.showOverlay=function(g){this.moreNavItems.removeClass("hide");this.overlay.show();GROUPS.UTILS.ddMenuSetFocus(g,e.overlay.get("contentBox").one("#morenav-items"));g.currentTarget.setAttribute("aria-expanded","true");this.moreNavItems.setAttribute("aria-hidden","false")},this.hideOverlay=function(g){this.overlay.hide(g);this.overlay.get("contentBox").all("#morenav-items li").removeClass("focus");this.moreNavItems.setAttribute("aria-hidden","true");if(d.one("#morenav")){d.one("#morenav").setAttribute("aria-expanded","false")}},this.showExtraNavItem=function(l){l.currentTarget.removeClass("menu-hl");l.preventDefault();l.stopPropagation();var i=this.node.one("#morenav").get("parentNode"),h=d.one("#morenav-items"),g=(d.one("#yg-group-detail-navbar").one(".docked")!=null),m=d.one("#yg-group-detail-navbar").one(".dockme"),k=l.currentTarget.one("a"),j;if(!k.hasClass("disabled")){this.showMoreItemsFlag=false;this.hideOverlay();i.all(".newitem").addClass("hide");h.all("li").removeClass("hide");l.currentTarget.addClass("hide");if(g){var o=m.one("#morenav").get("parentNode"),n=m.one("#morenav-items");if(o){o.all(".newitem").addClass("hide")}if(n){n.all("li").removeClass("hide")}if(m.one("#"+l.currentTarget.get("id"))){m.one("#"+l.currentTarget.get("id")).addClass("hide")}}j=k.one("span").get("text");GROUPS.INSTR.beaconClick("yg-group-detail-navbar",j,"7",false);GROUPS.ROUTER.navigate(k.get("href"))}},this.handleOutsideClick=function(g){if(g.target.ancestor("#morenav")||g.target.get("id")=="morenav"){return}this.showMoreItemsFlag=false;this.hideOverlay()},this.showProfileList=function(h){if(this.profListOverlay==null){this.profListOverlay=new d.Groups.Overlay({bodyContent:d.one("#yg-profile-list").getContent(),align:{node:".prof-id-list",points:[d.WidgetPositionAlign.TR,d.WidgetPositionAlign.TL]}});if(d.one("#yg-profile-list-bd").one("> li")){this.profListOverlay.render()}d.one("#yg-profile-list-bd").delegate("click",function(i){if(this.settMenuOverlay){this.settMenuOverlay.hide()}if(this.profListOverlay){this.profListOverlay.hide()}if(this.memListOverlay){this.memListOverlay.hide()}window.location.href=window.location.pathname+"?groupUserId="+i.currentTarget.one("div").getAttribute("userid")},"li",this)}else{var g=true;d.all(".yui3-widget.yui3-overlay").each(function(j,i){if(j.one("#yg-profile-list-bd")!=null){if(j.hasClass("yui3-overlay-hidden")){g=false}}});if(d.one("#yg-group-detail-navbar").hasClass("fixed")){this.profListOverlay.set("align",{node:d.one(".prof-id-list"),points:[d.WidgetPositionAlign.TR,d.WidgetPositionAlign.TL]})}if(g==false){if(d.one("#yg-profile-list-bd").one("> li")){this.profListOverlay.show()}}else{this.profListOverlay.hide()}}},this.showSettMenu=function(k){var g,j,i;GROUPS.PAGE.hideTooltip();k.preventDefault();GROUPS.INSTR.beaconClick("yg-group-detail-navbar","settings-nav",11,false);if(this.settMenuOverlay==null){this.settMenuOverlay=new d.Groups.Overlay({bodyContent:d.one("#yg-sett-menu-overlay").getContent(),align:{node:"#settnav",points:[d.WidgetPositionAlign.TR,d.WidgetPositionAlign.BR]}});this.settMenuOverlay.render();g=this.settMenuOverlay.get("contentBox").one("#yg-sett-menu");j=g.one("a.set-pending-menu");GROUPS.UTILS.setDefaultPendingTab(j);g.plug(d.Plugin.NodeFocusManager,{descendants:"li a",keys:{next:"down:40",previous:"down:38"},focusClass:"focus",circular:false});g.delegate("mouseenter",GROUPS.UTILS.updateDropDownMenuFocus,"li a",this,g);g.on("mouseleave",function(l){this.one(".focus")&&this.one(".focus").removeClass("focus")});GROUPS.UTILS.ddMenuSetFocus(k,g);d.on("key",function(){try{this.settMenuOverlay.hide();if(d.one("#settnav")){d.one("#settnav").setAttribute("aria-expanded","false");d.one("#yg-sett-menu").setAttribute("aria-hidden","true");d.one("#settnav").focus()}}catch(l){}},["#settnav",g],"down:27,9",this);k.currentTarget.setAttribute("aria-expanded","true");d.one("#yg-sett-menu").setAttribute("aria-hidden","false");d.one("#yg-sett-menu-overlay").on("clickoutside",function(l){if(l.target.get("id")!="settnav"&&!l.target.ancestor("#settnav")&&l.target.get("id")!="yg-sett-menu-overlay-bd"&&!l.target.ancestor("#yg-sett-menu-overlay-bd")){if(this.settMenuOverlay){this.settMenuOverlay.hide();if(d.one("#settnav")){d.one("#settnav").setAttribute("aria-expanded","false");d.one("#yg-sett-menu").setAttribute("aria-hidden","true")}}}},this);d.one("#yg-sett-menu").delegate("click",function(m){if(this.settMenuOverlay){this.settMenuOverlay.hide()}m.preventDefault();m.stopPropagation();var l="";if(m.currentTarget.get("tagName")=="A"){l=m.currentTarget.getAttribute("href")}else{l=m.currentTarget.one("a").getAttribute("href")}GROUPS.INSTR.beaconClick("yg-group-detail-navbar",m.currentTarget.one("a").getHTML(),12,false);GROUPS.ROUTER.navigate(l)},"li",this)}else{var h=true;d.all(".yui3-widget.yui3-overlay").each(function(m,l){if(m.one("#yg-sett-menu-overlay-bd")!=null){if(m.hasClass("yui3-overlay-hidden")){h=false}}});if(h==false){g=this.settMenuOverlay.get("contentBox").one("#yg-sett-menu");j=g.one("a.set-pending-menu");GROUPS.UTILS.setDefaultPendingTab(j);this.settMenuOverlay.show();GROUPS.UTILS.ddMenuSetFocus(k,this.settMenuOverlay.get("contentBox").one("#yg-sett-menu"));k.currentTarget.setAttribute("aria-expanded","true");d.one("#yg-sett-menu").setAttribute("aria-hidden","false")}else{this.settMenuOverlay.hide();k.currentTarget.setAttribute("aria-expanded","false");d.one("#yg-sett-menu").setAttribute("aria-hidden","true")}}},this.showMemMenu=function(i){var g;GROUPS.PAGE.hideTooltip();i.preventDefault();GROUPS.INSTR.beaconClick("yg-group-detail-navbar","mem-nav",9,false);if(this.memMenuOverlay==null){this.memMenuOverlay=new d.Groups.Overlay({bodyContent:d.one("#yg-mem-menu-overlay").getContent(),align:{node:"#memnav",points:[d.WidgetPositionAlign.TR,d.WidgetPositionAlign.BR]}});this.memMenuOverlay.render();g=this.memMenuOverlay.get("contentBox").one("#yg-mem-menu-overlay-bd");g.plug(d.Plugin.NodeFocusManager,{descendants:".mem-menu-item",keys:{next:"down:40",previous:"down:38"},focusClass:"focus",circular:false});g.delegate("mouseenter",GROUPS.UTILS.updateDropDownMenuFocus,".mem-menu-item",this,g);g.on("mouseleave",function(j){this.one(".focus")&&this.one(".focus").removeClass("focus")});GROUPS.UTILS.ddMenuSetFocus(i,g);i.currentTarget.setAttribute("aria-expanded","true");this.memMenuOverlay.get("boundingBox").setAttribute("aria-hidden","false");d.on("key",function(k){var j=d.one("#memnav");this.memMenuOverlay.hide();j.focus();j.setAttribute("aria-expanded","false");d.one("#yg-mem-menu-overlay-bd").setAttribute("aria-hidden","true")},["#memnav",d.one("#yg-mem-menu-overlay-bd")],"down:27, 9",this);d.one("#yg-mem-menu-overlay").on("clickoutside",function(k){var j=k.target.get("id")!="memnav"&&!k.target.ancestor("#memnav")&&k.target.get("id")!="yg-mem-menu-overlay-bd"&&!k.target.ancestor("#yg-mem-menu-overlay-bd")&&!k.target.ancestor("#yg-profile-list-bd");if(j){if(this.memMenuOverlay){this.memMenuOverlay.hide();if(d.one("#memnav")){d.one("#memnav").setAttribute("aria-expanded","false");d.one("#yg-mem-menu-overlay-bd").setAttribute("aria-hidden","true")}}if(this.profListOverlay){this.profListOverlay.hide()}}},this);if(d.one(".prof-id-list")){d.one(".prof-id-list").on("hover",this.showProfileList,function(j){if(!j.currentTarget.ancestor("#yg-profile-list-bd")&&!j.currentTarget.ancestor(".yg-proflist-cont")){if(this.profListOverlay){this.profListOverlay.hide()}}},this)}d.one("#yg-member-menu").delegate("click",function(k){if(this.memMenuOverlay){this.memMenuOverlay.hide()}if(this.profListOverlay){this.profListOverlay.hide()}k.preventDefault();k.stopPropagation();var j="";if(k.currentTarget.get("tagName")=="A"){j=k.currentTarget.getAttribute("href")}else{j=k.currentTarget.one("a").getAttribute("href")}GROUPS.INSTR.beaconClick("yg-group-detail-navbar",k.currentTarget.one("a").getHTML(),10,false);GROUPS.ROUTER.navigate(j)},"li",this)}else{var h=true;d.all(".yui3-widget.yui3-overlay").each(function(l,j){if(l.one("#yg-mem-menu-overlay-bd")!=null){if(l.hasClass("yui3-overlay-hidden")){h=false}}});if(d.one("#yg-group-detail-navbar").hasClass("fixed")){this.memMenuOverlay.set("align",{node:"#memnav",points:[d.WidgetPositionAlign.TR,d.WidgetPositionAlign.BR]})}if(h==false){this.memMenuOverlay.show();GROUPS.UTILS.ddMenuSetFocus(i,d.one("#yg-mem-menu-overlay-bd"));i.currentTarget.setAttribute("aria-expanded","true");d.one("#yg-mem-menu-overlay-bd").setAttribute("aria-hidden","false")}else{this.memMenuOverlay.hide();i.currentTarget.setAttribute("aria-expanded","false");d.one("#yg-mem-menu-overlay-bd").setAttribute("aria-hidden","true")}}};this.init(f)};d.namespace("Groups").navbar=b},"0.1",{requires:["json","handlebars","yg-overlay","event","event-hover","node-focusmanager"]});YUI.add("yg-group-detail",function(c){var b=c.Base.create("GroupDetailApp",c.App,[],{views:{topicRead:{parentType:"conversations"},postRead:{parentType:"conversations"},messagesList:{preserve:false,parentType:"conversations"},newTopicView:{preserve:false,parentType:"conversations"},messageRead:{parentType:"conversations"},photostream:{preserve:false,parentType:"photos"},albumList:{preserve:false,parentType:"photos"},photomaticList:{preserve:false,parentType:"photos"},albumDetail:{preserve:false,parentType:"photos"},palbumDetail:{preserve:false,parentType:"photos"},photosReorder:{preserve:false,parentType:"photos"},pollsOpen:{preserve:false,parentType:"polls"},pollsClosed:{preserve:false,parentType:"polls"},pollsMyPolls:{preserve:false,parentType:"polls"},pollDetail:{preserve:false,parentType:"polls"},createPoll:{preserve:false,parentType:"polls"},pendingMembers:{preserve:false,parentType:"management"},pendingMessages:{preserve:false,parentType:"management"},pendingPhotos:{preserve:false,parentType:"management"},settings:{preserve:false,parentType:"management"},membership:{preserve:false,parentType:"management"},activitylog:{preserve:false,parentType:"management"},allPhotos:{preserve:false,parentType:"photos"},groupinfo:{preserve:false,parentType:null},welcomeMsg:{preserve:false,parentType:null},events:{},members:{},allFiles:{preserve:false,parentType:"files"},allAttachments:{preserve:false,parentType:"files"},database:{preserve:false,parentType:null},tableEdit:{preserve:false,parentType:null},linksAll:{preserve:false,parentType:"links"},linksMy:{preserve:false,parentType:"links"},inviteMembers:{preserve:false,parentType:"invitations"},removeMembers:{preserve:false,parentType:"members"},banMembers:{preserve:false,parentType:"members"},pinboard:{preserve:false,parentType:null}},getRouterConfig:function(){this.routerConfig={conversations__messages:{method:this.showMessagesListView,cache:{displaySaved:true},viewConfig:{viewType:"messagesList",viewModule:"yg-messagelist"}},conversations__topics:{method:this.instantiateViewObject,viewConfig:{viewType:"messagesList",viewModule:"yg-messagelist"}},conversations__trending:{method:this.instantiateViewObject,viewConfig:{viewType:"messagesList",viewModule:"yg-messagelist"}},conversations__spam:{method:this.instantiateViewObject,cache:{displaySaved:true},viewConfig:{viewType:"messagesList",viewModule:"yg-messagelist"}},pinboard__all:{method:this.instantiateViewObject,viewConfig:{viewType:"pinboard",viewModule:"yg-pinboard"}},pinboard__my:{method:this.instantiateViewObject,viewConfig:{viewType:"pinboard",viewModule:"yg-pinboard"}},pinboard__public:{method:this.instantiateViewObject,viewConfig:{viewType:"pinboard",viewModule:"yg-pinboard"}},conversations__newtopic:{method:this.instantiateViewObject,viewConfig:{viewType:"newTopicView",viewModule:"yg-newtopic"}},pinboard__posts__itemId__edit:{method:this.instantiateViewObject,viewConfig:{viewType:"newTopicView",viewModule:"yg-newtopic",editMode:true,postId:this.get("itemId")}},conversations__topics__itemId:{method:this.instantiateViewObject,cache:{save:true,tbSavedViewName:"messageListView"},viewConfig:{viewType:"topicRead",msgId:this.get("itemId"),viewModule:"yg-topic-read",subtype:"topic"}},conversations__messages__itemId:{method:this.instantiateViewObject,cache:{save:true,tbSavedViewName:"messageListView"},viewConfig:{viewType:"messageRead",msgId:this.get("itemId"),viewModule:"yg-msg-read"}},conversations__messages__itemId__convert:{method:this.instantiateViewObject,viewConfig:{viewType:"newTopicView",viewModule:"yg-newtopic",editMode:true,messageId:this.get("itemId")}},conversations__spam__itemId:{method:this.instantiateViewObject,cache:{save:true,tbSavedViewName:"messageListView"},viewConfig:{viewType:"messageRead",msgId:this.get("itemId"),viewModule:"yg-msg-read"}},pinboard__posts__itemId:{method:this.instantiateViewObject,viewConfig:{viewType:"postRead",postId:this.get("itemId"),viewModule:"yg-post-read",subtype:"post"}},photos__photostream:{method:this.showPhotosView,viewConfig:{viewType:"photostream",viewModule:"yg-photos",tab:"list"}},photos__photostream__itemId__timeline:{method:this.showPhotosView,viewConfig:{viewType:"photostream",tab:this.get("subtypeItemId"),zaxId:this.get("zaxId"),viewModule:"yg-photos"}},photos__photostream__itemId__map:{method:this.showPhotosView,viewConfig:{viewType:"photostream",tab:this.get("subtypeItemId"),zaxId:this.get("zaxId"),viewModule:"yg-photos"}},photos__albums:{method:this.showPhotosView,viewConfig:{viewType:"albumList",viewModule:"yg-photos"}},photos__photomatic:{method:this.showPhotosView,viewConfig:{viewType:"photomaticList",viewModule:"yg-photos"}},photos__albums__itemId__timeline:{method:this.showPhotosView,viewConfig:{viewType:"albumDetail",albumId:this.get("itemId"),zaxId:this.get("zaxId"),tab:this.get("subtypeItemId"),viewModule:"yg-photos"}},photos__photomatic__itemId__timeline:{method:this.showPhotosView,viewConfig:{viewType:"palbumDetail",albumId:this.get("itemId"),zaxId:this.get("zaxId"),tab:this.get("subtypeItemId"),viewModule:"yg-photos"}},photos__albums__itemId__map:{method:this.showPhotosView,viewConfig:{viewType:"albumDetail",albumId:this.get("itemId"),zaxId:this.get("zaxId"),tab:this.get("subtypeItemId"),viewModule:"yg-photos"}},photos__photomatic__itemId__map:{method:this.showPhotosView,viewConfig:{viewType:"palbumDetail",albumId:this.get("itemId"),zaxId:this.get("zaxId"),tab:this.get("subtypeItemId"),viewModule:"yg-photos"}},photos__albums__itemId:{method:this.showPhotosView,viewConfig:{viewType:"albumDetail",albumId:this.get("itemId"),viewModule:"yg-photos",tab:"list"}},photos__photomatic__itemId:{method:this.showPhotosView,viewConfig:{viewType:"palbumDetail",albumId:this.get("itemId"),viewModule:"yg-photos",tab:"list"}},photos__albums__itemId__subtypeItemId:{method:this.showPhotosView,viewConfig:{viewType:"albumDetail",albumId:this.get("itemId"),tab:"list",viewModule:"yg-photos"}},photos__photomatic__itemId__subtypeItemId:{method:this.showPhotosView,viewConfig:{viewType:"palbumDetail",albumId:this.get("itemId"),tab:"list",viewModule:"yg-photos"}},photos__albums__itemId__reorder:{method:this.showPhotosView,viewConfig:{viewType:"photosReorder",albumId:this.get("itemId"),viewModule:"yg-photos-reorder"}},polls__open:{method:this.showPollsView,viewConfig:{viewType:"pollsOpen",viewModule:"yg-polls"}},polls__close:{method:this.showPollsView,viewConfig:{viewType:"pollsClosed",viewModule:"yg-polls"}},polls__mypolls:{method:this.showPollsView,viewConfig:{viewType:"pollsMyPolls",viewModule:"yg-polls"}},polls__poll__itemId:{method:this.showPollsView,viewConfig:{viewType:"pollDetail",pollId:this.get("itemId"),viewModule:"yg-poll-detail"}},polls__create:{method:this.showPollsView,viewConfig:{viewType:"createPoll",viewModule:"yg-create-poll"}},management__settings:{method:this.showSettingsView,viewConfig:{viewType:"settings",viewModule:"yg-settings"}},management__pendingmembers:{method:this.instantiateViewObject,viewConfig:{viewType:"pendingMembers",viewModule:"yg-pmembers"}},management__pendingmessages:{method:this.instantiateViewObject,viewConfig:{viewType:"pendingMessages",viewModule:"yg-pmessages"}},management__pendingposts:{method:this.instantiateViewObject,viewConfig:{viewType:"pendingMessages",viewModule:"yg-pmessages"}},management__pendingphotos:{method:this.instantiateViewObject,viewConfig:{viewType:"pendingPhotos",viewModule:"yg-pphotos"}},management__membership:{method:this.instantiateViewObject,viewConfig:{viewType:"membership",viewModule:"yg-membership"}},management__activitymail:{method:this.instantiateViewObject,viewConfig:{viewType:"activitylog",viewModule:"yg-activitylog"}},management__activityweb:{method:this.instantiateViewObject,viewConfig:{viewType:"activitylog",viewModule:"yg-activitylog"}},management__actmembership:{method:this.instantiateViewObject,viewConfig:{viewType:"activitylog",viewModule:"yg-activitylog"}},management__modactivity:{method:this.instantiateViewObject,viewConfig:{viewType:"activitylog",viewModule:"yg-activitylog"}},management__emailcmds:{method:this.instantiateViewObject,viewConfig:{viewType:"activitylog",viewModule:"yg-activitylog"}},info:{method:this.instantiateCustomViewObject,viewConfig:{viewType:"groupinfo",viewModule:"yg-group"}},welcomemember:{method:this.instantiateCustomViewObject,viewConfig:{viewType:"welcomeMsg",viewModule:"yg-welcomemsg"}},welcomeowner:{method:this.instantiateCustomViewObject,viewConfig:{viewType:"welcomeMsg",viewModule:"yg-welcomemsg"}},events:{method:this.instantiateCustomViewObject,viewConfig:{viewType:"events",viewModule:"yg-group-events"}},members__all:{method:this.instantiateViewObject,viewConfig:{viewType:"members",viewModule:"yg-group-members"}},members__moderators:{method:this.instantiateViewObject,viewConfig:{viewType:"members",viewModule:"yg-group-members"}},members__bouncing:{method:this.instantiateViewObject,viewConfig:{viewType:"members",viewModule:"yg-group-members"}},members__banned:{method:this.instantiateViewObject,viewConfig:{viewType:"members",viewModule:"yg-group-members"}},members__suspended:{method:this.instantiateViewObject,viewConfig:{viewType:"members",viewModule:"yg-group-members"}},attachments:{method:this.showFilesListView,viewConfig:{viewType:"allAttachments",viewModule:"yg-files"}},attachments__itemId:{method:this.showFilesListView,viewConfig:{viewType:"allAttachments",viewModule:"yg-files"}},files:{method:this.showFilesListView,viewConfig:{viewType:"allFiles",viewModule:"yg-files"}},files__itemId:{method:this.showFilesListView,viewConfig:{viewType:"allFiles",viewModule:"yg-files"}},database:{method:this.instantiateViewObject,viewConfig:{viewType:"database",viewModule:"yg-database"}},database__my:{method:this.instantiateViewObject,viewConfig:{viewType:"database",viewModule:"yg-database"}},database__edit__itemId:{method:this.instantiateViewObject,viewConfig:{viewType:"tableEdit",tableId:this.get("itemId"),viewModule:"yg-table-edit"}},links__all:{method:this.showLinksView,viewConfig:{viewType:"linksAll",viewModule:"yg-links"}},links__my:{method:this.showLinksView,viewConfig:{viewType:"linksMy",viewModule:"yg-links"}},links__all__itemId:{method:this.showLinksView,viewConfig:{viewType:"linksAll",linkPath:this.get("itemId"),viewModule:"yg-links"}},links__my__itemId:{method:this.showLinksView,viewConfig:{viewType:"linksMy",linkPath:this.get("itemId"),viewModule:"yg-links"}},invitations__members:{method:this.instantiateViewObject,viewConfig:{viewType:"inviteMembers",viewModule:"yg-bulk-member-opr"}},invitations__mailinglist:{method:this.instantiateViewObject,viewConfig:{viewType:"inviteMembers",viewModule:"yg-bulk-member-opr"}},members__remove:{method:this.instantiateViewObject,viewConfig:{viewType:"removeMembers",viewModule:"yg-bulk-member-opr"}},members__ban:{method:this.instantiateViewObject,viewConfig:{viewType:"banMembers",viewModule:"yg-bulk-member-opr"}}}},getKey:function(){var d=this.get("type");if(this.get("subtype")){d+="__"+this.get("subtype")}if(this.get("itemId")){d+="__itemId"}if(this.get("subtypeItemId")){if(isNaN(this.get("subtypeItemId"))){d+="__"+this.get("subtypeItemId")}else{d+="__subtypeItemId"}}return d},initializer:function(){var f=this,e,d,g,h="CLEAR_APP_CACHE";this.node=this.get("container");this.appContainer=this.get("appContainer");this.selectedItemNav=null;this.pageLoader=c.one(".page-loader");GROUPS.PAGE.updateNavbarPos();c.log("Initializing GroupDetail App");GROUPS.UTILS.checkAdultGroup(this);this._cachedType=null;this._cachedSubtype=null;this._cachedListviewHtml=null;this._cachedScrollY=0;GROUPS.Y.Global.on(h,this.onCacheReset,this);this._msgReadHtml=null;this.getRouterConfig();g=this.getKey();if(this.routerConfig[g]){this.routerConfig[g]["method"].call(this,null,null,true,g)}this.initHandlers();if(!GROUPS.PAGE._isMobile){GROUPS.NAVBAR=new c.Groups.navbar(this.get("groupName"))}},onCacheReset:function(d){this._cachedListviewHtml=null},showViewContent:function(g){var e=this.routerConfig[g],d=this,h={name:e.viewConfig["viewType"],config:{groupName:this.get("groupName"),subtype:this.get("subtype")}};if(e.viewConfig){for(var f in e.viewConfig){h.config[f]=e.viewConfig[f]}}this.render().showContent(this.get("container").one(".group-detail-view"),{view:h},function(i){d.dockNavBar(e.viewConfig["viewType"]);i.initView();d.msgReadCustomEvtHandler(i,g);GROUPS.PAGE._dockNodeList=c.all(".dockme")})},dockNavBar:function(d){GROUPS.UTILS.setMainRole();if(GROUPS.MOBILE_PV){c.one("body")._node.scrollTop=0;return}var e,g=c.one("#navbar-container"),f;if("groupinfo"===d&&!this.node.one("#welcomeMessage")){window.scrollTo(0,0);return}if(!g.hasClass("docked")){if(GROUPS.PAGE._isMobile){e=c.one("#yucs-logo");GROUPS.PAGE.dockPos=parseInt(c.one(".group-img-container").get("offsetHeight")-parseInt(e.get("offsetHeight"))+13)}else{if(GROUPS.PAGE._isTablet){e=c.one("#yucs-logo");GROUPS.PAGE.dockPos=(parseInt(g.getY())-parseInt(e.get("offsetHeight")))}else{e=c.one("."+g.getAttribute("data-docktarget"));GROUPS.PAGE.dockPos=(parseInt(g.getY())-parseInt(e.get("offsetHeight")))}}}f=c.one("#pend-not-contnr");c.one("#yg-msg-view")&&c.one("#yg-msg-view").focus();if(GROUPS.PAGE.dockPos&&f&&!f.hasClass("hide")){window.scrollTo(0,GROUPS.PAGE.dockPos-f.get("offsetHeight"))}else{window.scrollTo(0,GROUPS.PAGE.dockPos)}},initHandlers:function(){var e=this;e.node.setAttribute("tabindex","-1");this.after("destroyedChange",function(f){if(e.get("destroyed")){if(e.get("activeView")){e.get("activeView").destroy()}e.listViewHtml=""}});this.after("activeViewChange",function(f){e.pageLoader.addClass("hide");if(f.prevVal!=null&&!this.get("zaxId")){GROUPS.UTILS.lightHouseMark("view_end_marker",true,f.newVal.name);if(GROUPS.INSTR){GROUPS.INSTR.rapidDestroy();GROUPS.INSTR_CONFIG=GROUPS.INSTR.updateRapidParams(GROUPS.INSTR_CONFIG);GROUPS.INSTR=new c.Groups.Instrumentation(GROUPS.INSTR_CONFIG)}if(GROUPS.ACTIONBAR){GROUPS.ACTIONBAR.reset()}}GROUPS.PAGE.resizeActionNavBar(f);GROUPS.UTILS.changeHelpUrl()});this.after("typeChange",function(j){var f=e.views,g=j.newVal;for(var h in f){if(f[h].instance&&f[h].parentType!=g){f[h].instance.destroy()}}});var d=c.one("#unbounce-me");if(d){d.on("click",function(f){e.unbounceMe(false)},this);c.one("#user-unbounce-history").on("click",this.showUserBounceHistory,this)}if(c.one(".gstats i")){c.one(".gstats i").on("dblclick",function(f){c.one("#yg-debug-container").removeClass("hide");c.one("#yg-debug-container").setHTML(c.Escape.html(GROUPS.YG_SESSION_ID));c.later(10000,c,function(){c.one("#yg-debug-container").addClass("hide")})})}},showUserBounceHistory:function(g){var f=GROUPS.UTILS.getTemplate("user_bounce_history_template"),d=this;GROUPS.DETAIL_IO.makeRequest("/api/v1/user/"+c.one("#yg-user-id").get("value")+"?bounceDetails=true","GET",{},function(m,l){if(l){GROUPS.UTILS.handleYGAPIErrorMessage("user_bouncing_history","1001")}else{var k=c.Handlebars.compile(f),i=c.JSON.parse(m),n="";if(i.ygData){i.ygData["bouncingEmail"]=g.currentTarget.get("parentNode").one("#user-bouncing-email").getContent();n=GROUPS.UTILS.getFormattedTimestamp(parseInt(i.ygData["bouncingStatusAsOfDateInEpoch"],10),"%b %d, %Y");i.ygData["bounceStatus"]=GROUPS.YRB_STRINGS.STR_BOUNCE_STATUS_MSG.replace("{0}",GROUPS.YRB_STRINGS["STR_"+i.ygData["bouncingStatus"]]).replace("{1}",n);i.ygData["lastResetRequestSentDateInEpoch"]=i.ygData["lastResetRequestSentDateInEpoch"]!=0?GROUPS.UTILS.getFormattedTimestamp(i.ygData["lastResetRequestSentDateInEpoch"],"%d %b, %Y %l:%M %p"):0;var j=k(i),e=c.Node.create(j),h=new Date().getTime();if(d.userBouncingPanel==null){d.userBouncingPanel=new c.Groups.Panel({srcNode:e.one("#user-bounce-history-panel"),moveNode:e.one("#user-bounce-history-panel").ancestor(".yui3-skin-sam"),view:d});e.one("#cancel").on("click",function(){d.userBouncingPanel.hide()});e.one("#send-unbounce-request").on("click",function(o){d.unbounceMe(true)},d)}d.userBouncingPanel.show()}else{GROUPS.UTILS.handleYGAPIErrorMessage("user_bouncing_history","1001")}}})},unbounceMe:function(e){var f={},d=this;f.unbounce="true";GROUPS.DETAIL_IO.makeRequest("/api/v1/user/"+c.one("#yg-user-id").get("value"),"POST",f,function(h,g){if(g){GROUPS.UTILS.handleYGAPIErrorMessage("user_unbounce_email","1001");if(e){d.userBouncingPanel.hide()}}else{GROUPS.UTILS.handleTransition(c.one("#yg-email-bouncing-container"),function(){c.one("#yg-email-bouncing-container").addClass("hide")});if(e){d.userBouncingPanel.hide()}}})},route:function(f,e){var d;this._set("type",f.params.type);this._set("subtype",f.params.subtype);this._set("itemId",f.params.itemId);this._set("subtypeItemId",f.params.subtypeItemId);this._set("zaxId",f.params.zaxId);this.getRouterConfig();d=this.getKey();if(this.routerConfig[d]){this.routerConfig[d]["method"].call(this,f,e,false,d)}},showMessagesListView:function(g,f,d,e){if(d){this.instantiateViewObject(g,f,d,e)}else{this.instantiateViewObject(g,f,d,e,{url:g.path+"?noImage=true&noNavbar=true"})}},showPollsView:function(i,h,d,g){if(d){this.instantiateViewObject(i,h,d,g)}else{var f=(i.query.pollType)?"&pollType="+i.query.pollType:"",e=(i.query.sortOrder)?"&sortOrder="+i.query.sortOrder:"",j=(i.query.orderBy)?"&orderBy="+i.query.orderBy:"";this.instantiateViewObject(i,h,d,g,{url:i.path+"?noImage=true&noNavbar=true"+f+e+j})}},showLinksView:function(g,f,d,e){if(d){this.instantiateViewObject(g,f,d,e)}else{this.instantiateViewObject(g,f,d,e,{url:g.path+"?noImage=true&noNavbar=true"})}},showPhotosView:function(g,f,d,e){if(d||!(/^\d+$/g.test(this.get("subtypeItemId")))){this.instantiateViewObject(g,f,d,e)}},instantiateCustomViewObject:function(j,h,d,g){var e=this,i="";c.use("cache-offline",function(n){var m=new n.CacheOffline();if(m.retrieve(e.get("groupName")+"-iref")&&m.retrieve(e.get("groupName")+"-iref").response){var o=m.retrieve(e.get("groupName")+"-iref").response,l=m.retrieve(e.get("groupName")+"-email").response;i="iref="+o+"&email="+l;if(m.retrieve(e.get("groupName")+"-mem_type")&&m.retrieve(e.get("groupName")+"-mem_type").response){i=i+"&mem_type=email"}}});if(d){GROUPS.PAGE.isDNTShown=false;if(i!=""){j=j+"?"+i}this.instantiateViewObject(j,h,d,g)}else{j.path=j.path+"?noImage=true&noNavbar=true&noActionbar=true";if(i!=""){j.path=j.path+"&"+i}var f=c.one("#yg-grp-main-img"),k=f&&f.hasAttribute("hasCoverImage")?f.getAttribute("hasCoverImage"):"";if(k!=""){j.path=j.path+"&hasCoverImage=false"}this.instantiateViewObject(j,h,d,g,{url:j.path})}},showFilesListView:function(g,f,d,e){if(d){this.instantiateViewObject(g,f,d,e)}else{this.instantiateViewObject(g,f,d,e,{url:g.path+"?noImage=true&noNavbar=true"})}},msgReadCustomEvtHandler:function(d,f){var e=this;if(f==="conversations__messages"){d.on("view-detail-fetched",function(g){e._msgReadHtml=g.res;if(typeof g.callback==="function"){g.callback()}})}},showSettingsView:function(g,f,d,e){if(d){this.instantiateViewObject(g,f,d,e)}else{this.instantiateViewObject(g,f,d,e,{url:g.path})}},instantiateViewObject:function(j,i,f,l,e){var m=this,h=this.get("subtype"),d=this.routerConfig[l],g=d.viewConfig.viewType,k=d.viewConfig.viewModule;if(c.one("#yg-grp-main-img").getData("usearch-enabled")=="1"){GROUPS.ROUTER.setLocalSearchHandler(m.get("groupName"),m.get("type"),m.get("subtype"),undefined,true)}GROUPS.PAGE.hideTooltip();GROUPS.Y.use(k,function(s){if(!m.views[g].type){m.views[g].type=GROUPS.VIEWS[k]}if(f){GROUPS.PAGE.isDNTShown=false;m.showViewContent(l)}else{GROUPS.DETAIL_IO.abortRequest();var o={groupName:m.get("groupName")},n={render:true,callback:function(t){m.dockNavBar(g);t.initView();m.msgReadCustomEvtHandler(t,l);GROUPS.PAGE._dockNodeList=s.all(".dockme")}},q=function(){m._cachedSubtype=m.get("subtype");m._cachedType=m.get("type");m._cachedListviewHtml='<div id="yg-msg-view"><div class="group-detail-view">'+m.node.one(".group-detail-view").getHTML();m._cachedListviewHtml+="</div></div>";m._cachedScrollY=s.DOM.docScrollY()},r=function(){var t=(e&&e.url)?e.url:j.path+"?noImage=true&noNavbar=true";if(j.query){for(var u in j.query){t+="&"+u+"="+j.query[u]}}GROUPS.DETAIL_IO.makeRequest(t,"GET",{},function(v,w){if(v){if(d.cache&&d.cache.save){if(m.get("activeView").name==d.cache.tbSavedViewName){q()}}o.html=v;m.render().showView(g,o,n)}})};if(h){o.subtype=h}for(var p in d.viewConfig){o[p]=d.viewConfig[p]}if(d.cache&&d.cache.displaySaved){if(m._cachedType==m.get("type")&&(h&&m._cachedSubtype===h)&&m._cachedListviewHtml!==null){o.html=m._cachedListviewHtml;o.scrollY=m._cachedScrollY;m._cachedListviewHtml=null;m._cachedType=null;m._cachedSubtype=null;m._cachedScrollY=0;m.render().showView(g,o,n)}else{r()}}else{if(m._msgReadHtml){o.html=m._msgReadHtml;q();m.render().showView(g,o,n);m._msgReadHtml=null}else{r()}}}})}},{ATTRS:{groupName:{value:""},type:{value:""},subtype:{value:""},itemId:{value:null},subtypeItemId:{value:null}}});var a=c.Base.create("GroupDetailView",c.View,[],{events:{".add-support-note":{click:"handleAddSupportNoteOrComplaint"},".add-spam-complaint":{click:"handleAddSupportNoteOrComplaint"},".header-add-icon":{click:"showOrHideAddSupportNote"}},initializer:function(){var d=this;this.node=this.get("container");this.after("destroyedChange",function(f){if((d.get("destroyed"))){if(d.coverImage){d.coverImage.destroy()}if(GROUPS.NAVBAR&&GROUPS.NAVBAR.overlay){GROUPS.NAVBAR.overlay.destroy()}d.app.destroy()}})},selectNavBar:function(){if(c.one("#yg-group-detail-navbar")){var h=c.one(".yg-page #yg-group-detail-navbar")||c.one("#yg-group-detail-navbar");this.originalNavbar=h.one(".dockme");this.dockedNavbar=h.one(".docked")}if(this.selectedItemNav){if(this.originalNavbar){var g=this.originalNavbar.one("#"+this.selectedItemNav.get("id"));if(g){g.removeClass("nav-selected")}}if(this.dockedNavbar){this.dockedNavbar.one("#"+this.selectedItemNav.get("id")).removeClass("nav-selected")}}var f=c.one("#morenav-items"),i=null;switch(this.get("type")){case"conversations":this.selectedItemNav=c.one("#messagenav");if(this.get("subtype")=="spam"){this.selectedItemNav=c.one("#spamnav");i="#spamnav-more"}break;case"photos":this.selectedItemNav=c.one("#photosnav");break;case"polls":this.selectedItemNav=c.one("#pollsnav");break;case"members":case"invitations":this.selectedItemNav=c.one("#settnav");break;case"management":if(this.get("subtype")=="membership"){this.selectedItemNav=c.one("#memnav")}else{if(GROUPS.PAGE._isMobile){this.selectedItemNav=c.one("#panav")}else{this.selectedItemNav=c.one("#settnav")}}break;case"info":this.selectedItemNav=c.one("#infonav");i="#infonav-more";break;case"events":this.selectedItemNav=c.one("#eventsnav");break;case"files":this.selectedItemNav=c.one("#filesnav");break;case"attachments":this.selectedItemNav=c.one("#attachmentnav");i="#attachmentnav-more";break;case"links":this.selectedItemNav=c.one("#linksnav");i="#linksnav-more";break;case"database":this.selectedItemNav=c.one("#databasenav");i="#databasenav-more";break;case"pinboard":this.selectedItemNav=c.one("#pinboardnav");i="#pinboardnav-more";break}if(i){var e=c.one("#morenav").getAttribute("data-id");e=c.one("#"+e);if(this.originalNavbar){this.originalNavbar.all(".newitem").addClass("hide")}if(this.dockedNavbar){this.dockedNavbar.all(".newitem").addClass("hide")}if(e){e.all("li").removeClass("hide");e.one(i)&&e.one(i).addClass("hide")}}if(this.selectedItemNav){if(this.originalNavbar){var g=this.originalNavbar.one("#"+this.selectedItemNav.get("id"));if(g){g.addClass("nav-selected");if(g.hasClass("hide")){g.removeClass("hide")}}}if(this.dockedNavbar){var d=this.dockedNavbar.one("#"+this.selectedItemNav.get("id"));d.addClass("nav-selected");if(d&&d.hasClass("hide")){d.removeClass("hide")}}}},showOrHideAddSupportNote:function(j){var d=this,i=j.currentTarget,h=i.getData("type"),g=(h=="support-note")?".add-support-header":".add-spam-header",k=d.node.one(g),f=i.one("i.yg-sprite");if(k.hasClass("hide")){k.removeClass("hide");f.removeClass("yg-add").addClass("yg-minus")}else{k.addClass("hide");f.removeClass("yg-minus").addClass("yg-add")}},handleAddSupportNoteOrComplaint:function(j){var d=this,i=j.currentTarget,g=i.hasClass("add-support-note")?"supportNotes":"spamComplaint",h=(g=="supportNotes")?"textarea[name='add-support-textarea']":"textarea[name='add-spam-textarea']",f=c.Lang.trim(d.node.one(h).get("value"));if(f==""){return}if(g=="supportNotes"){postFields="note="+f}else{postFields="complaint="+f}GROUPS.DETAIL_IO.makeRequest("/api/v1/groups/"+d.get("groupName")+"/"+g,"POST",postFields,function(e,k){if(k){var m="Error: "+k.ygError.errorCode+": "+k.ygError.errorMessage,l=c.Node.create('<div class="col-12 yg-notification">'+m+"</div>");d.node.one(".yg-snotes-table").insert(l,"before")}else{GROUPS.ROUTER.navigate(window.location.pathname)}})},route:function(f,e){this.originalNavbar=c.one("#yg-group-detail-navbar").one(".dockme");this.dockedNavbar=c.one("#yg-group-detail-navbar").one(".docked");if(this.selectedItemNav){if(this.originalNavbar){var d=this.originalNavbar.one("#"+this.selectedItemNav.get("id"));if(d){d.removeClass("nav-selected")}}if(this.dockedNavbar){this.dockedNavbar.one("#"+this.selectedItemNav.get("id")).removeClass("nav-selected")}}this._set("type",f.params.type);this._set("subtype",f.params.subtype);this._set("itemId",f.params.itemId);this._set("subtypeItemId",f.params.subtypeItemId);this._set("zaxId",f.params.zaxId);this.selectNavBar();this.app.route(f,e)},render:function(){if(this.get("html")!==""){var d=this.get("container");d.addClass("main-container-child");d.setHTML(this.get("html"))}return this},_initZaxView:function(e,d){if(typeof(this.app.get("activeView")._initZaxView)=="function"){this.app.get("activeView")._initZaxView(e,d)}else{d()}},initView:function(){var d=this,f=this.get("groupName");GROUPS.UTILS.loadCoverPhoto();if(this.node.one(".subnav-refresh .change-photo")){if(c.UA.ie&&c.UA.ie==8){c.log("Cover image edit is disabled")}else{if(!GROUPS.PAGE._isMobile){GROUPS.Y.use("yg-edit-cover-photo",function(){d.coverImage=new c.Groups.EditCoverView({container:c.one(".subnav-refresh"),parallax:c.parallax,groupName:f})})}}}this.selectNavBar();this.app=new b({groupName:this.get("groupName"),type:this.get("type"),subtype:this.get("subtype"),itemId:this.get("itemId"),subtypeItemId:this.get("subtypeItemId"),zaxId:this.get("zaxId"),container:this.get("container").one("#yg-msg-view"),appContainer:this.get("container")});if(c.one("#pend-not-contnr")){GROUPS.UTILS.showPendingNotficationBar(this.get("groupName"))}var e=c.one("#yg-group-summary")?c.one("#yg-group-summary").get("text"):this.get("groupName");GROUPS.PAGE.setPageTitle(e);if(GROUPS.MOBILE_PV){GROUPS.UTILS.animateHorizontally(d.node.one("#navbar-container"),100,220)}}},{ATTRS:{groupName:{value:""},type:{value:""},subtype:{value:""},html:{value:""},itemId:{value:null},subtypeItemId:{value:null},zaxId:{value:null},serverRouting:{value:true}}});c.namespace("Groups").GroupDetailView=a;GROUPS.VIEWS["yg-group-detail"]=c.Groups.GroupDetailView},"0.1",{requires:["app","yg-instrumentation"]});YUI.add("yg-router",function(a){a.namespace("Groups").Router=a.Base.create("GroupsRouter",a.App,[],{views:{latestUpdates:{},sohomepage:{},groupDetail:{},messageRead:{},allMyGroupsView:{},manageMyGroupsView:{},myPreferencesView:{},memwizView:{},globalSRPView:{},localSRPView:{},emailUnsubsView:{},adminView:{}},initializer:function(){var b=this;this.pageLoader=a.one(".page-loader");a.log("Initializing Groups App");this.render().dispatch();this.after("activeViewChange",function(c){GROUPS.UTILS.setMainRole();var d=true;if(GROUPS.PAGE){GROUPS.PAGE.resizeActionNavBar(c);GROUPS.PAGE._dockNodeList=a.all(".dockme")}if(GROUPS.BROWSER_UNSUPPORTED=="1"){GROUPS.UTILS.showIEWarningDialog()}b.pageLoader.addClass("hide");if(c.prevVal!=null){if(c.newVal.name=="latestUpdates"){if(a.one(".updates-list")&&a.one(".updates-list").get("children").size()<=1){d=false}}if(GROUPS.INSTR&&d){GROUPS.UTILS.lightHouseMark("view_end_marker",true,c.newVal.name);GROUPS.INSTR.rapidDestroy();GROUPS.INSTR_CONFIG=GROUPS.INSTR.updateRapidParams(GROUPS.INSTR_CONFIG);GROUPS.INSTR=new a.Groups.Instrumentation(GROUPS.INSTR_CONFIG);GROUPS.UTILS.changeHelpUrl()}}});this.on("navigate",function(){GROUPS.UTILS.lightHouseMark("view_start_marker");GROUPS.PAGE.hideTooltip();this.set("prevUrl",window.location.href)});this.leftNav=a.one("#yg-left-col");GROUPS.LEFTNAV=new a.Groups.leftNav();this.issueAPICall=true;GROUPS.ACTIONBAR=new a.Groups.ACTIONBAR()},handleHashtag:function(b){var c=window.location.href;if(c.indexOf("#")!=-1){window.location.href=b}},commonHandler:function(d,b,c){if(/\/\/+/.test(d.path)){d.path=d.path.replace(/\/\/+/g,"/");window.location.pathname=d.path}a.Node.all(".yui3-widget.yui3-overlay").each(function(f,e){f.addClass("yui3-overlay-hidden")});if(/neo;_ylc=*/.test(d.path)){d.path=GROUPS.UTILS.stripUltParams(d.path);this.homePageViewHandler(d,b)}if(!this.get("initialLoad")){GROUPS.IO.abortRequest();GROUPS.DETAIL_IO.abortRequest()}if(GROUPS.PAGE){GROUPS.PAGE.setPageTitle()}if(((new RegExp("/richview/map")).test(this.get("prevUrl")))&&(!(new RegExp("/lightbox/")).test(d.path))&&(!GROUPS.PAGE._isDeskTop)){window.location.reload()}c()},createGroupHandler:function(d,c){var b=this;if(GROUPS.PAGE&&GROUPS.PAGE._isTablet&&GROUPS.YG_SIGNED_IN){GROUPS.PAGE.showCreateGroup()}b.pageLoader.addClass("hide")},homePageViewHandler:function(f,e){var c=this,b,d;if(window.location.hash=="#Tour"&&!GROUPS.PAGE._isMobile){new a.Groups.Tour()}if(GROUPS.YG_SIGNED_IN!=""&&GROUPS.YG_NO_SUBSCRIPTION==""){b="latestUpdates"}else{b="sohomepage"}c.setGlobalSearchHandler();if(b==="latestUpdates"){if(!c.views.latestUpdates.type){GROUPS.Y.use("latest-updates",function(g){c.views.latestUpdates.type=GROUPS.VIEWS["latest-updates"];c._initHomePageView(f,b)})}else{c._initHomePageView(f,b)}}else{if(b==="sohomepage"){if(!c.views.sohomepage.type){GROUPS.Y.use("sohomepage",function(g){c.views.sohomepage.type=GROUPS.VIEWS.sohomepage;c._initHomePageView(f,b)})}else{c._initHomePageView(f,b)}}}},_initHomePageView:function(e,b){var d=this,f=(typeof e.params.categoryId!="undefined"?e.params.categoryId:0);if(d.get("initialLoad")){d.handleHashtag(e.url);d.render().showContent(d.get("container").one(".main-container-child"),{view:{name:b,config:{categoryId:f}}},function(g){g.initView()});d._set("initialLoad",false)}else{if(GROUPS.LIGHTBOX&&GROUPS.LIGHTBOX.isShown()){GROUPS.LIGHTBOX.hide()}if(!d.issueAPICall){d.issueAPICall=true;return}d.pageLoader.removeClass("hide");var c="";if(GROUPS.PAGE.recentPhotosNode){c="?noRecentPhotos=true"}GROUPS.IO.makeRequest(e.path+c,"GET",{},function(g,h){if(g){d.render().showView(d.createView(b,{html:g,categoryId:f}),null,{render:true,callback:function(i){window.scrollTo(0,0);if(a.one("#right-rail-container")&&!a.one("#yg-recent-photos")){a.one("#right-rail-container").insertBefore(GROUPS.PAGE.recentPhotosNode,a.one("#yom-ad-LREC"))}i.initView()}})}})}if(typeof GROUPS.LEFTNAV!=="undefined"&&a.one("#yg-mygroups")){GROUPS.LEFTNAV.processConfig({pageType:"latest",pageInfo:""})}},categoryViewHandler:function(d,c){var b=this,e=((typeof d.params.categoryId!="undefined"&&d.params.categoryId!=null)?d.params.categoryId:0);b.setGlobalSearchHandler();GROUPS.Y.use("sohomepage",function(f){if(!b.views.sohomepage.type){b.views.sohomepage.type=GROUPS.VIEWS.sohomepage}if(b.get("initialLoad")){b.handleHashtag(d.url);b.render().showContent(b.get("container").one(".main-container-child"),{view:{name:"sohomepage",config:{categoryId:e}}},function(g){g.initView()});b._set("initialLoad",false)}else{if(!b.issueAPICall){b.issueAPICall=true;return}b.pageLoader.removeClass("hide");GROUPS.IO.makeRequest(d.path,"GET",{},function(g,h){if(g){b.render().showView(b.createView("sohomepage",{html:g,categoryId:e}),null,{render:true,callback:function(i){window.scrollTo(0,0);f.one("#yg-left-col").removeClass("fixed");i.initView();if(GROUPS.PAGE._isMobile&&f.one("#outer-wrapper .yui-sv-hd #yg-action-bar")){f.one("#outer-wrapper .yui-sv-hd #yg-action-bar").remove()}}})}})}if(typeof GROUPS.LEFTNAV!=="undefined"&&f.one("#yg-mygroups")){GROUPS.LEFTNAV.processConfig({pageType:"sohomepage",pageInfo:""})}})},linksViewHandler:function(c,b){c.params.type="links";this.groupDetailViewHandler(c,b)},localSRPViewHandler:function(c,b){c.params.type="local";this.searchResultPageViewHandler(c,b)},searchResultPageViewHandler:function(e,d){var b=this,c,i="",g="",h="",f="";if(a.one(".yucs-search-input")){if(typeof e.query.query!=="undefined"){f=e.query.query}else{if(typeof e.query.ct!=="undefined"){f=f+e.query.ct+" "}if(typeof e.query.st!=="undefined"){f=f+e.query.st+" "}}}if(e.params.type=="local"){c="local";i=a.Escape.html(e.params.groupName);g=e.params.subtype;b.setLocalSearchHandler(i,e.params.type,g,f,!GROUPS.UNIFIED_SEARCH_ENABLED);if(typeof GROUPS.LEFTNAV!=="undefined"&&a.one("#yg-mygroups")){GROUPS.LEFTNAV.processConfig({pageType:"messages",pageInfo:{name:i}})}}else{c="global";b.setGlobalSearchHandler(f);if(typeof GROUPS.LEFTNAV!=="undefined"&&a.one("#yg-mygroups")){GROUPS.LEFTNAV.processConfig({pageType:"latest",pageInfo:""})}}GROUPS.Y.use("yg-"+c+"-srp",function(j){if(!b.views.localSRPView.type){b.views.localSRPView.type=GROUPS.VIEWS["yg-local-srp"]}if(!b.views.globalSRPView.type){b.views.globalSRPView.type=GROUPS.VIEWS["yg-global-srp"]}if(b.get("initialLoad")){b.handleHashtag(e.url);b.render().showContent(b.get("container").one(".main-container-child"),{view:{name:c+"SRPView",config:{groupName:i,subType:g,html:"",query:e.query.query}}},function(k){k.initView()});b._set("initialLoad",false)}else{if(GROUPS.LIGHTBOX&&GROUPS.LIGHTBOX.isShown()){GROUPS.LIGHTBOX.hide()}if(!b.issueAPICall){b.issueAPICall=true;return}b.pageLoader.removeClass("hide");if(e.query.query){h="?query="+e.query.query;if(e.query.useSpellingSuggestion){h+="&useSpellingSuggestion="+e.query.useSpellingSuggestion}}else{h="?"+j.QueryString.stringify(e.query)}if(GROUPS.MOBILE_PV=="1"){h+="&_mobilepv=1"}GROUPS.IO.makeRequest(e.path+h,"GET",{},function(k,l){if(k){b.render().showView(b.createView(c+"SRPView",{html:k,groupName:i,subType:g,query:e.query.query}),null,{render:true,callback:function(m){window.scrollTo(0,0);m.initView()}})}})}})},groupDetailViewHandler:function(k,i){var m=this,e=this.get("activeView"),l=a.Escape.html(k.params.groupName),j=GROUPS.UTILS.stripUltParams(k.params.type),g=k.params.subtype,h=/lightbox/g,c=h.test(k.path),b;m.pageLoader.removeClass("hide");m.setLocalSearchHandler(l,j,g,undefined,((b=a.one("#yg-grp-main-img"))!=null&&b.getData("usearch-enabled")=="1"));var f=a.one("#yg-group-summary")?a.one("#yg-group-summary").getContent():l;GROUPS.PAGE.setPageTitle(f);if(!this.get("initialLoad")&&!c&&m.issueAPICall){var d=m.rightColRefresh||(e.name!="GroupDetailView"||(e.name=="GroupDetailView"&&e.get("groupName")!=l));if(d){GROUPS.IO.abortRequest();GROUPS.DETAIL_IO.abortRequest()}}GROUPS.Y.use("yg-group-detail","yg-lightbox",function(p){var n=k.src,v=k.params.subtype,w=k.params.itemId,x="",r=k.params.subtypeItemId,q=(typeof w=="undefined")?k.path:"";if(!m.views.groupDetail.type){m.views.groupDetail.type=GROUPS.VIEWS["yg-group-detail"]}if(typeof GROUPS.LEFTNAV!=="undefined"&&p.one("#yg-mygroups")){GROUPS.LEFTNAV.processConfig({pageType:"messages",pageInfo:{name:l}})}if(m.get("initialLoad")){if(v){v=GROUPS.UTILS.stripUltParams(v)}if(w){w=GROUPS.UTILS.stripUltParams(w)}if(r){r=GROUPS.UTILS.stripUltParams(r)}m.handleHashtag(k.url);if(j=="photos"&&c&&r){var t=null,s=null,o;if(k.query.exifParam){t=k.query.exifParam;s=k.query.exifType}if(window.location.hash!=""){var u=GROUPS.UTILS.getZAXId(window.location.hash);if(u){r=u}}GROUPS.LIGHTBOX=new p.Groups.lightbox({groupName:l,albumId:w,albumType:(v=="photomatic"?"photomatic":"normal"),photoId:r,exifParam:t,exifType:s,photoFilter:k.query.photoFilter})}m.render().showContent(m.get("container").one(".main-container-child"),{view:{name:"groupDetail",config:{groupName:l,type:j,subtype:v,itemId:w,subtypeItemId:r}}},function(y){y.initView()});m._set("initialLoad",false)}else{if(j=="photos"&&c&&r){if(GROUPS.LIGHTBOX){GROUPS.LIGHTBOX.navigate(l,w,r)}else{GROUPS.LIGHTBOX=new p.Groups.lightbox({groupName:l,albumId:w,albumType:(v=="photomatic"?"photomatic":"normal"),photoId:r,orderBy:k.query.orderBy,sortOrder:k.query.sortOrder,render:true,backLink:m.get("prevUrl"),startTime:k.query.startTime,endTime:k.query.endTime,exifParam:k.query.exifParam,exifType:k.query.exifType,photoFilter:k.query.photoFilter})}}else{if(GROUPS.LIGHTBOX&&GROUPS.LIGHTBOX.isShown()){GROUPS.LIGHTBOX.hide()}if(!m.issueAPICall){m.issueAPICall=true;m.pageLoader.addClass("hide");return}if((m.rightColRefresh)||(e.name!="GroupDetailView"||(e.name=="GroupDetailView"&&e.get("groupName")!=l))){m.rightColRefresh=false;GROUPS.IO.makeRequest(k.path,"GET",k.query,function(y,z){if(y){m.render().showView(m.createView("groupDetail",{groupName:l,type:j,subtype:v,itemId:w,html:y,subtypeItemId:r}),null,{render:true,callback:function(A){window.scrollTo(0,0);A.initView()}})}})}else{e.route(k,i)}}}})},groupFilesListViewHandler:function(c,b){c.params.type="files";this.groupDetailViewHandler(c,b)},groupTableViewHandler:function(c,b){c.params.type="database";c.params.subtype="records";this.groupDetailViewHandler(c,b)},groupTableEditHandler:function(c,b){c.params.type="database";c.params.subtype="edit";this.groupDetailViewHandler(c,b)},groupAttachmentHandler:function(c,b){c.params.type="attachments";this.groupDetailViewHandler(c,b)},allMyGroupsHandler:function(d,c){var b=this;b.setGlobalSearchHandler();GROUPS.Y.use("yg-all-mygroups",function(e){if(!b.views.allMyGroupsView.type){b.views.allMyGroupsView.type=GROUPS.VIEWS["yg-all-mygroups"]}if(b.get("initialLoad")){b.render().showContent(b.get("container").one(".main-container-child"),{view:{name:"allMyGroupsView",config:{html:""}}},function(f){f.initView()});b._set("initialLoad",false)}else{b.pageLoader.removeClass("hide");GROUPS.IO.makeRequest(d.path,"GET",{},function(f,g){if(f){b.render().showView(b.createView("allMyGroupsView",{html:f}),null,{render:true,callback:function(h){window.scrollTo(0,0);h.initView()}})}})}});if(typeof GROUPS.LEFTNAV!=="undefined"&&a.one("#yg-mygroups")){GROUPS.LEFTNAV.processConfig({pageType:"allmygroups",pageInfo:""})}},manageMyGroupsHandler:function(d,c){var b=this;b.setGlobalSearchHandler();GROUPS.Y.use("yg-manage-mygroups",function(e){if(!b.views.manageMyGroupsView.type){b.views.manageMyGroupsView.type=GROUPS.VIEWS["yg-manage-mygroups"]}if(b.get("initialLoad")){b.render().showContent(b.get("container").one(".main-container-child"),{view:{name:"manageMyGroupsView",config:{html:""}}},function(g){g.initView()});b._set("initialLoad",false)}else{b.pageLoader.removeClass("hide");var f="";if(d.query.showUnlinked){f="?showUnlinked=true"}GROUPS.IO.makeRequest(d.path+f,"GET",{},function(g,h){if(g){b.render().showView(b.createView("manageMyGroupsView",{html:g}),null,{render:true,callback:function(i){window.scrollTo(0,0);i.initView()}})}})}});if(typeof GROUPS.LEFTNAV!=="undefined"&&a.one("#yg-mygroups")){GROUPS.LEFTNAV.processConfig({pageType:"managemygroups",pageInfo:""})}},myPreferencesHandler:function(d,c){var b=this;b.setGlobalSearchHandler();GROUPS.Y.use("yg-my-preferences",function(e){if(!b.views.myPreferencesView.type){b.views.myPreferencesView.type=GROUPS.VIEWS["yg-my-preferences"]}if(b.get("initialLoad")){b.render().showContent(b.get("container").one(".main-container-child"),{view:{name:"myPreferencesView",config:{html:""}}},function(f){f.initView()});b._set("initialLoad",false)}else{b.pageLoader.removeClass("hide");GROUPS.IO.makeRequest(d.path,"GET",{},function(f,g){if(f){b.render().showView(b.createView("myPreferencesView",{html:f}),null,{render:true,callback:function(h){window.scrollTo(0,0);h.initView()}})}})}});if(typeof GROUPS.LEFTNAV!=="undefined"&&a.one("#yg-mygroups")){GROUPS.LEFTNAV.processConfig({pageType:"mypreferences",pageInfo:""})}},emailUnsubsHandler:function(d,c){var b=this;GROUPS.Y.use("yg-welcomemsg",function(e){if(!b.views.emailUnsubsView.type){b.views.emailUnsubsView.type=GROUPS.VIEWS["yg-welcomemsg"]}if(b.get("initialLoad")){b.render().showContent(b.get("container").one(".main-container-child"),{view:{name:"emailUnsubsView",config:{html:""}}},function(f){f.initView()});b._set("initialLoad",false)}else{b.pageLoader.removeClass("hide");GROUPS.IO.makeRequest(d.path,"GET",{},function(f,g){if(f){b.render().showView(b.createView("emailUnsubsView",{html:f}),null,{render:true,callback:function(h){window.scrollTo(0,0);h.initView()}})}})}})},memwizHandler:function(d,c){var b=this;GROUPS.Y.use("yg-memwiz",function(e){if(!b.views.memwizView.type){b.views.memwizView.type=GROUPS.VIEWS["yg-memwiz"]}if(b.get("initialLoad")){b.render().showContent(b.get("container").one(".main-container-child"),{view:{name:"memwizView",config:{html:""}}},function(f){f.initView()});b._set("initialLoad",false)}else{b.pageLoader.removeClass("hide");GROUPS.IO.makeRequest(d.path,"GET",{},function(f,g){if(f){b.render().showView(b.createView("memwizView",{html:f}),null,{render:true,callback:function(h){window.scrollTo(0,0);h.initView()}})}})}})},setLocalSearchHandler:function(g,e,c,f,d){var b;if(!GROUPS.UNIFIED_SEARCH_ENABLED&&!d){e="conversations"}switch(e){case"photos":case"files":b=GROUPS.YRB_STRINGS["STR_SEARCH_"+e.toUpperCase()];break;case"conversations":switch(c){case"posts":e="posts";b=GROUPS.YRB_STRINGS["STR_SEARCH_"+e.toUpperCase()];break;default:e="messages";b=GROUPS.YRB_STRINGS.STR_SEARCH_CONVERSATIONS;break}break;default:e="messages";b=GROUPS.YRB_STRINGS.STR_SEARCH_CONVERSATIONS;break}if(a.one("#yucs-sprop_button")){a.one("#yucs-sprop_button").setAttribute("data-vsearch","/neo/groups/"+g+"/search/"+e);if(a.one("#mnp-search_box")){a.one("#mnp-search_box").setAttribute("data-yltvsearch","/neo/groups/"+g+"/search/"+e)}}if(a.one("#mnp-search_box")){a.one("#mnp-search_box").removeAttribute("data-enter-ylt")}if((GROUPS.PAGE._isTablet||GROUPS.PAGE._isMobile)&&a.one("#yucs-search #sf")){a.one("#yucs-search #sf").setAttribute("action","/neo/groups/"+g+"/search/"+e);a.one("#yucs-search #sf").setAttribute("vertaction","/neo/groups/"+g+"/search/"+e)}if(a.one(".yucs-search-input")){if(typeof f!=="undefined"){a.one(".yucs-search-input").set("value",f)}else{a.one(".yucs-search-input").set("value","")}}if(a.one(".yucs-search-input")){a.one(".yucs-search-input").setAttribute("placeholder",b);a.one(".yucs-search-input").on("focus",function(h){a.use("pluginhost","autocomplete","autocomplete-highlighters",function(i){i.one(".yucs-search-input").unplug(i.Plugin.AutoComplete)})})}},setGlobalSearchHandler:function(c){if(a.one("#yucs-sprop_button")){a.one("#yucs-sprop_button").setAttribute("data-vsearch","/neo/search");if(a.one("#mnp-search_box")){a.one("#mnp-search_box").setAttribute("data-yltvsearch","/neo/search")}}if(a.one("#mnp-search_box")){a.one("#mnp-search_box").removeAttribute("data-enter-ylt")}if((GROUPS.PAGE._isTablet||GROUPS.PAGE._isMobile)&&a.one("#yucs-search #sf")){a.one("#yucs-search #sf").setAttribute("action","/neo/search");a.one("#yucs-search #sf").setAttribute("vertaction","/neo/search")}if(a.one(".yucs-search-input")){if(typeof c!=="undefined"){a.one(".yucs-search-input").set("value",c)}else{a.one(".yucs-search-input").set("value","")}}var b=a.one(".yucs-search-input");if(b){b.setAttribute("placeholder",GROUPS.YRB_STRINGS.STR_SEARCH_GROUPS);b.get("parentNode").addClass("yui3-skin-sam");b.on("focus",function(d){a.use("autocomplete","autocomplete-highlighters","highlight",function(e){e.one(".yucs-search-input").plug(e.Plugin.AutoComplete,{resultHighlighter:function(g,f){return e.Array.map(f,function(h){return e.Highlight.allFold(h.text,h.text.replace(g,""))})},resultListLocator:function(f){var h=[],g;for(g in f.gossip.results){h.push(f.gossip.results[g].key)}return h},source:"/neo/autocomplete/groups?command={query}",on:{select:function(g){var f="";GROUPS.INSTR.beaconClick("yg-autocomplete",g.result.text,g.itemNode.ancestor("ul").all("li").indexOf(g.itemNode)+1,false);if(!GROUPS.PAGE._isMobile&&!GROUPS.PAGE._isTablet){f="/neo/search?query="+g.result.text}else{f="/neo/search?p="+g.result.text+"&fr=ush-groups"}if(GROUPS.MOBILE_PV=="1"){f+="&_mobilepv=1"}GROUPS.ROUTER.navigate(f)}}})})})}},adminHandler:function(d,c){var b=this;GROUPS.Y.use("yg-admin",function(e){if(!b.views.adminView.type){b.views.adminView.type=GROUPS.VIEWS["yg-admin"]}if(b.get("initialLoad")){b.render().showContent(b.get("container").one(".main-container-child"),{view:{name:"adminView",config:{html:""}}},function(f){f.initView()});b._set("initialLoad",false)}else{b.pageLoader.removeClass("hide");GROUPS.IO.makeRequest(d.path,"GET",{},function(f,g){if(f){b.render().showView(b.createView("adminView",{html:f}),null,{render:true,callback:function(h){window.scrollTo(0,0);h.initView()}})}})}})}},{ATTRS:{routes:{value:[{path:"*",callbacks:["commonHandler"]},{path:"/",callbacks:["homePageViewHandler"]},{path:"/neo",callbacks:["homePageViewHandler"]},{path:"/neo/creategroup",callbacks:["createGroupHandler"]},{path:"/neo/search",callbacks:["searchResultPageViewHandler"]},{path:"/neo/groups/:groupName/search/:subtype",callbacks:["localSRPViewHandler"]},{path:"/neo/groups/all/list",callbacks:["allMyGroupsHandler"]},{path:"/neo/groups/all/manage*",callbacks:["manageMyGroupsHandler"]},{path:"/neo/groups/all/preferences",callbacks:["myPreferencesHandler"]},{path:"/neo/memwiz",callbacks:["memwizHandler"]},{path:"/neo/dir",callbacks:["categoryViewHandler"]},{path:"/neo/dir/:categoryId",callbacks:["categoryViewHandler"]},{path:"/neo/groups/:groupName/database/:itemId/records",callbacks:"groupTableViewHandler"},{path:"/neo/groups/:groupName/database/:itemId/edit",callbacks:"groupTableEditHandler"},{path:"/neo/groups/:groupName/files/*itemId",callbacks:"groupFilesListViewHandler"},{path:"/neo/groups/:groupName/:type",callbacks:"groupDetailViewHandler"},{path:"/neo/groups/:groupName/attachments/:itemId",callbacks:"groupAttachmentHandler"},{path:"/neo/groups/:groupName/links/:subtype/*itemId",callbacks:"linksViewHandler"},{path:"/neo/groups/:groupName/:type/:subtype/:itemId/lightbox/:subtypeItemId",callbacks:"groupDetailViewHandler"},{path:"/neo/groups/:groupName/:type/:subtype/lightbox/:subtypeItemId",callbacks:"groupDetailViewHandler"},{path:"/neo/groups/:groupName/:type/:subtype/:itemId/richview/:subtypeItemId",callbacks:"groupDetailViewHandler"},{path:"/neo/groups/:groupName/:type/:subtype/:itemId/:subtypeItemId",callbacks:"groupDetailViewHandler"},{path:"/neo/groups/:groupName/:type/:subtype/*itemId",callbacks:"groupDetailViewHandler"},{path:"/neo/groups/:groupName/:type/:subtype",callbacks:"groupDetailViewHandler"},{path:"/unsubscribe/updates/.*",callbacks:["emailUnsubsHandler"]},{path:"/unsubscribe/invites/.*",callbacks:["emailUnsubsHandler"]},{path:"/neo/admin",callbacks:["adminHandler"]},{path:"/neo/admin/:operation/*itemId",callbacks:["adminHandler"]}]},serverRouting:{value:true},prevUrl:{value:""},initialLoad:false}})},"0.1",{requires:["app","groups-io","yg-leftnav","yg-actionbar"]});YUI.add("yg-handlebars-extension",function(f,e){var c=f.Handlebars.compile,d=GROUPS.YRB_STRINGS,b,a;b=function(h,g){return parseInt(h.substr(0,g),10)};f.Handlebars.registerHelper("choice",function(i,h){var j=(h)?h.hash.cond||"":"",k="choice_"+((h)?h.hash.id||"":""),g;if(this[k]){return}if((g=j.indexOf("#"))!==-1){if(b(j,g)==i){this[k]=true;return h.fn(this)}else{return}}if((g=j.indexOf("<"))!==-1){if(b(j,g)<i){this[k]=true;return h.fn(this)}else{return}}if((g=j.indexOf(">"))!==-1){if(b(j,g)>i){this[k]=true;return h.fn(this)}else{return}}});a=function(g,j,l){var k="",q,h=/[#><]/,p,n,o,m;for(m=j.length-1;m>=0;m--){q=j[m];p=h.exec(q).index+1;n=q.substr(0,p);o=q.substr(p);k+="{{#choice "+g+' cond="'+n+'" id="'+l+'"}}'+o+"{{/choice}}"}return k};f.Handlebars.registerHelper("select",function(h,g){return g.fn(this).replace(new RegExp(' value="'+h+'"'),'$& selected="selected"')});f.Handlebars.compile=function(g,h){var j=0,i=g.replace(/\{\{#yrb\}\}((?!\{\{\/yrb\}\}).)*\{\{\/yrb\}\}/g,function(l){var k=l.substr(8,l.length-16).split("|"),m=d[k[0]];if(!m){return l}m=m.replace(/\{(\d+),\s*(\S+)\s*,\s*(.+)\}/g,function(u,r,w,y){var t=y,x=false,v=null;if(!isNaN(parseInt(y.slice(-1),10))){var o=y.lastIndexOf("}");x=true;t=y.substring(0,o);v=y.substring(o+1)}var p=t.split("|"),s=k[parseInt(r,10)+1],n=s.substr(2,s.length-4),q;switch(w){case"choice":q=a(n,p,j);break}j=j+1;return q+(x?v+"}":"")});return m.replace(/\{(\d)+\}/g,function(n,o){return k[parseInt(o,10)+1]})});return c(i,h)}},"0.1",{requires:["handlebars"]});YUI.add("yg-captcha",function(Y){var captcha=Y.Base.create("captcha",Y.Base,[],{getXmlReqObj:function(){var xmlReqObj=false;if(window.XMLHttpRequest){xmlReqObj=new XMLHttpRequest();isIE=false}else{if(window.ActiveXObject){isIE=true;try{xmlReqObj=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{xmlReqObj=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}}}return xmlReqObj},getXmlDomObj:function(sourceXml){var xmlDoc;if(window.ActiveXObject){if(typeof(xmlDoc)=="undefined"){xmlDoc=new ActiveXObject("Microsoft.XMLDOM");xmlDoc.async="false";isIE=true}xmlDoc.loadXML(sourceXml)}else{var parser=new DOMParser();xmlDoc=parser.parseFromString(sourceXml,"text/xml");isIE=false}return xmlDoc},processRequest:function(resp,captchaPageContainerNode,captchaPageSubmitBtnNode){var responseXML=this.getXmlDomObj(resp),testCaptchaNode,maxRetries=1;var scriptNode=responseXML.getElementsByTagName("CaptchaScript")[0];if(scriptNode){var scriptText=isIE?scriptNode.text:scriptNode.textContent;try{eval(scriptText);YAHOO.CAPTCHA.wrapper.execute(resp)}catch(e){Y.log(e)}testCaptchaNode=Y.later(2000,Y,function(){if(captchaPageContainerNode.one("#captchaV5 input[type=text]")){testCaptchaNode.cancel();captchaPageSubmitBtnNode.removeClass("btn-disabled")}else{if(maxRetries>=4){testCaptchaNode.cancel()}else{maxRetries++}}},[],true)}},requestLazyCaptcha:function(params){var self=this,url="",error="",errMsg="",result="",captchaCode="",exemptUserToken="",captchaCreationCode="",captchaErrorNodeContainer="";captchaPageContainerNode=params.captchaContainerPanelNode;captchaPageSubmitBtnNode=params.captchaContainerPanelSubmitBtnNode;langValue=encodeURIComponent(params.lang);appIdValue=encodeURIComponent(params.appId);exemptUserToken=captchaPageContainerNode.one("#captcha-exempt-user-code");captchaCreationCode=captchaPageContainerNode.one("#captcha-creation-code");captchaErrorNodeContainer=captchaPageContainerNode.one(".captcha-error-node");url="/api/v1/user/auth/captcha?lang="+langValue+"&appId="+appIdValue;GROUPS.IO.makeRequest(url,"GET",{},function(data,err){if(err){error=Y.JSON.parse(err);errMsg=GROUPS.UTILS.getErrorYRBString(error.ygError.errorCode,"captcha_error");self.showCaptchaErrorMsg(captchaErrorNodeContainer,errMsg)}else{result=Y.JSON.parse(data);captchaCode=result.ygData.code;captchaCreationCode.setAttribute("value",captchaCode);switch(captchaCode){case 0:self.processRequest(result.ygData.origResponse,captchaPageContainerNode,captchaPageSubmitBtnNode);break;case 1:exemptUserToken.setAttribute("value",result.ygData.exemptUserToken);captchaPageSubmitBtnNode.removeClass("btn-disabled");break;default:errMsg=GROUPS.YRB_STRINGS.ERROR_STRINGS.STR_ERROR_CAPTCHA_CREATION_FAILED;self.showCaptchaErrorMsg(captchaErrorNodeContainer,errMsg);break}}})},showCaptchaErrorMsg:function(captchaErrorMsgContainer,captchaErrMsg){captchaErrorMsgContainer.setHTML(captchaErrMsg)},handleCaptchaError:function(errCode,ygPanel,panelNode,submitBtnNode){var errMsg="",errMsgContainer="";if(errCode==2203){this.loadCaptcha(ygPanel,panelNode,submitBtnNode);errCode=2202}errMsg=GROUPS.UTILS.getErrorYRBString(errCode,"captcha_error"),errMsgContainer=panelNode.one(".captcha-error-node");this.showCaptchaErrorMsg(errMsgContainer,errMsg)},loadCaptcha:function(ygPanel,panelNode,submitBtnNode){if(ygPanel.get("visible")){this.requestLazyCaptcha({captchaContainerPanelNode:panelNode,captchaContainerPanelSubmitBtnNode:submitBtnNode,lang:GROUPS.LANG,appId:GROUPS.CAPTCHA_APPID})}else{panelNode.one(".captcha-error-node").setHTML("")}},captchaAllInputs:function(panelNode){var allInputs="",url="?action=validate",captchaPageContainer="",exemptUserTokenVal="",captchaCreationCodeVal="";captchaPageContainer=panelNode.one("#captchaV5");exemptUserTokenVal=panelNode.one("#captcha-exempt-user-code").getAttribute("value");captchaCreationCodeVal=panelNode.one("#captcha-creation-code").getAttribute("value");if(captchaPageContainer){allInputs=captchaPageContainer.all("input");for(var i=0,max=allInputs.size();i<max;i++){var input=allInputs.item(i);url+="&"+input.getAttribute("name")+"="+input.get("value")}if(exemptUserTokenVal!=""&&captchaCreationCodeVal==1){url+="&ygCaptchaAuthToken="+exemptUserTokenVal}}url+="&intlCode="+GROUPS.INTL;return url}},"0.1",{requires:["base"]});Y.namespace("Groups").Captcha=captcha});YUI.add("yg-create-group",function(a){a.namespace("Groups.CreateGroup");a.Groups.CreateGroup=function(){this.init=function(){var b="",f="",e="",g="",c;b=new Object();b.loaderIconUrl=GROUPS.LOADER_ICON_URL;f=GROUPS.UTILS.getTemplate("creategroup_template");e=a.Handlebars.compile(f);g=e(b);if(!(a.one("#yg-create-group-panel"))){a.one("#yg-create-group-container").setHTML(g)}this.totalCatRows=1;this.setPrivacyText();this.errMsgHtml=GROUPS.UTILS.getTemplate("yg-create-grp-err_template");this.errMsg="";this.event="";this.categoryDivHtml=a.one("#category-div").getHTML();this.submitButtonNode="";this.joinGroupPanelNode="";this.activeMenu=null;var d=a.one("#yg-create-group-panel");this.createGroupPanel=new a.Groups.Panel({srcNode:d,scrollableNode:d.one(".panel-body-wrapper"),moveNode:d.ancestor(".yui3-skin-sam")});this.createGroupPanel.render();c=this.createGroupPanel.get("contentBox").one("#yg-createGroup-container");a.one("#web-address").on("keyup",this.handleCreateGroup,this);a.one("#group-email").on("keyup",this.handleCreateGroup,this);a.one("#group-name").on("keyup",this.handleCreateGroup,this);a.one("#group-description").on("keyup",this.handleCreateGroup,this);a.one("#create-group-next").on("click",this.handleCreateGroup,this);a.all("[name=privacy]").on("click",this.setPrivacyText,this);c.delegate("click",this.showHideOverlay,".click-cat",this);c.delegate("key",this.showHideOverlay,"down:13, 40",".click-cat",this);c.delegate("click",this.getValues,".click-cat-cont",this)},this.getDomainData=function(){var d="",b="",f="",e="",c=this;e=a.one(".create-group-loader").getHTML();a.one("#web-domain").setHTML(e);a.one("#email-domain").setHTML(e);a.one("#category-div").setHTML(e);d=GROUPS.INTL;f=new Object();f.isPopUp=true;f.makeParallelReq=true;f.pv=0;if(GROUPS.YG_YID!=""){GROUPS.IO.makeRequest("/api/v1/intls/"+d+"/configs","GET",f,function(h,g){if(g){a.one("#web-domain").setHTML("");a.one("#email-domain").setHTML("");a.one("#yg-createGroup-container #group-email").setStyle("width","330px");a.one("#yg-createGroup-container #web-address").setStyle("width","330px")}else{b=a.JSON.parse(h);if(b.error){}else{b=a.JSON.parse(h);a.one("#web-domain").setHTML(b.ygData.groupDomainPrefix);a.one("#email-domain").setHTML("@"+b.ygData.domainEmail);c.setLinkIcon()}}})}},this.attachKeyboard=function(b){b.plug(a.Plugin.NodeFocusManager,{descendants:"li",keys:{next:"down:40",previous:"down:38"},focusClass:"focus",circular:false})},this.hideOverlay=function(b){b.siblings(".overlay").addClass("hide");b.one(".yg-sprite").removeClass("overlay-up-icon");b.setAttribute("aria-expanded",false)},this.setLinkIcon=function(){var b=a.one("#yg-createGroup-container");if(b){b.one("#web-address").setStyle("width",345-b.one("#web-domain").get("offsetWidth"));b.one("#group-email").setStyle("width",345-b.one("#email-domain").get("offsetWidth"))}},this.showHideOverlay=function(d){d.preventDefault();d.stopPropagation();var b=d.currentTarget.get("id"),c=d.currentTarget.get("parentNode").one(".overlay");if(!c){return}c.toggleClass("hide");d.currentTarget.one(".yg-sprite").toggleClass("overlay-up-icon");this.scrollToBottom();d.currentTarget.setAttribute("aria-expanded",!c.hasClass("hide"));if(!c.hasClass("hide")){this.activeMenu=c;GROUPS.UTILS.ddMenuSetFocus(d,a.one("#owned-all-catlist"))}else{this.activeMenu=null}},this.allCatgRows=function(g){var d="",e="",b="",f="",h="",c;d=GROUPS.UTILS.getTemplate("all-category_template");e=a.Handlebars.compile(d);b=e(g);f=a.Node.create(b);a.one("#category-div").setHTML(this.categoryDivHtml);h=a.one("#catg-cg-row1");h.insert(f,"after");h.removeClass("hide");c=h.get("parentNode").one(".overlay");c.on("key",function(j){j.stopPropagation();this.hideOverlay(h);GROUPS.UTILS.setFocus(h)},"down:27",this);h.on("clickoutside",function(j){this.hideOverlay(j.currentTarget)},this);this.attachKeyboard(a.one("#owned-all-catlist"))},this.getValues=function(f){f.stopPropagation();var b=a.one("#"+f.target.get("id")).getHTML(),d=f.target.getAttribute("catid"),c=f.currentTarget.ancestor(".rcol").one(".yg-mygrplist-button");a.one("#catg-cg-row1").setHTML('<i class="yg-sprite yg-mygrplist-dd-close"></i><span>'+b+"</span>");a.all("#yg-create-group-panel .overlay").addClass("hide");c.setAttribute("aria-expanded",false);a.one("#category-id-val").set("value",d);this.removeErrorMsgContainer();GROUPS.UTILS.setFocus(c)},this.showAdultTextCategoryText=function(){var b=GROUPS.YRB_STRINGS.STR_ADULT_TEXT;a.one("#yg-create-group-panel #adult-text-msg").setHTML(b);a.one("#yg-create-group-panel #adult-text-container").removeClass("hide")},this.removeAdultTextCategoryText=function(){a.one("#yg-create-group-panel #adult-text-container").addClass("hide")},this.getCategories=function(g,j){var h="",d="",b="",c=this,f="",e="";a.one("#category-id-val").set("value",g);h="/api/v1/dir/categories/";e=new Object();e.isPopUp=true;e.makeParallelReq=true;e.pv=0;d=h+g+"/subcategories?intlCode="+GROUPS.INTL;h+="?intlCode="+GROUPS.INTL;GROUPS.IO.makeRequest(d,"GET",e,function(l,k){if(k){a.one("#category-div").setHTML("");c.errMsg=GROUPS.UTILS.getErrorYRBString(k.ygError.errorCode,"categories_categoryid");c.showErrorMsgContainer("catg-cg-start-row1",c.errMsg);c.scrollToBottom();return false}else{b=a.JSON.parse(l);if(b.error){}else{if(b.ygData){c.removeErrorMsgContainer();if(g==0){c.appendAdultCategory(b)}c.allCatgRows(b)}}return true}})},this.appendAdultCategory=function(b){if(GROUPS.ADULT_CATEGORY){b.ygData.push(GROUPS.ADULT_CATEGORY)}};this.handleCreateGroup=function(f){var b="",c="",l="",m="",d="",h="",g="",j="";b=a.one("#group-name");c=b.get("value");l=a.one("#group-description");m=l.get("value");d=a.one("#web-address");h=d.get("value");g=a.one("#group-email");j=g.get("value");var k=f.currentTarget.get("id");switch(k){case"group-name":if(c!=""){this.removeErrorMsgContainer()}break;case"group-description":if(m!=""){this.removeErrorMsgContainer()}break;case"web-address":g.set("value",d.get("value"));if(h==""){this.showOrResetFixedErrorMsgContainer("")}if(h!=""){this.event=f;this.showOrResetFixedErrorMsgContainer("");this.checkGroupNameForValidChars(h);this.checkGroupName(h)}break;case"group-email":d.set("value",g.get("value"));if(j==""){this.showOrResetFixedErrorMsgContainer("")}if(j!=""){this.event=f;this.showOrResetFixedErrorMsgContainer("");this.checkGroupNameForValidChars(h);this.checkGroupName(h)}break;case"create-group-next":if(c==""){this.errMsg=GROUPS.YRB_STRINGS.STR_PLEASE_ENTER.replace("{0}",GROUPS.YRB_STRINGS.STR_ENTER_GRP_NAME);this.showErrorMsgContainer("grp-name",this.errMsg);b.focus()}else{if(m==""){this.errMsg=GROUPS.YRB_STRINGS.STR_PLEASE_ENTER.replace("{0}",GROUPS.YRB_STRINGS.STR_ENTER_GRP_DESC);this.showErrorMsgContainer("grp-desc",this.errMsg);l.focus()}else{if(h==""){this.errMsg=GROUPS.YRB_STRINGS.STR_PLEASE_ENTER.replace("{0}",GROUPS.YRB_STRINGS.STR_ENTER_WEB_ADDRESS);this.showOrResetFixedErrorMsgContainer(this.errMsg);d.focus()}}}if(c!=""&&m!=""&&h!=""){this.event=f;this.checkGroupNameForValidChars(h);this.checkGroupName(h)}break}},this.setPrivacyText=function(){var e="",d="",c="",f="",b="";if(a.one("[name=privacy]:checked")){e=a.one("[name=privacy]:checked").get("value")}d=a.one("#privacy-content");c=a.one("#privacy-membership");privacyGrpDis=a.one("#privacy-discovery");b=a.one("#private-text");b.removeClass("hide");switch(e){case"PUBLIC":b.toggleClass("hide");d.setHTML(GROUPS.YRB_STRINGS.STR_VISIBLE_PUBLIC);c.setHTML(GROUPS.YRB_STRINGS.STR_OPEN_PUBLIC);privacyGrpDis.setHTML(GROUPS.YRB_STRINGS.STR_LISTED);break;case"PRIVATE":a.one("#private-text-first").setHTML(GROUPS.YRB_STRINGS.STR_PRIVATE_TXT_FIRST);a.one("#private-text-last").setHTML(GROUPS.YRB_STRINGS.STR_PRIVATE_TXT_LAST);d.setHTML(GROUPS.YRB_STRINGS.STR_VISIBLE_MEMBER);c.setHTML(GROUPS.YRB_STRINGS.STR_REQ_APPROVAL);privacyGrpDis.setHTML(GROUPS.YRB_STRINGS.STR_LISTED);break;case"HIDDEN":a.one("#private-text-first").setHTML(GROUPS.YRB_STRINGS.STR_PRIVATE_TXT_FIRST);a.one("#private-text-last").setHTML(GROUPS.YRB_STRINGS.STR_PRIVATE_TXT_LAST);d.setHTML(GROUPS.YRB_STRINGS.STR_VISIBLE_MEMBER);c.setHTML(GROUPS.YRB_STRINGS.STR_ONLY_BY_INVITE);privacyGrpDis.setHTML(GROUPS.YRB_STRINGS.STR_NOT_LISTED);break}},this.scrollToBottom=function(){var b=document.getElementById("panel-body");b.scrollTop=b.scrollHeight},this.scrollToTop=function(){var b=document.getElementById("panel-body");b.scrollTop=0},this.populateJoinGroupContents=function(e){var f="",k="",b="",c="",l="",j="",h="";f=GROUPS.UTILS.getTemplate("join_group_template");k=a.Handlebars.compile(f);l=new Object();l.data=e;yahooProfiles=l.data["aliases"];yahooProfilesLen=yahooProfiles.length;j=new Array();if(yahooProfilesLen==0){j[0]=new Array();j[0]["selected"]="checked=checked";j[0]["name"]=GROUPS.YG_YID}else{for(var d=0;d<yahooProfilesLen;d++){j[d]=new Array();if(d==0){j[d]["selected"]="checked=checked"}j[d]["name"]=yahooProfiles[d]}}linkedEmails=l.data["emails"]["ALLOWED"];linkedEmailsLen=linkedEmails.length;h=new Array();for(var d=0;d<linkedEmailsLen;d++){h[d]=new Array();if(d==0){h[d]["selected"]="checked=checked"}h[d]["email"]=linkedEmails[d]}var g=new Object();g.data=new Object();g.data["createGroupTextAndButtons"]=true;g.data["myProfiles"]=j;g.data["regEmails"]=h;g.data["redirectUrl"]=a.one("#redirect-url").get("value");g.data["termsConfigUrl"]=GROUPS.TOS_URL;b=k(g);c=a.Node.create(b);if(!(a.one("#yg-create-join-group-panel"))){a.one("body").insert(c)}a.one("#yg-create-join-group-panel #profiles_list input[name=profile]").set("checked",true);a.one("#yg-create-join-group-panel #emails_list input[name=email]").set("checked",true);a.one("#yg-create-join-group-panel #cancel").on("click",this.handleJoinGroup,this);a.one("#yg-create-join-group-panel #btn-back").on("click",this.handleJoinGroup,this);a.one("#yg-create-join-group-panel #btn-create").on("click",this.handleJoinGroup,this);a.one("#yg-create-join-group-panel #accept-terms").on("click",this.handleJoinGroup,this);this.submitButtonNode=a.one("#yg-create-join-group-panel #btn-create");this.submitButtonNode.addClass("btn-disabled");this.joinGroupPanelNode=a.one("#yg-create-join-group-panel")},this.getUserProfileDetails=function(){var c=this,b="",e="",d="";e=new Object();e.isPopUp=true;e.makeParallelReq=true;e.pv=0;GROUPS.IO.makeRequest("/api/v1/user/profile","GET",e,function(g,f){if(f){c.errMsg=GROUPS.UTILS.getErrorYRBString(f.ygError.errorCode,"profile");d="catg-cg-start-row1";c.showErrorMsgContainer(d,c.errMsg)}else{b=a.JSON.parse(g);if(b.error){}else{b=a.JSON.parse(g);c.populateJoinGroupContents(b.ygData)}}})},this.handleJoinGroup=function(v){var f=v.currentTarget.get("id");switch(f){case"create-group-next":var u="",h="",d=false;this.removeErrorMsgContainer();u=a.one("#catg-cg-row1 span");if(u){h=u.getHTML();if(h==GROUPS.YRB_STRINGS.ALL_CATEGORIES){this.errMsg=GROUPS.YRB_STRINGS.STR_SELECT+" "+GROUPS.YRB_STRINGS.STR_CREATE_GROUP_CATEGORY;this.showErrorMsgContainer("catg-cg-start-row1",this.errMsg);this.scrollToBottom();d=true;break}}if(!d){this.hideCreateGroup(true);GROUPS.INSTR.beaconClick("yg-createGroup-container","create-group-step-1-next",1,false);if(!this.joinGroupPanel){this.showJoinGroup()}else{this.showJoinGroupPanel();a.one("#btn-create").addClass("btn-disabled")}}break;case"btn-back":GROUPS.INSTR.beaconClick("yg-create-join-group-panel","create-group-step-2-back",3,false);a.one("#err-msg-comment").addClass("hide");this.showCreateGroupPanel();this.hideJoinGroup(true);break;case"accept-terms":if(a.one("#accept-terms").get("checked")){this.showJoinGroupErrorMsg("")}break;case"btn-create":var k="",w="",g="";k=a.one("#accept-terms");w=k.get("checked");if(!w){g=GROUPS.YRB_STRINGS.STR_ACCEPT_TERMS.replace("{0}",GROUPS.YRB_STRINGS.STR_TERMS_OF_SERVICE);k.focus();this.showJoinGroupErrorMsg(g);break}else{var n=new Object();n.title=a.Lang.trim(a.one("#group-name").get("value"));n.description=a.Lang.trim(a.one("#group-description").get("value"));groupName=a.Lang.trim(a.one("#web-address").get("value"));n.name=groupName;var x=a.one("[name=privacy]:checked").get("value");switch(x){case"PUBLIC":n.memberShipType="OPEN";n.unListed="FALSE";n.groupVis="ALL";n.messagesVis="ALL";n.calendarVis="ALL";n.linksVis="ALL";break;case"PRIVATE":n.memberShipType="RESTRICTED";n.unListed="FALSE";n.groupVis="ALL";n.messagesVis="SUBSCRIBERS";n.calendarVis="SUBSCRIBERS";n.linksVis="SUBSCRIBERS";break;case"HIDDEN":n.memberShipType="CLOSED";n.unListed="TRUE";n.groupVis="SUBSCRIBERS";n.messagesVis="SUBSCRIBERS";n.calendarVis="SUBSCRIBERS";n.linksVis="SUBSCRIBERS";break}n.categoryId=a.one("#category-id-val").get("value");var m="",b="",s="",t="",q=this,r="";m=a.JSON.stringify(n);b=a.one("[name=profile]:checked").get("value");s=a.one("[name=email]:checked").get("value");t=a.one("[name=message_delivery]:checked").get("value");var j="/api/v1/groups",y="",o="",q=this,p="",c="",l="";p=a.one("#redirect-url").get("value");p=p.replace("%groupName%",groupName);r=new Object();r.groupSettingInfo=m;r.yahooProfile=b;r.email=s;r.msgDelivery=t;r.isPopUp=true;j+=GROUPS.CAPTCHA.captchaAllInputs(this.joinGroupPanelNode);GROUPS.PAGE.hasUnsavedChanges=false;GROUPS.INSTR.beaconClick("yg-create-join-group-panel","create-group-step-2-create",1,false);if(!v.target.hasClass("btn-disabled")){GROUPS.IO.makeRequest(j,"POST",r,function(z,e){if(e){c=e.ygError.errorObject;l=e.ygError.errorCode;if(c){q.handleErrorObject(c,l)}else{if(l==2202||l==2203){GROUPS.CAPTCHA.handleCaptchaError(l,q.joinGroupPanel,q.joinGroupPanelNode,q.submitButtonNode)}else{GROUPS.CAPTCHA.loadCaptcha(q.joinGroupPanel,q.joinGroupPanelNode,q.submitButtonNode);q.errMsg=GROUPS.UTILS.getErrorYRBString(l,"create_group");q.showJoinGroupErrorMsg(q.errMsg)}}return false}else{o=a.JSON.parse(z);if(o.error){}else{q.hideJoinGroup();window.location.href=p}return true}})}break}}},this.handleErrorObject=function(b,c){var g="",f="",e="",d="";if(b){g=b.length;for(i=0;i<g;i++){f=b[i]["fieldName"];if(c==1003){c=b[i]["resourceErrorCode"]}e=GROUPS.UTILS.getErrorYRBString(c,"exception_errors");if(c==1125){d=b[i]["profaneText"];e+=" : "+d}this.errorFieldFocus(f,e);break}}},this.hideJoinGrpShowCreateGrp=function(){this.showCreateGroupPanel();this.hideJoinGroup(true)},this.errorFieldFocus=function(c,b){switch(c){case"title":this.hideJoinGrpShowCreateGrp();this.showErrorMsgContainer("grp-name",b);a.one("#group-name").focus();break;case"description":this.hideJoinGrpShowCreateGrp();this.showErrorMsgContainer("grp-desc",b);a.one("#group-description").focus();break;case"name":this.hideJoinGrpShowCreateGrp();this.showOrResetFixedErrorMsgContainer(b);a.one("#web-address").focus();break;case"categoryId":this.hideJoinGrpShowCreateGrp();this.showErrorMsgContainer("catg-cg-start-row1",b);break;case"yahooProfile":this.showJoinGroupErrorMsg(b);break;case"email":this.showJoinGroupErrorMsg(b);break;case"msgDelivery":this.showJoinGroupErrorMsg(b);break}},this.showJoinGroupErrorMsg=function(b){errContainer=a.one("#yg-create-join-group-panel #err-msg-comment");errContainer.removeClass("hide");errContainer.one(".error").setHTML(b)},this.checkGroupNameForValidChars=function(b){var c=/^[0-9a-zA-Z_-]+$/;if(c.test(b)){return true}else{this.errMsg=GROUPS.YRB_STRINGS.STR_VALID_GRP_NAME_CHARS;this.showOrResetFixedErrorMsgContainer(this.errMsg);a.one("#web-address").focus();return false}},this.checkGroupName=function(e){if(this.checkGroupNameForValidChars){var g="",j="",d="/api/v1/groups/",h="",b="",c=this,f="";f=new Object();f.isPopUp=true;f.makeParallelReq=true;f.pv=0;d+=e+"?checkNameAvailability=true";GROUPS.PAGE.hasUnsavedChanges=false;if(typeof(this.CheckGroupsRequest)!="undefined"&&this.CheckGroupsRequest){GROUPS.IO.abortRequest(this.CheckGroupsRequest)}this.CheckGroupsRequest=GROUPS.IO.makeRequest(d,"GET",f,function(l,k){if(k){c.handleJoinGroup(c.event)}else{b=a.JSON.parse(l);if(b.error){}else{if(b.ygData){GROUPS.PAGE.hasUnsavedChanges=false;c.handleJoinGroup(c.event)}else{c.errMsg=GROUPS.YRB_STRINGS.STR_DUPLICATE_GRP_NAME;c.showOrResetFixedErrorMsgContainer(c.errMsg);a.one("#web-address").focus()}}return true}})}},this.showOrResetFixedErrorMsgContainer=function(b){a.one("#fixed-err-msg-container #err-msg").setHTML(b)},this.showErrorMsgContainer=function(d,j){var c="",e="",f="",b="",h="",g="";e=new Object();e.errorMsg=j;f=a.Handlebars.compile(this.errMsgHtml);b=f(e);h=a.Node.create(b);c="#"+d;g=a.one("#err-msg-container");if(!g){a.one(c).insert(h,"after")}},this.removeErrorMsgContainer=function(){if(a.one("#err-msg-container")){var b=a.one("#err-msg-container");if(b){b.remove(true)}}},this.hideCreateGroup=function(b){GROUPS.PAGE.hasUnsavedChanges=false;a.one("#yg-create-group-panel").addClass("hide");this.createGroupPanel.hide({},b)},this.showCreateGroupPanel=function(b){a.one("#yg-create-group-panel").removeClass("hide");this.createGroupPanel.show(b)},this.showCreateGroup=function(b){this.init();this.removeErrorMsgContainer();if(a.one("#web-domain").getHTML()==""&&a.one("#email-domain").getHTML()==""){this.getDomainData()}GROUPS.PAGE.hasUnsavedChanges=false;if(!(a.one("#yg-create-join-group-panel"))){this.getUserProfileDetails()}a.one("#yg-create-group-panel").removeClass("hide");if(a.all("#yg-create-group-panel .overlay")){a.all("#yg-create-group-panel .overlay").addClass("hide")}this.createGroupPanel.show(b);this.getCategories("0");a.one("#group-name").focus();a.one("#yg-create-group-panel").delegate("click",this.destroyCreateAndJoinGroupPanels,"#create-group-cancel, .yui3-button-close",this);a.one("body").on("key",this.destroyCreateAndJoinGroupPanels,"down:27",this)},this.showJoinGroupPanel=function(b){a.one("#yg-create-join-group-panel").removeClass("hide");if(a.one("#captchaV5").hasChildNodes()){a.one("#captchaV5").setHTML("")}this.joinGroupPanel.show(b)},this.showJoinGroup=function(c){GROUPS.PAGE.hasUnsavedChanges=false;var b=a.one("#yg-create-join-group-panel");this.joinGroupPanel=new a.Groups.Panel({srcNode:b,moveNode:b.ancestor(".yui3-skin-sam"),width:"700px"});this.joinGroupPanel.after("visibleChange",this.panelVisibleHandler,this);this.joinGroupPanel.render();a.one("#yg-create-join-group-panel").removeClass("hide");this.joinGroupPanel.show(c);a.one("#yg-create-join-group-panel").delegate("click",this.destroyCreateAndJoinGroupPanels,"#cancel, .yui3-button-close",this);a.one("body").on("key",this.destroyCreateAndJoinGroupPanels,"down:27",this)},this.destroyCreateAndJoinGroupPanels=function(b){var c=b.target.get("id");if(b.target.hasClass("yui3-button-close")||c=="create-group-cancel"||c=="cancel"||b.keyCode==27){if(this.createGroupPanel!=undefined){if(c=="create-group-cancel"){GROUPS.INSTR.beaconClick("yg-createGroup-container","create-group-step-1-cancel",2,false)}this.createGroupPanel.destroy(true);this.createGroupPanel=undefined}if(this.joinGroupPanel!=undefined){if(c=="cancel"){GROUPS.INSTR.beaconClick("yg-create-join-group-panel","create-group-step-2-cancel",2,false)}this.joinGroupPanel.destroy(true);this.joinGroupPanel=undefined}if(GROUPS.PAGE._isTablet){if(a.one("#start-new-group")){if(a.one("#start-new-group").get("value")=="true"){return}}window.history.back()}}},this.panelVisibleHandler=function(b){GROUPS.CAPTCHA.loadCaptcha(this.joinGroupPanel,this.joinGroupPanelNode,this.submitButtonNode)},this.hideJoinGroup=function(b){GROUPS.PAGE.hasUnsavedChanges=false;a.one("#yg-create-join-group-panel").addClass("hide");this.joinGroupPanel.hide({},b)}}},"0.1",{requires:["node","model","view","groups-io","json","yg-panel","node-focusmanager"]});/*
YUI 3.15.0 (build 834026e)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("intl",function(e,t){var n={},r="yuiRootLang",i="yuiActiveLang",s=[];e.mix(e.namespace("Intl"),{_mod:function(e){return n[e]||(n[e]={}),n[e]},setLang:function(e,t){var n=this._mod(e),s=n[i],o=!!n[t];return o&&t!==s&&(n[i]=t,this.fire("intl:langChange",{module:e,prevVal:s,newVal:t===r?"":t})),o},getLang:function(e){var t=this._mod(e)[i];return t===r?"":t},add:function(e,t,n){t=t||r,this._mod(e)[t]=n,this.setLang(e,t)},get:function(t,n,r){var s=this._mod(t),o;return r=r||s[i],o=s[r]||{},n?o[n]:e.merge(o)},getAvailableLangs:function(t){var n=e.Env._loader,r=n&&n.moduleInfo[t],i=r&&r.lang;return i?i.concat():s}}),e.augment(e.Intl,e.EventTarget),e.Intl.publish("intl:langChange",{emitFacade:!0})},"3.15.0",{requires:["intl-base","event-custom"]});
/*
YUI 3.15.0 (build 834026e)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("attribute-complex",function(e,t){var n=e.Attribute;n.Complex=function(){},n.Complex.prototype={_normAttrVals:n.prototype._normAttrVals,_getAttrInitVal:n.prototype._getAttrInitVal},e.AttributeComplex=n.Complex},"3.15.0",{requires:["attribute-base"]});
/*
YUI 3.15.0 (build 834026e)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("event-delegate",function(e,t){function f(t,r,u,l){var c=n(arguments,0,!0),h=i(u)?u:null,p,d,v,m,g,y,b,w,E;if(s(t)){w=[];if(o(t))for(y=0,b=t.length;y<b;++y)c[0]=t[y],w.push(e.delegate.apply(e,c));else{c.unshift(null);for(y in t)t.hasOwnProperty(y)&&(c[0]=y,c[1]=t[y],w.push(e.delegate.apply(e,c)))}return new e.EventHandle(w)}p=t.split(/\|/),p.length>1&&(g=p.shift(),c[0]=t=p.shift()),d=e.Node.DOM_EVENTS[t],s(d)&&d.delegate&&(E=d.delegate.apply(d,arguments));if(!E){if(!t||!r||!u||!l)return;v=h?e.Selector.query(h,null,!0):u,!v&&i(u)&&(E=e.on("available",function(){e.mix(E,e.delegate.apply(e,c),!0)},u)),!E&&v&&(c.splice(2,2,v),E=e.Event._attach(c,{facade:!1}),E.sub.filter=l,E.sub._notify=f.notifySub)}return E&&g&&(m=a[g]||(a[g]={}),m=m[t]||(m[t]=[]),m.push(E)),E}var n=e.Array,r=e.Lang,i=r.isString,s=r.isObject,o=r.isArray,u=e.Selector.test,a=e.Env.evt.handles;f.notifySub=function(t,r,i){r=r.slice(),this.args&&r.push.apply(r,this.args);var s=f._applyFilter(this.filter,r,i),o,u,a,l;if(s){s=n(s),o=r[0]=new e.DOMEventFacade(r[0],i.el,i),o.container=e.one(i.el);for(u=0,a=s.length;u<a&&!o.stopped;++u){o.currentTarget=e.one(s[u]),l=this.fn.apply(this.context||o.currentTarget,r);if(l===!1)break}return l}},f.compileFilter=e.cached(function(e){return function(t,n){return u(t._node,e,n.currentTarget===n.target?null:n.currentTarget._node)}}),f._disabledRE=/^(?:button|input|select|textarea)$/i,f._applyFilter=function(t,n,r){var s=n[0],o=r.el,a=s.target||s.srcElement,l=[],c=!1;a.nodeType===3&&(a=a.parentNode);if(a.disabled&&f._disabledRE.test(a.nodeName))return l;n.unshift(a);if(i(t))while(a){c=a===o,u(a,t,c?null:o)&&l.push(a);if(c)break;a=a.parentNode}else{n[0]=e.one(a),n[1]=new e.DOMEventFacade(s,o,r);while(a){t.apply(n[0],n)&&l.push(a);if(a===o)break;a=a.parentNode,n[0]=e.one(a)}n[1]=s}return l.length<=1&&(l=l[0]),n.shift(),l},e.delegate=e.Event.delegate=f},"3.15.0",{requires:["node-base"]});
/*
YUI 3.15.0 (build 834026e)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("node-event-delegate",function(e,t){e.Node.prototype.delegate=function(t){var n=e.Array(arguments,0,!0),r=e.Lang.isObject(t)&&!e.Lang.isArray(t)?1:2;return n.splice(r,0,this._node),e.delegate.apply(e,n)}},"3.15.0",{requires:["node-base","event-delegate"]});
/*
YUI 3.15.0 (build 834026e)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("datatype-date-parse",function(e,t){e.mix(e.namespace("Date"),{parse:function(t){var n=new Date(+t||t);return e.Lang.isDate(n)?n:null}}),e.namespace("Parsers").date=e.Date.parse,e.namespace("DataType"),e.DataType.Date=e.Date},"3.15.0");
